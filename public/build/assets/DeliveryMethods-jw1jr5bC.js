import{F as C}from"./FormMixin-B-agdKFQ.js";import{u as I,c as n,b as t,e as m,f as u,F as g,k as w,d,w as h,h as p,r as l,o,t as M,m as k}from"./app-B8gd3Cxn.js";import{V}from"./vue-draggable-next.esm-bundler-B9yecrVA.js";import{u as T}from"./store-store-eQ26V74-.js";import{A as N}from"./AddButton-DU95A9tI.js";import{S as j}from"./SearchInput-COM9VROU.js";import{C as E}from"./ConfirmModal-DhZLN2Vv.js";import{S as F}from"./ShineEffect-ClLKiyhJ.js";import{L as U}from"./LineSkeleton-Ld8hxsNv.js";import{P as H}from"./PrimaryButton-BousIvUf.js";import{S as P}from"./SpinningLoader-CZqr6WN5.js";import{B as z}from"./ButtonSkeleton-CMf8h4QL.js";import{B as O}from"./BadgeIndicator-lr_nJHG3.js";import{g as q,p as G,d as J}from"./api-repository-Ccg06KIS.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-store-Dc8OgXqt.js";import"./UtilsMixin-CBwmyCNB.js";import"./cloneDeep-BSUglKOW.js";import"./index-D19FfSVG.js";import"./TextInput-C-iRidDV.js";import"./InputErrorMessage-BTnNDtHI.js";import"./MoreInfoPopover-BDSzYKfY.js";import"./Button-D_M2G9RN.js";const Q={mixins:[C],components:{draggable:V,AddButton:N,SearchInput:j,ConfirmModal:E,ShineEffect:F,SpinningLoader:P,LineSkeleton:U,PrimaryButton:H,ButtonSkeleton:z,BadgeIndicator:O},props:{form:{type:Object}},data(){return{searchTerm:"",deliveryMethods:[],apiState:I(),storeState:T(),deletableDeliveryMethod:null,isDeletingDeliveryMethodIds:[],isLoadingDeliveryMethods:!1,isUpdatingDeliveryMethodArrangement:!1}},watch:{searchTerm(r,e){this.showDeliveryMethods()}},computed:{store(){return this.storeState.store},isSearching(){return this.hasSearchTerm&&this.isLoadingDeliveryMethods},hasSearchTerm(){return this.searchTerm.length>0},hasDeliveryMethods(){return this.deliveryMethods.length>0}},methods:{onViewDeliveryMethod(r){this.$router.push({name:"show-store-delivery-method",params:{delivery_method_href:r._links.showDeliveryMethod}}).then(()=>{window.scrollTo(0,0)})},onAddDeliveryMethod(){this.$router.push({name:"create-store-delivery-method",params:{store_href:this.store._links.showStore}})},showDeleteConfirmationModal(r){this.deletableDeliveryMethod=r,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(r){return this.isDeletingDeliveryMethodIds.findIndex(e=>e==r.id)!=-1},showDeliveryMethods(){this.isLoadingDeliveryMethods=!0;const r={storeId:this.store.id};this.searchTerm&&(r.search=this.searchTerm),q(this.store._links.showStoreDeliveryMethods,r).then(e=>{e.status==200&&(this.pagination=e.data,this.deliveryMethods=this.pagination.data),this.isLoadingDeliveryMethods=!1}).catch(e=>{this.isLoadingDeliveryMethods=!1,this.setServerFormErrors(e)})},updateDeliveryMethodArrangement(){this.isUpdatingDeliveryMethodArrangement=!0;const r={storeId:this.store.id,deliveryMethodIds:this.deliveryMethods.map(e=>e.id)};G(this.apiState.apiHome._links.updateDeliveryMethodArrangement,r).then(e=>{e.status==200&&(e.data.updated?this.showSuccessfulNotification("Delivery method arrangement updated"):(this.setFormError("general",e.data.message),this.showUnsuccessfulNotification(e.data.message))),this.isUpdatingDeliveryMethodArrangement=!1}).catch(e=>{this.isUpdatingDeliveryMethodArrangement=!1,this.setServerFormErrors(e)})},deleteDeliveryMethod(r){this.isDeletingDeliveryMethodIds.push(this.deletableDeliveryMethod.id),J(this.deletableDeliveryMethod._links.deleteDeliveryMethod).then(e=>{r(),this.isDeletingDeliveryMethodIds.splice(this.isDeletingDeliveryMethodIds.findIndex(c=>c==this.deleteDeliveryMethod.id,1)),e.status==200&&(e.data.deleted?(this.showSuccessfulNotification("Delivery method deleted"),this.isDeletingDeliveryMethodIds.length==0&&this.showDeliveryMethods()):(this.setFormError("general",e.data.message),this.showUnsuccessfulNotification(e.data.message)))}).catch(e=>{this.isDeletingDeliveryMethodIds.splice(this.isDeletingDeliveryMethodIds.findIndex(c=>c==this.deleteDeliveryMethod.id,1)),this.setServerFormErrors(e)})}},created(){this.showDeliveryMethods()}},R={class:"bg-white shadow-lg border p-8 rounded-lg"},W={class:"space-y-4"},X={key:1,class:"space-y-2"},Y=["onClick"],Z={class:"w-full flex items-center justify-between"},$={class:"text-sm font-semibold"},ee={class:"flex items-center space-x-2"},te=["onClick"],se={key:0},oe={class:"flex justify-between items-center space-x-8 px-16 py-4 border rounded-lg bg-gray-50"},re={class:"space-y-2"},ie={key:0,class:"font-bold"},ne={class:"mb-8"},le={class:"font-bold text-black"};function ae(r,e,c,de,a,i){const b=l("SearchInput"),y=l("LineSkeleton"),f=l("ShineEffect"),D=l("BadgeIndicator"),x=l("SpinningLoader"),S=l("draggable"),_=l("ButtonSkeleton"),A=l("AddButton"),B=l("PrimaryButton"),L=l("ConfirmModal");return o(),n("div",R,[e[14]||(e[14]=t("h1",{class:"flex items-center text-lg font-bold mb-2"},[t("svg",{class:"w-6 h-6 mr-2 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"})]),t("span",null,"Delivery / Pickup Methods")],-1)),e[15]||(e[15]=t("p",{class:"text-sm text-gray-500 mb-4"}," Set up how your customers can get their orders, whether through delivery or pickup, to make it easy and convenient for them. ",-1)),t("div",W,[i.hasSearchTerm||i.hasDeliveryMethods?(o(),m(b,{key:0,modelValue:a.searchTerm,"onUpdate:modelValue":e[0]||(e[0]=s=>a.searchTerm=s),isSearching:i.isSearching},null,8,["modelValue","isSearching"])):u("",!0),a.isLoadingDeliveryMethods?(o(),n("div",X,[(o(),n(g,null,w([1,2,3],(s,v)=>t("div",{key:v,class:"border shadow-sm rounded-lg p-4 bg-gray-50"},[d(f,{class:"w-full flex items-center justify-between"},{default:h(()=>[d(y,{width:"w-32"}),d(y,{width:"w-16"})]),_:1})])),64))])):(o(),n(g,{key:2},[d(S,{class:"space-y-2",modelValue:a.deliveryMethods,"onUpdate:modelValue":e[2]||(e[2]=s=>a.deliveryMethods=s),handle:".draggable-handle","ghost-class":"bg-yellow-50",onChange:i.updateDeliveryMethodArrangement},{default:h(()=>[(o(!0),n(g,null,w(a.deliveryMethods,(s,v)=>(o(),n("div",{onClick:()=>i.onViewDeliveryMethod(s),key:v,class:"flex items-center justify-between space-x-4 border shadow-sm rounded-lg p-4 bg-gray-50 cursor-pointer hover:border-blue-200 hover:bg-blue-50 group"},[t("div",Z,[t("h1",$,M(s.name),1),t("div",ee,[d(D,{type:s.active?"success":"warning",text:s.active?"Active":"Inactive",showDot:!1},null,8,["type","text"])])]),i.isDeleting(s)?(o(),m(x,{key:0,type:"danger"},{default:h(()=>e[3]||(e[3]=[t("span",{class:"text-xs ml-2"},"Deleting...",-1)])),_:1})):(o(),n("svg",{key:1,onClick:k(he=>i.showDeleteConfirmationModal(s),["stop","prevent"]),class:"w-4 h-4 cursor-pointer hover:text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},e[4]||(e[4]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"},null,-1)]),8,te)),(o(),n("svg",{onClick:e[1]||(e[1]=k(()=>{},["stop"])),class:"draggable-handle w-4 h-4 cursor-grab hover:text-yellow-500 active:cursor-grabbing",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},e[5]||(e[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"},null,-1)])))],8,Y))),128))]),_:1},8,["modelValue","onChange"]),i.hasDeliveryMethods?u("",!0):(o(),n("div",se,[t("div",oe,[e[8]||(e[8]=t("svg",{class:"w-80 text-gray-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"})],-1)),t("div",re,[i.hasSearchTerm?(o(),n("p",ie,"No delivery methods found.")):u("",!0),t("p",null,[e[6]||(e[6]=p("Click the ")),d(D,{type:"primary",text:"+ Add Delivery Method",showDot:!1,clickable:!0,action:()=>i.onAddDeliveryMethod()},null,8,["action"]),e[7]||(e[7]=p(" button to offer your customers convenient delivery methods on your store"))])])])]))],64)),a.isLoadingDeliveryMethods?(o(),m(f,{key:3},{default:h(()=>[d(_,{size:"sm",class:"w-full"},{default:h(()=>e[9]||(e[9]=[t("span",{class:"leading-none text-sm"},"ï¼‹",-1),t("span",{class:"ml-2"},"Add Delivery Method",-1)])),_:1})]),_:1})):(o(),m(A,{key:4,action:()=>i.onAddDeliveryMethod(),size:"sm",type:"light"},{default:h(()=>e[10]||(e[10]=[t("span",{class:"ml-2"},"Add Delivery Method",-1)])),_:1},8,["action"])),a.deletableDeliveryMethod?(o(),m(L,{key:5,approveText:"Delete",approveAction:s=>i.deleteDeliveryMethod(s),isLoading:i.isDeleting(i.deleteDeliveryMethod)},{content:h(()=>[e[13]||(e[13]=t("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),t("p",ne,[e[11]||(e[11]=p("Are you sure you want to delete ")),t("span",le,M(a.deletableDeliveryMethod.name),1),e[12]||(e[12]=p("?"))])]),trigger:h(s=>[d(B,{ref:"confirmDeleteButton",action:s.showModal,class:"hidden",type:"danger"},null,8,["action"])]),_:1},8,["approveAction","isLoading"])):u("",!0)])])}const Ne=K(Q,[["render",ae]]);export{Ne as default};
