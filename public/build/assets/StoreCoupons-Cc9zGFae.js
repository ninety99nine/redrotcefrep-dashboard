import{F as M}from"./FormMixin-CYiBG1ca.js";import{U as N,S as E}from"./SpiningLoader-CsPmXxst.js";import{u as F}from"./store-store-C2_eLuQh.js";import{A as R}from"./AddButton-YPx_iiuG.js";import{T as H}from"./TextHeader-Cdgnrugi.js";import{C as U}from"./Checkbox-C6zZavZf.js";import{B as z}from"./BasicTable-BSovyWYs.js";import{C as W}from"./ConfirmModal-DrJlS0Sa.js";import{P as j}from"./PrimaryButton-DULDYb5e.js";import{M as O}from"./MoreInfoPopover-gLIaCQca.js";import{g as q,d as G}from"./api-repository-C4cDgx_E.js";import{T as J}from"./ToogleSwitch-CDDQu6G0.js";import{B as K}from"./BadgeIndicator-BRfv_GU4.js";import{N as Q}from"./NoDataPlaceholder-C-ZzFZvH.js";import{c as i,d as e,e as r,w as c,F as g,g as h,f as m,i as u,r as d,o as s,l as x,t as _,p as b,q as X}from"./app-Kf0mCOXy.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./InputErrorMessage-B1NpEu7u.js";import"./SearchInput-Csxtp266.js";import"./TextInput-_gM6fl6u.js";import"./InputLabel-B11U1-WT.js";import"./StatusDot-B0b3cfnt.js";const Z={mixins:[M,N],components:{AddButton:R,TextHeader:H,BasicTable:z,Checkbox:U,ConfirmModal:W,PrimaryButton:j,SpiningLoader:E,MoreInfoPopover:O,ToogleSwitch:J,BadgeIndicator:K,NoDataPlaceholder:Q},data(){return{coupons:[],pagination:null,searchTerm:null,checkedRowIds:[],showEverything:!1,deletableCoupon:null,isDeletingCouponIds:[],isLoadingCoupons:!1,storeState:F()}},computed:{store(){return this.storeState.store},tableHeaders(){return this.showEverything?["","Name","Description","Instructions","Status","Offers","Created Date",""]:["","Name","Description","Status","Offers",""]},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{onView(o){this.$router.push({name:"show-store-coupon",params:{store_href:this.store._links.showStore,coupon_href:o._links.showCoupon}}).then(()=>{window.scrollTo(0,0)})},showDeleteConfirmationModal(o){this.deletableCoupon=o,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(o){return this.isDeletingCouponIds.findIndex(l=>l==o.id)!=-1},onAddCoupon(){this.$router.push({name:"create-store-coupon",params:{store_href:this.store._links.showStore}})},paginate(o){this.getCoupons(o)},search(o){this.searchTerm=o,this.getCoupons()},getCoupons(o=null){this.isLoadingCoupons=!0;const l={};this.hasSearchTerm&&(l.search=this.searchTerm),o=o??this.store._links.showStoreCoupons,q(o,l).then(y=>{y.status==200&&(this.pagination=y.data,this.coupons=this.pagination.data,this.checkedRowIds=this.coupons.map(D=>!1)),this.isLoadingCoupons=!1}).catch(y=>{this.isLoadingCoupons=!1,this.setServerFormErrors(y)})},deleteCoupon(){this.isDeletingCouponIds.push(this.deletableCoupon.id),G(this.deletableCoupon._links.deleteCoupon).then(o=>{this.isDeletingCouponIds.splice(this.isDeletingCouponIds.findIndex(l=>l==this.deletableCoupon.id,1)),o.status==200&&(o.data.deleted?(this.showSuccessfulNotification("Coupon deleted"),this.isDeletingCouponIds.length==0&&this.getCoupons()):(this.setFormError("general",o.data.message),this.showUnsuccessfulNotification(o.data.message)))}).catch(o=>{this.isDeletingCouponIds.splice(this.isDeletingCouponIds.findIndex(l=>l==this.deletableCoupon.id,1)),this.setServerFormErrors(o)})}},mounted(){},created(){this.getCoupons()}},$={class:"flex justify-between items-center border-dashed py-6"},ee={class:"flex items-center"},te=e("span",{class:"mr-2"},"ðŸ¥°",-1),se=e("span",{class:"ml-2"},"Add Coupon",-1),oe=["onClick"],ne={class:"whitespace-nowrap align-top px-4 py-4"},ie={class:"flex space-x-1 items-center w-40"},ae={class:"align-top px-4 py-4"},re={class:"flex space-x-1 items-center w-80"},le={key:1},ce={key:0,class:"align-top px-4 py-4"},de={class:"w-80 bg-green-50 border border-green-200 rounded-md py-2 px-6 mb-2 shadow-md"},pe={class:"space-y-2 list-disc"},he={class:"whitespace-nowrap align-top px-4 py-4"},ue={class:"flex space-x-1 items-center"},me={class:"whitespace-nowrap align-top px-4 py-4"},_e={class:"flex items-center space-x-2"},fe={class:"whitespace-normal space-y-2 border-t border-dashed pt-2 mt-4"},ge={key:1,class:"whitespace-nowrap align-top px-4 py-4"},ye={class:"flex space-x-1 items-center"},Ce={class:"align-top px-4 py-4 flex items-center space-x-4"},we=["onClick"],xe=e("span",{class:"text-xs ml-2"},"Deleting...",-1),be=["onClick"],ve={key:1,class:"flex justify-between space-x-20 bg-white shadow-lg rounded-lg border p-20"},ke={class:"space-y-4"},De=e("h1",{class:"text-2xl font-bold"},"Add your coupons",-1),Te=e("span",{class:"ml-2"},"Add Coupon",-1),Se=e("div",null,[e("span",{class:"text-8xl"},"ðŸ¥°")],-1),Ie=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1),Be={class:"mb-8"},Ae={class:"font-bold text-black"};function Le(o,l,y,D,a,n){const T=d("TextHeader"),C=d("MoreInfoPopover"),S=d("ToogleSwitch"),k=d("AddButton"),I=d("Checkbox"),B=d("NoDataPlaceholder"),f=d("BadgeIndicator"),A=d("SpiningLoader"),L=d("BasicTable"),P=d("PrimaryButton"),V=d("ConfirmModal");return s(),i("div",null,[e("div",$,[e("div",ee,[r(T,null,{default:c(()=>[te,u(" Coupons")]),_:1}),r(C,{class:"ml-2 mt-1",title:"What Is This?",description:"Coupons are promotional incentives that customers can claim while placing orders, such as discounts or free delivery. This encourages purchases and enhances the customer shopping experience.",placement:"top"})]),(a.pagination??{}).total>0?(s(),i(g,{key:0},[r(S,{modelValue:a.showEverything,"onUpdate:modelValue":l[0]||(l[0]=t=>a.showEverything=t),size:"md",labelPopoverTitle:"What Is This?",labelPopoverDescription:"Turn on if you want to show more information about your coupons"},{default:c(()=>[u(" Show Everything ")]),_:1},8,["modelValue"]),r(k,{action:n.onAddCoupon,class:"w-40"},{default:c(()=>[se]),_:1},8,["action"])],64)):h("",!0)]),a.isLoadingCoupons||(a.pagination??{}).total>0||n.hasSearchTerm?(s(),m(L,{key:0,pagination:a.pagination,isLoading:a.isLoadingCoupons,onPaginate:n.paginate,onSearch:n.search,onRefresh:n.getCoupons,totalHeaders:n.tableHeaders.length},{head:c(()=>[e("tr",null,[(s(!0),i(g,null,x(n.tableHeaders,(t,w)=>(s(),i("th",{key:w,scope:"col",class:"whitespace-nowrap px-4 py-3"},_(t),1))),128))])]),body:c(()=>[(s(!0),i(g,null,x(a.coupons,(t,w)=>(s(),i("tr",{onClick:b(p=>n.onView(t),["stop"]),key:t.id,class:X(["group cursor-pointer border-b",a.checkedRowIds[w]?"bg-blue-100":"bg-white hover:bg-gray-50"])},[e("td",{onClick:l[1]||(l[1]=b(()=>{},["stop"])),class:"whitespace-nowrap pl-4"},[r(I,{size:"xs",modelValue:a.checkedRowIds[w],"onUpdate:modelValue":p=>a.checkedRowIds[w]=p},null,8,["modelValue","onUpdate:modelValue"])]),e("td",ne,[e("div",ie,[e("span",null,_(t.name),1),r(C,{class:"opacity-0 group-hover:opacity-100",title:t.name,description:t.description,placement:"top"},null,8,["title","description"])])]),e("td",ae,[e("div",re,[t.description==null?(s(),m(B,{key:0})):(s(),i("span",le,_(t.description),1))])]),a.showEverything?(s(),i("td",ce,[e("div",de,[e("ul",pe,[(s(!0),i(g,null,x(t._attributes.instructions,(p,v)=>(s(),i("li",{key:v},_(p),1))),128))])])])):h("",!0),e("td",he,[e("div",ue,[r(f,{type:t.active.status?"success":"warning",text:t.active.name,showDot:!1},null,8,["type","text"]),r(C,{class:"opacity-0 group-hover:opacity-100",description:t.active.description,placement:"top"},null,8,["description"])])]),e("td",me,[e("div",_e,[t.offerDiscount.status?(s(),i(g,{key:0},[t.discountType.toLowerCase()=="fixed"?(s(),m(f,{key:0,type:"success",text:t.discountFixedRate.amountWithCurrency+" Discount",showDot:!1},null,8,["text"])):t.discountType.toLowerCase()=="percentage"?(s(),m(f,{key:1,type:"success",text:t.discountPercentageRate.valueSymbol+" Discount",showDot:!1},null,8,["text"])):h("",!0)],64)):h("",!0),t.offerFreeDelivery.status?(s(),m(f,{key:1,type:"success",text:"Free Delivery",showDot:!1})):h("",!0),r(C,{class:"opacity-0 group-hover:opacity-100",title:"Instructions",placement:"top"},{description:c(()=>[e("div",fe,[(s(!0),i(g,null,x(t._attributes.instructions,(p,v)=>(s(),i("p",{key:v},_(p),1))),128))])]),_:2},1024)])]),a.showEverything?(s(),i("td",ge,[e("div",ye,[e("span",null,_(o.formattedDatetime(t.createdAt)),1),r(C,{class:"opacity-0 group-hover:opacity-100",title:o.formattedRelativeDate(t.createdAt),placement:"top"},null,8,["title"])])])):h("",!0),e("td",Ce,[n.isDeleting(t)?h("",!0):(s(),i("a",{key:0,href:"#",onClick:b(p=>n.onView(t),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"View",8,we)),n.isDeleting(t)?(s(),m(A,{key:1,type:"danger"},{default:c(()=>[xe]),_:1})):(s(),i("a",{key:2,href:"#",onClick:b(p=>n.showDeleteConfirmationModal(t),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,be))])],10,oe))),128))]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(s(),i("div",ve,[e("div",ke,[De,e("p",null,[u("Create amazing incentives for your customers, such as offering "),r(f,{type:"primary",text:"discounts",showDot:!1,clickable:!0,action:n.onAddCoupon},null,8,["action"]),u(" and "),r(f,{type:"primary",text:"free delivery",showDot:!1,clickable:!0,action:n.onAddCoupon},null,8,["action"]),u(", while determining who can claim them and when.")]),r(k,{action:n.onAddCoupon,class:"w-40",size:"sm"},{default:c(()=>[Te]),_:1},8,["action"])]),Se])),a.deletableCoupon?(s(),m(V,{key:2,approveText:"Delete Coupon",approveAction:n.deleteCoupon,isLoading:n.isDeleting(a.deletableCoupon)},{content:c(()=>[Ie,e("p",Be,[u("Are you sure you want to permanently delete "),e("span",Ae,_(a.deletableCoupon.name),1),u("?")])]),trigger:c(t=>[r(P,{ref:"confirmDeleteButton",onClick:t.showModal,class:"hidden",type:"danger"},{default:c(()=>[u(" Delete Coupon ")]),_:2},1032,["onClick"])]),_:1},8,["approveAction","isLoading"])):h("",!0)])}const $e=Y(Z,[["render",Le]]);export{$e as default};
