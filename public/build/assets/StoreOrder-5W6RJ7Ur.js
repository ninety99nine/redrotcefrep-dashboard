import{c as A,i as le}from"./cloneDeep-BSUglKOW.js";import{A as G}from"./Alert-DoRT84Ne.js";import{F as N}from"./FormMixin-BJ8PeuZD.js";import{U as Q}from"./UtilsMixin-CBwmyCNB.js";import{r as u,o as s,c as n,b as e,F as y,k as v,d as a,w as l,e as p,f,n as Z,t as c,s as de,h as _,y as J,m as Y,p as ce,i as ue,u as me}from"./app-CEjZQ6df.js";import{u as j}from"./store-store-M1WmsIoF.js";import{T as he}from"./TextInput-CK3kfyTM.js";import{I as pe}from"./InputTags-D5ILNwN8.js";import{T as te}from"./TextHeader-Jo_fT9rL.js";import{B as fe}from"./BackButton-DSiMgTvj.js";import{N as ge}from"./NumberInput-FyHYtonN.js";import{S as ye}from"./SelectInput-CAesltQW.js";import{O as _e,a as we}from"./OrderPaymentStatus-DnDhY4st.js";import{C as K}from"./ConfirmModal-qRPWBp9y.js";import{S as F}from"./ShineEffect-C96Jtt2K.js";import{T as se}from"./TextareaInput-YQBUqAC3.js";import{L as B}from"./LineSkeleton-qpUbsI0L.js";import{P as X}from"./PrimaryButton-3P5o1uMS.js";import{S as oe}from"./SpinningLoader-huGTtUOZ.js";import{O as re}from"./OtpInput-D45RYY_L.js";import{S as xe}from"./SelectInputTags-SK1O3OTr.js";import{B as ke}from"./ButtonSkeleton-c7IpnzZH.js";import{M as R}from"./MoreInfoPopover-CEXwrCbN.js";import{B as be}from"./BackdropLoader-BW3yXSd8.js";import{B as q}from"./BadgeIndicator-B-Xd2hrd.js";import{N as ve}from"./NoDataPlaceholder-00dVNr5c.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{F as Pe}from"./FormErrorMessages-D8f9O8m6.js";import{A as Se}from"./AddButton-CrT7oati.js";import{B as Oe}from"./BasicTable-C9_qou_m.js";import{E as Te}from"./ExternalLink-CEFlH3Af.js";import{g as U,d as ie,p as I,a as Me}from"./api-repository-__UpBA-l.js";import{T as Ce}from"./ToogleSwitch-C3bK6_YF.js";import{T as Le}from"./TransactionPaymentStatus-GyonevSH.js";import{R as Ae}from"./RoundSkeleton-C18EMUm3.js";import"./form-store-CUa2LMmB.js";import"./InputErrorMessage-BxLOsLu7.js";import"./vue3-tags-input.esm-C5qE2vM-.js";import"./Button-BDzuDrb1.js";import"./SearchInput-9SEwacaJ.js";import"./index-D19FfSVG.js";const Be={mixins:[N],components:{Alert:G,ShineEffect:F,LineSkeleton:B,MoreInfoPopover:R,BadgeIndicator:q,NoDataPlaceholder:ve},props:{order:{type:Object},isLoadingOrder:{type:Boolean}},data(){return{storeState:j()}},computed:{store(){return this.storeState.store}},methods:{canViewProduct(o){return o._links.showProduct?o._links.showProduct:!1},onViewProduct(o){this.canViewProduct(o)?this.$router.push({name:"show-store-product",params:{store_href:this.store._links.showStore,product_href:o._links.showProduct}}):this.showUnsuccessfulNotification("This product does not exist anymore. It might be deleted")}}},Ve={class:"space-y-3 bg-white shadow-lg rounded-lg border p-4 mb-4"},De={class:"w-full text-sm text-left rtl:text-right text-gray-500"},Ee=["onClick"],Ue={class:"whitespace-nowrap px-4 py-3"},Ie={class:"w-80 whitespace-nowrap px-4 py-3"},Ne={class:"whitespace-nowrap px-4 py-3"},Fe={class:"whitespace-nowrap px-4 py-3 text-right"},Re={class:"whitespace-nowrap px-4 py-3 text-right"},qe={class:"text-xs text-right"},He={colspan:"1",class:"whitespace-nowrap px-4 py-2"},Ze={key:1},je={class:"text-xs text-right"},We={colspan:"1",class:"whitespace-nowrap px-4 py-2"},ze={key:1},Ye={class:"text-xs text-right"},Je={colspan:"1",class:"whitespace-nowrap px-4 py-2"},Ge={key:1},Qe={class:"text-right text-black text-lg font-bold border-t"},Ke={colspan:"1",class:"whitespace-nowrap px-4 py-3"},Xe={key:1};function $e(o,t,i,S,r,d){const w=u("LineSkeleton"),g=u("ShineEffect"),x=u("NoDataPlaceholder"),M=u("Alert");return s(),n("div",Ve,[t[6]||(t[6]=e("p",{class:"font-bold text-lg"},"Items",-1)),e("table",De,[t[4]||(t[4]=e("thead",{class:"font-bold text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("td",{class:"whitespace-nowrap px-4 py-3"},"Image"),e("td",{class:"w-80 whitespace-nowrap px-4 py-3"},"Name"),e("td",{class:"whitespace-nowrap px-4 py-3"},"Price"),e("td",{class:"whitespace-nowrap px-4 py-3 text-right"},"Quantity"),e("td",{class:"whitespace-nowrap px-4 py-3 text-right"},"Total")])],-1)),e("tbody",null,[i.isLoadingOrder?(s(),n(y,{key:0},v(3,(b,k)=>e("tr",{key:k,class:"border-b"},[(s(),n(y,null,v(5,(T,L)=>e("td",{key:L,class:"whitespace-nowrap px-4 py-3"},[a(g,null,{default:l(()=>[i.isLoadingOrder?(s(),p(w,{key:0})):f("",!0)]),_:1})])),64))])),64)):(s(!0),n(y,{key:1},v(i.order._relationships.cart._relationships.productLines,(b,k)=>(s(),n("tr",{key:k,onClick:()=>d.onViewProduct(b),class:Z(["border-b cursor-pointer",d.canViewProduct(b)?"hover:bg-gray-50":"hover:bg-red-50"])},[e("td",Ue,[a(x)]),e("td",Ie,[e("span",null,c(b.name),1)]),e("td",Ne,[e("span",null,c(b.unitPrice.amountWithCurrency),1)]),e("td",Fe,[e("span",null,c(b.quantity),1)]),e("td",Re,[e("span",null,c(b.grandTotal.amountWithCurrency),1)])],10,Ee))),128)),e("tr",qe,[t[0]||(t[0]=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-2"},"Subtotal",-1)),e("td",He,[i.isLoadingOrder?(s(),p(g,{key:0},{default:l(()=>[a(w)]),_:1})):(s(),n("span",Ze,c(i.order._relationships.cart.subTotal.amountWithCurrency),1))])]),e("tr",je,[t[1]||(t[1]=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-2"},"Sale Discount Total",-1)),e("td",We,[i.isLoadingOrder?(s(),p(g,{key:0},{default:l(()=>[a(w)]),_:1})):(s(),n("span",ze,c(i.order._relationships.cart.saleDiscountTotal.amount>0?"-":"")+" "+c(i.order._relationships.cart.saleDiscountTotal.amountWithCurrency),1))])]),e("tr",Ye,[t[2]||(t[2]=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-2"},"Coupon Discount Total",-1)),e("td",Je,[i.isLoadingOrder?(s(),p(g,{key:0},{default:l(()=>[a(w)]),_:1})):(s(),n("span",Ge,c(i.order._relationships.cart.couponDiscountTotal.amount>0?"-":"")+" "+c(i.order._relationships.cart.couponDiscountTotal.amountWithCurrency),1))])]),e("tr",Qe,[t[3]||(t[3]=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-3"},"Grand Total",-1)),e("td",Ke,[i.isLoadingOrder?(s(),p(g,{key:0},{default:l(()=>[a(w)]),_:1})):(s(),n("span",Xe,c(i.order._relationships.cart.grandTotal.amountWithCurrency),1))])])])]),i.order&&i.order.specialNote?(s(),p(M,{key:0},{default:l(()=>[t[5]||(t[5]=e("span",null,[e("svg",{class:"w-6 h-6 mr-2 inline-block",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"})]),e("span",{class:"font-bold mr-1"},"Special Note:")],-1)),e("span",null,c(i.order.specialNote),1)]),_:1})):f("",!0)])}const et=V(Be,[["render",$e]]),tt={mixins:[N,Q],components:{AddButton:Se,TextHeader:te,BasicTable:Oe,ExternalLink:Te,ConfirmModal:K,ShineEffect:F,LineSkeleton:B,SpinningLoader:oe,PrimaryButton:X,MoreInfoPopover:R,ToogleSwitch:Ce,BadgeIndicator:q,TransactionPaymentStatus:Le},props:{order:{type:Object},isLoadingOrder:{type:Boolean},refreshOrder:{type:Function}},data(){return{transactions:[],pagination:null,searchTerm:null,showEverything:!1,appName:de.appName,deletableTransaction:null,isDeletingTransactionIds:[],isLoadingTransactions:!1,storeState:j()}},computed:{store(){return this.storeState.store},tableHeaders(){return this.showEverything?["#","Description","Payment Status","Amount","Percentage","Payment Method","Paid By","Verified By","Requested By","DPO Payment Link","DPO Link Status","DPO Expiry Date","Created Date",""]:["#","Payment Status","Amount","Payment Method","Paid By","Verified By","Requested By","DPO Payment Link","DPO Link Status",""]},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{onView(o){this.$router.push({name:"show-store-transaction",params:{store_href:this.store._links.showStore,transaction_href:o._links.showTransaction}}).then(()=>{window.scrollTo(0,0)})},showDeleteConfirmationModal(o){this.deletableTransaction=o,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(o){return this.isDeletingTransactionIds.findIndex(t=>t==o.id)!=-1},paginate(o){this.url=o,this.getTransactions()},search(o){this.url=this.store._links.showOrderTransactions,this.searchTerm=o,this.getTransactions()},getTransactions(){this.isLoadingTransactions=!0;const o={_relationships:"customer,requestedByUser,manuallyVerifiedByUser,paymentMethod"};this.hasSearchTerm&&(o.search=this.searchTerm),U(this.url,o).then(t=>{t.status==200&&(this.pagination=t.data,this.transactions=this.pagination.data),this.isLoadingTransactions=!1}).catch(t=>{this.isLoadingTransactions=!1})},deleteTransaction(){this.isDeletingTransactionIds.push(this.deletableTransaction.id),ie(this.deletableTransaction._links.deleteTransaction).then(o=>{this.isDeletingTransactionIds.splice(this.isDeletingTransactionIds.findIndex(t=>t==this.deletableTransaction.id,1)),o.status==200&&(o.data.deleted?(this.showSuccessfulNotification("Transaction deleted"),this.isDeletingTransactionIds.length==0&&this.getTransactions()):(this.setFormError("general",o.data.message),this.showUnsuccessfulNotification(o.data.message)))}).catch(o=>{this.isDeletingTransactionIds.splice(this.isDeletingTransactionIds.findIndex(t=>t==this.deletableTransaction.id,1)),this.setServerFormErrors(o)})}},created(){this.url=this.order._links.showOrderTransactions,this.getTransactions()}},st={class:"flex justify-between items-center border-dashed border-b pb-4 mb-4"},ot={class:"flex items-center"},rt={class:"font-bold text-sm"},it={key:0},nt=["onClick"],at={class:"whitespace-nowrap px-4 py-4"},lt={class:"flex space-x-1 items-center"},dt={key:0,class:"px-4 py-4"},ct={class:"min-w-80"},ut={class:"whitespace-nowrap px-4 py-4"},mt={class:"whitespace-nowrap px-4 py-4 text-center"},ht={key:1,class:"whitespace-nowrap px-4 py-4 text-center"},pt={class:"whitespace-nowrap px-4 py-4 text-center"},ft={class:"whitespace-nowrap px-4 py-4"},gt={key:0},yt={key:1,class:"text-xs text-center text-gray-300"},_t={class:"text-xs text-center text-gray-300"},wt={key:0,class:"whitespace-nowrap px-4 py-4"},xt={class:"whitespace-nowrap px-4 py-4"},kt={key:0},bt={key:1,class:"text-xs text-center text-gray-300"},vt={class:"px-4 py-4"},Pt={key:0,class:"max-w-80"},St={key:1,class:"text-xs text-center text-gray-300"},Ot={class:"text-xs text-center text-gray-300"},Tt={key:0,class:"text-xs text-center text-gray-300"},Mt={key:2,class:"whitespace-nowrap px-4 py-4"},Ct={key:0,class:"flex space-x-1 items-center"},Lt={key:1,class:"text-xs text-center text-gray-300"},At={key:3,class:"whitespace-nowrap px-4 py-4"},Bt={class:"flex space-x-1 items-center"},Vt={class:"px-4 py-4 flex items-center space-x-4"},Dt=["onClick"],Et=["onClick"],Ut={key:1,class:"p-8 border rounded-lg bg-gray-50"},It={class:"flex justify-end"},Nt={class:"mb-8"},Ft={class:"font-bold text-black"};function Rt(o,t,i,S,r,d){const w=u("MoreInfoPopover"),g=u("ToogleSwitch"),x=u("LineSkeleton"),M=u("ShineEffect"),b=u("TransactionPaymentStatus"),k=u("BadgeIndicator"),T=u("ExternalLink"),L=u("SpinningLoader"),D=u("BasicTable"),O=u("PrimaryButton"),W=u("ConfirmModal");return s(),n("div",null,[e("div",st,[e("div",ot,[e("p",rt,[t[1]||(t[1]=_("Transactions ")),(r.pagination??{}).total>0?(s(),n("span",it,"("+c((r.pagination??{}).total)+")",1)):f("",!0)]),a(w,{class:"ml-2 mt-1",title:"What Is This?",description:"Transactions are records of payments made by customers for their orders.",placement:"top"})]),(r.pagination??{}).total>0?J(o.$slots,"actionButtons",{key:0}):f("",!0)]),r.isLoadingTransactions||(r.pagination??{}).total>0||d.hasSearchTerm?(s(),p(D,{key:0,pagination:r.pagination,isLoading:r.isLoadingTransactions,onPaginate:d.paginate,onSearch:d.search,onRefresh:d.getTransactions,totalHeaders:d.tableHeaders.length},{primaryFilters:l(()=>[a(g,{modelValue:r.showEverything,"onUpdate:modelValue":t[0]||(t[0]=h=>r.showEverything=h),size:"md",labelPopoverTitle:"What Is This?",labelPopoverDescription:"Turn on if you want to show more information about your transactions"},{default:l(()=>t[2]||(t[2]=[_(" Show Everything ")])),_:1},8,["modelValue"])]),head:l(()=>[e("tr",null,[(s(!0),n(y,null,v(d.tableHeaders,(h,C)=>(s(),n("th",{key:C,scope:"col",class:"whitespace-nowrap px-4 py-3"},c(h),1))),128))])]),body:l(()=>[r.isLoadingTransactions?(s(),n(y,{key:0},v(3,(h,C)=>e("tr",{key:C,class:"border-b"},[(s(!0),n(y,null,v(d.tableHeaders,($,z)=>(s(),n("td",{key:z,class:"whitespace-nowrap px-4 py-3"},[a(M,null,{default:l(()=>[a(x)]),_:1})]))),128))])),64)):(s(!0),n(y,{key:1},v(r.transactions,h=>(s(),n("tr",{onClick:Y(C=>d.onView(h),["stop"]),key:h.id,class:"group cursor-pointer bg-white hover:bg-gray-50 border-b"},[e("td",at,[e("div",lt,[e("span",null,"#"+c(h._attributes.number),1),a(w,{class:"opacity-0 group-hover:opacity-100",title:"#"+h._attributes.number,description:h.description,placement:"top"},null,8,["title","description"])])]),r.showEverything?(s(),n("td",dt,[e("div",ct,c(h.description),1)])):f("",!0),e("td",ut,[a(b,{transaction:h},null,8,["transaction"])]),e("td",mt,c(h.amount.amountWithCurrency),1),r.showEverything?(s(),n("td",ht,c(h.percentage.valueSymbol),1)):f("",!0),e("td",pt,c(h._relationships.paymentMethod.name),1),e("td",ft,[h._relationships.paidByUser?(s(),n("span",gt,c(h._relationships.paidByUser._attributes.name),1)):(s(),n("span",yt,"---"))]),e("td",_t,[h._relationships.verifiedByUser?(s(),n("span",wt,c(h._relationships.verifiedByUser._attributes.name),1)):(s(),p(k,{key:1,type:"info",text:r.appName,showDot:!1},null,8,["text"]))]),e("td",xt,[h._relationships.requestedByUser?(s(),n("span",kt,c(h._relationships.requestedByUser._attributes.name),1)):(s(),n("span",bt,"---"))]),e("td",vt,[h.dpoPaymentUrl?(s(),n("div",Pt,[a(T,{url:h.dpoPaymentUrl,class:"text-xs"},{default:l(()=>[_(c(h.dpoPaymentUrl),1)]),_:2},1032,["url"])])):(s(),n("span",St,"---"))]),e("td",Ot,[h._attributes.dpoPaymentLinkHasExpired==null?(s(),n("span",Tt,"---")):(s(),p(k,{key:1,type:h._attributes.dpoPaymentLinkHasExpired==!1?"success":"warning",text:h._attributes.dpoPaymentLinkHasExpired==!1?"Active":"Expired",showDot:!1},null,8,["type","text"]))]),r.showEverything?(s(),n("td",Mt,[h.dpoPaymentUrlExpiresAt?(s(),n("div",Ct,[e("span",null,c(o.formattedDatetime(h.dpoPaymentUrlExpiresAt)),1),a(w,{class:"opacity-0 group-hover:opacity-100",title:o.formattedRelativeDate(h.dpoPaymentUrlExpiresAt),placement:"top"},null,8,["title"])])):(s(),n("span",Lt,"---"))])):f("",!0),r.showEverything?(s(),n("td",At,[e("div",Bt,[e("span",null,c(o.formattedDatetime(h.createdAt)),1),a(w,{class:"opacity-0 group-hover:opacity-100",title:o.formattedRelativeDate(h.createdAt),placement:"top"},null,8,["title"])])])):f("",!0),e("td",Vt,[d.isDeleting(h)?f("",!0):(s(),n("a",{key:0,href:"#",onClick:Y(C=>d.onView(h),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"Edit",8,Dt)),d.isDeleting(h)?(s(),p(L,{key:1,type:"danger"},{default:l(()=>t[3]||(t[3]=[e("span",{class:"text-xs ml-2"},"Deleting...",-1)])),_:1})):(s(),n("a",{key:2,href:"#",onClick:Y(C=>d.showDeleteConfirmationModal(h),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,Et))])],8,nt))),128))]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(s(),n("div",Ut,[t[4]||(t[4]=ce('<div class="flex justify-between space-x-20 mb-2"><div><span class="text-8xl">💵</span></div><div class="space-y-3"><h1 class="text-lg font-bold">No Transactions Yet</h1><p class="text-sm">Your transactions will appear here once customers start paying for this order. <span class="underline decoration-dashed underline-offset-4">Request payments</span> or <span class="underline decoration-dashed underline-offset-4">mark this order as paid</span>.</p></div></div>',1)),e("div",It,[J(o.$slots,"actionButtons")])])),r.deletableTransaction?(s(),p(W,{key:2,approveText:"Delete Transaction",approveAction:d.deleteTransaction,isLoading:d.isDeleting(r.deletableTransaction)},{content:l(()=>[t[7]||(t[7]=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),e("p",Nt,[t[5]||(t[5]=_("Are you sure you want to permanently delete ")),e("span",Ft,"transaction #"+c(r.deletableTransaction._attributes.number),1),t[6]||(t[6]=_("?"))])]),trigger:l(h=>[a(O,{ref:"confirmDeleteButton",action:h.showModal,class:"hidden",type:"danger"},{default:l(()=>t[8]||(t[8]=[_(" Delete Transaction ")])),_:2},1032,["action"])]),_:1},8,["approveAction","isLoading"])):f("",!0)])}const qt=V(tt,[["render",Rt]]),Ht={mixins:[N],components:{LineSkeleton:B,MoreInfoPopover:R,BadgeIndicator:q,OrderTransactions:qt},props:{order:{type:Object},isLoadingOrder:{type:Boolean},refreshOrder:{type:Function}},data(){return{}}},Zt={class:"mb-4"},jt={class:"bg-white shadow-lg rounded-lg border p-4"},Wt={class:"space-y-3"},zt={class:"flex items-center space-x-2 text-sm"},Yt={key:1,class:"font-bold"},Jt={key:1,class:"w-3/4 flex items-center space-x-4"},Gt={class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700"},Qt={class:"text-xs"},Kt={key:0,class:"bg-white shadow-lg rounded-lg border p-4 mt-4"};function Xt(o,t,i,S,r,d){const w=u("LineSkeleton"),g=u("OrderTransactions");return s(),n("div",Zt,[e("div",jt,[e("div",Wt,[t[1]||(t[1]=e("p",{class:"font-bold text-lg"},"Payment",-1)),e("div",zt,[t[0]||(t[0]=e("span",null,"Amount Paid: ",-1)),i.isLoadingOrder?(s(),p(w,{key:0,width:"w-32"})):(s(),n("span",Yt,c(i.order.paidTotal.amountWithCurrency),1))]),i.isLoadingOrder?(s(),p(w,{key:0,width:"w-full"})):(s(),n("div",Jt,[e("div",Gt,[e("div",{class:"bg-green-500 h-2.5 rounded-full",style:ue("width: "+i.order.paidPercentage.value+"%")},null,4)]),e("span",Qt,c(i.order.paidPercentage.valueSymbol),1)]))])]),i.isLoadingOrder?f("",!0):(s(),n("div",Kt,[a(g,{order:i.order,refreshOrder:i.refreshOrder},{actionButtons:l(()=>[J(o.$slots,"actionButtons")]),_:3},8,["order","refreshOrder"])]))])}const $t=V(Ht,[["render",Xt]]),es={components:{ShineEffect:F,LineSkeleton:B},props:{order:{type:Object},isLoadingOrder:{type:Boolean}},computed:{hasCustomer(){return this.order._relationships.customer!=null},customer(){return this.order._relationships.customer}}},ts={class:"bg-white shadow-lg rounded-lg border space-y-3 p-4"},ss={class:"flex items-center space-x-2"},os={key:1,class:"font-bold"},rs={key:2,class:"font-bold text-lg"},is={class:"space-y-2"},ns={key:0,class:"flex items-center space-x-2 text-sm"},as={key:1,class:"font-bold"},ls={key:1,class:"flex items-center space-x-2 text-sm"},ds={key:1,class:"font-bold"},cs={key:1,class:"text-xs"};function us(o,t,i,S,r,d){const w=u("LineSkeleton"),g=u("ShineEffect");return s(),n("div",ts,[e("div",ss,[t[0]||(t[0]=e("div",{class:"p-1.5 bg-gray-100 rounded-full border border-gray-200"},[e("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})])],-1)),i.isLoadingOrder?(s(),p(g,{key:0},{default:l(()=>[a(w,{width:"w-32"})]),_:1})):i.order._attributes.customerName?(s(),n("span",os,c(i.order._attributes.customerName),1)):(s(),n("span",rs,"Customer"))]),e("div",is,[i.isLoadingOrder||i.order.customerMobileNumber||i.order.customerEmail?(s(),n(y,{key:0},[i.isLoadingOrder||i.order.customerMobileNumber?(s(),n("div",ns,[t[1]||(t[1]=e("svg",{class:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"})],-1)),i.isLoadingOrder?(s(),p(g,{key:0},{default:l(()=>[a(w,{width:"w-32"})]),_:1})):(s(),n("span",as,c(i.order.customerMobileNumber.national),1))])):f("",!0),i.isLoadingOrder||i.order.customerEmail?(s(),n("div",ls,[t[2]||(t[2]=e("svg",{class:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})],-1)),i.isLoadingOrder?(s(),p(g,{key:0},{default:l(()=>[a(w,{width:"w-32"})]),_:1})):(s(),n("span",ds,c(i.order.customerEmail),1))])):f("",!0)],64)):(s(),n("span",cs,"No information"))])])}const ms=V(es,[["render",us]]),hs={mixins:[N,Q],components:{Alert:G,ConfirmModal:K,ShineEffect:F,TextareaInput:se,OtpInput:re,LineSkeleton:B,PrimaryButton:X,RoundSkeleton:Ae,MoreInfoPopover:R,BadgeIndicator:q},props:{order:{type:Object},refreshOrder:{type:Function},isLoadingOrder:{type:Boolean}},data(){return{collectionCode:"",collectionNote:"",storeState:j(),isUpdatingOrderStatus:!1}},computed:{store(){return this.storeState.store},isVerified(){return this.order.collectionVerified.status},collectionVerifiedByUser(){return this.order._relationships.collectionVerifiedByUser},canManageOrders(){return this.store._relationships.userStoreAssociation._attributes.canManageOrders}},methods:{verifyOrderCollection(o){this.isUpdatingOrderStatus=!0;var t={collectionCode:this.collectionCode};this.collectionNote.trim()!=""&&(t.collectionNote=this.collectionNote),I(this.order._links.verifyOrderCollection,t).then(i=>{i.status==200&&(o(),this.refreshOrder(),this.showSuccessfulNotification("Order collection confirmed")),this.isUpdatingOrderStatus=!1}).catch(i=>{this.isUpdatingOrderStatus=!1,this.setServerFormErrors(i)})}}},ps={class:"bg-white shadow-lg rounded-lg border space-y-3 p-4 mb-4"},fs={key:0,class:"flex items-center space-x-2"},gs={key:1,class:"flex items-center space-x-2 font-bold text-lg"},ys={class:"text-xs"},_s={key:3,class:"flex space-x-1"},ws={key:0,class:"flex space-x-1 items-center"},xs={class:"font-bold text-xs"},ks={key:1},bs={class:"font-bold text-xs"},vs={key:5,class:"space-y-2 pb-2"},Ps={class:"flex items-center space-x-2 text-xs"},Ss={class:"font-bold"},Os={class:"flex items-center space-x-2 text-xs"},Ts={key:0,class:"flex space-x-2"},Ms={class:"font-bold"},Cs={key:0,class:"flex space-x-1 border-t border-dashed pt-4"},Ls={class:"text-xs"},As={key:6,class:"border-b border-dashed"},Bs={class:"space-y-4 mb-8"},Vs={class:"flex justify-end"};function Ds(o,t,i,S,r,d){const w=u("RoundSkeleton"),g=u("ShineEffect"),x=u("LineSkeleton"),M=u("MoreInfoPopover"),b=u("Alert"),k=u("OtpInput"),T=u("TextareaInput"),L=u("PrimaryButton"),D=u("ConfirmModal");return s(),n("div",ps,[i.isLoadingOrder?(s(),n("div",fs,[a(g,null,{default:l(()=>[a(w,{size:"w-6 h-6"})]),_:1}),t[2]||(t[2]=e("p",{class:"font-bold text-lg"},"Collection",-1))])):!i.isLoadingOrder&&d.isVerified?(s(),n("div",gs,t[3]||(t[3]=[e("svg",{class:"w-6 h-6 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1),e("span",null,"Collected",-1)]))):f("",!0),!i.isLoadingOrder&&!d.isVerified?(s(),n(y,{key:2},[t[4]||(t[4]=e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})]),e("p",{class:"font-bold text-lg"},"Confirm Collection")],-1)),e("p",ys,c(i.order.collectionVerified.description),1)],64)):f("",!0),i.isLoadingOrder?(s(),n("div",_s,[a(x,{width:"w-12"}),a(x,{width:"w-24"}),a(x,{width:"w-4"})])):i.order.collectionType||i.order.destinationName?(s(),n("div",{key:4,class:Z(["flex items-end space-x-4 text-sm",i.isLoadingOrder||!i.isLoadingOrder&&d.isVerified?"border-b border-dashed pb-2":"border-t border-dashed pt-2 mt-2"])},[i.order.collectionType?(s(),n("div",ws,[t[5]||(t[5]=e("span",{class:"text-xs"},"Type: ",-1)),e("span",xs,c(i.order.collectionType.name),1),a(M,{title:i.order.collectionType.description,placement:"top"},null,8,["title"])])):f("",!0),i.order.destinationName?(s(),n("div",ks,[t[6]||(t[6]=e("span",{class:"text-xs"},"Location: ",-1)),e("span",bs,c(i.order.destinationName),1)])):f("",!0)],2)):f("",!0),i.isLoadingOrder||!i.isLoadingOrder&&d.isVerified?(s(),n("div",vs,[e("div",Ps,[t[7]||(t[7]=e("div",{class:"flex items-center space-x-1"},[e("svg",{class:"w-4 h-4 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})]),e("span",null,"Verified By: ")],-1)),i.isLoadingOrder?(s(),p(x,{key:0,width:"w-24"})):(s(),n(y,{key:1},[e("span",Ss,c(d.collectionVerifiedByUser._attributes.name),1),a(M,{title:"Contact: "+d.collectionVerifiedByUser.mobileNumber.national,placement:"top"},null,8,["title"])],64))]),e("div",Os,[t[8]||(t[8]=e("div",{class:"flex items-center space-x-1"},[e("svg",{class:"w-4 h-4 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]),e("span",null,"Verified Date:")],-1)),i.isLoadingOrder?(s(),n("div",Ts,[a(x,{width:"w-32"}),a(x,{width:"w-4"})])):(s(),n(y,{key:1},[e("span",Ms,c(o.formattedDatetime(i.order.collectionVerifiedAt)),1),a(M,{title:o.formattedRelativeDate(i.order.collectionVerifiedAt),placement:"top"},null,8,["title"])],64))]),i.isLoadingOrder||i.order.collectionNote?(s(),n("div",Cs,[i.isLoadingOrder?(s(),n(y,{key:0},[i.isLoadingOrder?(s(),p(x,{key:0,width:"w-4"})):f("",!0),i.isLoadingOrder?(s(),p(x,{key:1,width:"w-32"})):f("",!0)],64)):(s(),n(y,{key:1},[t[9]||(t[9]=e("svg",{class:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})],-1)),e("p",Ls,c(i.order.collectionNote),1)],64))])):f("",!0)])):f("",!0),!i.isLoadingOrder&&!d.isVerified?(s(),n("div",As)):f("",!0),!i.isLoadingOrder&&!d.isVerified?(s(),p(D,{key:7,declineText:"Cancel",declineType:"light",isLoading:r.isUpdatingOrderStatus,autoHide:!1,approveAction:O=>d.verifyOrderCollection(O),approveText:"Confirm Collection",approveType:"primary",approveDisabled:r.collectionCode.length<6||r.isUpdatingOrderStatus},{content:l(()=>[e("div",Bs,[t[11]||(t[11]=e("p",{class:"text-lg font-bold border-b border-dashed pb-4"},"Confirm Collection",-1)),i.order._attributes.dialToShowCollectionCode?(s(),p(b,{key:0},{default:l(()=>[t[10]||(t[10]=e("span",{class:"font-bold mr-1"},"How to verify collection",-1)),_(" - "+c(i.order._attributes.dialToShowCollectionCode.instruction),1)]),_:1})):f("",!0),a(k,{modelValue:r.collectionCode,"onUpdate:modelValue":t[0]||(t[0]=O=>r.collectionCode=O),errorText:o.getFormError("collectionCode"),class:"mb-8"},null,8,["modelValue","errorText"]),a(T,{modelValue:r.collectionNote,"onUpdate:modelValue":t[1]||(t[1]=O=>r.collectionNote=O),label:"Note (Optional)",placeholder:"Collected by John Doe",rows:2,errorText:o.getFormError("collectionNote"),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Important note regarding this order collection e.g Collected by John Doe"},null,8,["modelValue","errorText"])])]),trigger:l(O=>[e("div",Vs,[a(L,{ref:"confirmCollection",size:"xs",type:"light",action:O.showModal,disabled:r.isUpdatingOrderStatus},{default:l(()=>t[12]||(t[12]=[_(" Confirm Collection ")])),_:2},1032,["action","disabled"])])]),_:1},8,["isLoading","approveAction","approveDisabled"])):f("",!0)])}const Es=V(hs,[["render",Ds]]),Us={mixins:[Q,N],components:{Alert:G,TextInput:he,TextHeader:te,InputTags:pe,BackButton:fe,NumberInput:ge,SelectInput:ye,OrderStatus:_e,ConfirmModal:K,ShineEffect:F,TextareaInput:se,LineSkeleton:B,PrimaryButton:X,SpinningLoader:oe,OtpInput:re,SelectInputTags:xe,ButtonSkeleton:ke,MoreInfoPopover:R,BackdropLoader:be,CartSummary:et,OrderPaymentStatus:we,BadgeIndicator:q,FormErrorMessages:Pe,PaymentSummary:$t,CustomerSummary:ms,CollectionSummary:Es},data(){return{form:{number:""},markAsPaid:{percentage:null,paymentMethods:[],paymentMethodId:null,proofOfPaymentPhoto:null},_requestPayment:{percentage:null,paymentMethods:[],paymentMethodId:null},order:null,isDeleting:!1,originalForm:null,collectionCode:"",collectionNote:"",isSubmitting:!1,markAsPaidAmount:0,followUpStatus:null,isLoadingOrder:!1,cancellationReason:"",isMarkingAsPaid:!1,cancellationReasons:[],apiState:me(),markAsPaidPercentage:0,proofOfPaymentPhoto:null,isRequestingPayment:!1,storeState:j(),isUpdatingOrderStatus:!1,payableAmountPercentage:null,isLoadingCancellationReasons:!1}},watch:{"$route.params.order_href"(o,t){window.scrollTo(0,0),this.getOrder()}},computed:{store(){return this.storeState.store},isVerified(){return((this.order||{}).collectionVerified||{}).status},canMarkAsPaid(){return((this.order||{})._attributes||{}).canMarkAsPaid},followUpStatuses(){return((this.order||{})._attributes||{}).followUpStatuses},canRequestPayment(){return((this.order||{})._attributes||{}).canRequestPayment},mobileVerificationShortcode(){return this.apiState.apiHome.mobileVerificationShortcode},isCreating(){return this.$route.name==="create-store-order"},isEditting(){return this.$route.name==="show-store-order"},statusBadgeType(){var o=((this.order||{}).status||{}).name.toLowerCase();return o=="completed"?"success":o=="cancelled"?"warning":o=="on its way"||o=="ready for pickup"?"primary":"info"},formHasChanged(){var o=A(this.form),t=A(this.originalForm);return!le(o,t)},mustSaveChanges(){return this.isEditting&&this.formHasChanged&&!this.isLoadingOrder&&!this.isSubmitting},mustCreate(){return this.isCreating&&this.formHasChanged&&!this.isLoadingOrder&&!this.isSubmitting}},methods:{goBack(){this.$router.replace({name:"show-store-orders",params:{store_href:this.store._links.showStore}})},setOrderFields(){this.form.number=this.order.number,this.order._attributes.payableAmounts.length&&(this._requestPayment.percentage=this.order._attributes.payableAmounts[0].percentage.toString(),this.markAsPaid.percentage=this.order._attributes.payableAmounts[0].percentage.toString()),this.originalForm=A(this.form)},confirmUpdateStatus(o){this.followUpStatus=o,this.followUpStatus.name.toLowerCase()=="cancelled"&&this.cancellationReasons.length==0&&this.getCancellationReasons(),this.$nextTick(()=>{this.$refs.confirmUpdateOrderStatus.$el.click()})},confirmMarkAsPaid(){this.$refs.confirmMarkAsPaid.$el.click()},confirmRequestPayment(){this.$refs.confirmRequestPayment.$el.click()},getOrder(){this.isLoadingOrder=!0;const o={_relationships:"cart,customer,occasion,collectionVerifiedByUser"};U(this.$route.params.order_href,o).then(t=>{t.status==200&&(t.data.exists?(this.order=t.data.order,this.setOrderFields(),this.canRequestPayment&&this._requestPayment.paymentMethods.length==0&&this.showPaymentMethodsForRequestingOrderPayment(),this.markAsPaid.paymentMethods.length==0&&this.showPaymentMethodsForMarkingAsPaid()):(this.showUnsuccessfulNotification("This order does not exist"),this.$router.push({name:"show-store-orders",params:{store_href:this.store._links.showStore}}))),this.isLoadingOrder=!1}).catch(t=>{this.isLoadingOrder=!1,this.setServerFormErrors(t)})},showPaymentMethodsForRequestingOrderPayment(){this.isLoadingPaymentMethodsForMarkingAsPaidForRequestingOrderPayment=!0,U(this.order._links.showPaymentMethodsForRequestingOrderPayment).then(o=>{o.status==200&&(this._requestPayment.paymentMethods=o.data.data,this._requestPayment.paymentMethods.length&&(this._requestPayment.paymentMethodId=this._requestPayment.paymentMethods[0].id.toString())),this.isLoadingPaymentMethodsForMarkingAsPaidForRequestingOrderPayment=!1}).catch(o=>{this.isLoadingPaymentMethodsForMarkingAsPaidForRequestingOrderPayment=!1,this.setServerFormErrors(o)})},showPaymentMethodsForMarkingAsPaid(){this.isLoadingPaymentMethodsForMarkingAsPaid=!0,U(this.order._links.showPaymentMethodsForMarkingAsPaid).then(o=>{o.status==200&&(this.markAsPaid.paymentMethods=o.data.data,this.markAsPaid.paymentMethods.length&&(this.markAsPaid.paymentMethodId=this.markAsPaid.paymentMethods[0].id.toString())),this.isLoadingPaymentMethodsForMarkingAsPaid=!1}).catch(o=>{this.isLoadingPaymentMethodsForMarkingAsPaid=!1,this.setServerFormErrors(o)})},getCancellationReasons(){this.isLoadingCancellationReasons=!0,U(this.order._links.showOrderCancellationReasons).then(o=>{o.status==200&&(this.cancellationReasons=o.data),this.isLoadingCancellationReasons=!1}).catch(o=>{this.isLoadingCancellationReasons=!1,this.setServerFormErrors(o)})},parseForm(){var o=A(this.form);return o.hoursOfDay=o.hoursOfDay.map(t=>t.text),o.daysOfTheWeek=o.daysOfTheWeek.map(t=>t.text),o.daysOfTheMonth=o.daysOfTheMonth.map(t=>t.text),o.monthsOfTheYear=o.monthsOfTheYear.map(t=>t.text),o},createOrder(){this.isSubmitting=!0,I(this.store._links.createOrders,this.parseForm()).then(o=>{o.status==200&&(this.showSuccessfulNotification("Order created"),this.$router.push({name:"show-store-orders",params:{store_href:this.store._links.showStore}}),window.scrollTo(0,0)),this.isSubmitting=!1}).catch(o=>{this.isSubmitting=!1,this.setServerFormErrors(o)})},updateOrder(){this.isSubmitting=!0,Me(this.order._links.showOrder,this.parseForm()).then(o=>{o.status==200&&(this.originalForm=A(this.form),this.showSuccessfulNotification("Order updated")),this.isSubmitting=!1}).catch(o=>{this.isSubmitting=!1,this.setServerFormErrors(o)})},updateOrderStatus(o,t){this.isUpdatingOrderStatus=!0;var i={status:o};o.toLowerCase()=="completed"&&!this.isVerified&&(i.collectionCode=this.collectionCode,this.collectionNote.trim()!=""&&(i.collectionNote=this.collectionNote)),o.toLowerCase()=="cancelled"&&this.cancellationReason.trim()!=""&&(i.cancellationReason=this.cancellationReason),I(this.order._links.updateOrderStatus,i).then(S=>{S.status==200&&(S.data.updated?(t(),this.getOrder(),this.showSuccessfulNotification("Order updated")):this.showUnsuccessfulNotification(S.data.message)),this.isUpdatingOrderStatus=!1}).catch(S=>{this.isUpdatingOrderStatus=!1,this.setServerFormErrors(S)})},requestPayment(o){this.isRequestingPayment=!0;var t={percentage:this._requestPayment.percentage,paymentMethodId:this._requestPayment.paymentMethodId};return I(this.order._links.requestPayment,t).then(i=>{i.status==200&&(o(),this.getOrder(),this.showSuccessfulNotification("Payment requested")),this.isRequestingPayment=!1}).catch(i=>{this.isRequestingPayment=!1,this.setServerFormErrors(i)})},markAsUnverifiedPayment(o){this.isMarkingAsPaid=!0;var t={percentage:this.markAsPaid.percentage,paymentMethodId:this.markAsPaid.paymentMethodId,proofOfPaymentPhoto:this.markAsPaid.proofOfPaymentPhoto};this.markAsPaidAmount?t.amount=this.markAsPaidAmount:this.markAsPaidPercentage&&(t.percentage=this.markAsPaidPercentage),I(this.order._links.markAsUnverifiedPayment,t).then(i=>{i.status==200&&(this.getOrder(),o&&o(),this.showSuccessfulNotification("Order marked as paid")),this.isMarkingAsPaid=!1}).catch(i=>{this.isMarkingAsPaid=!1,this.setServerFormErrors(i)})},deleteOrder(){this.isDeleting=!0,ie(this.order._links.deleteOrder).then(o=>{o.status==200&&(o.data.deleted?(this.showSuccessfulNotification("Order deleted"),this.$router.push({name:"show-store-orders",params:{store_href:this.store._links.showStore}}),window.scrollTo(0,0)):(this.setFormError("general",o.data.message),this.showUnsuccessfulNotification(o.data.message))),this.isDeleting=!1}).catch(o=>{this.isDeleting=!1,this.setServerFormErrors(o)})}},created(){this.originalForm=A(this.form),this.isEditting&&this.getOrder()}},Is={class:"flex justify-between items-center border-dashed py-6"},Ns={class:"flex justify-start"},Fs={key:0,class:"flex items-center space-x-2"},Rs={key:1,class:"flex items-center"},qs={key:0,class:"flex space-x-1 items-center"},Hs={class:"font-bold"},Zs={class:"relative",action:"#",method:"POST"},js={class:"flex items-center space-x-2"},Ws={class:"grid grid-cols-12 gap-4 mb-8"},zs={class:"col-span-8"},Ys={class:"bg-white shadow-lg rounded-lg border space-y-4 p-4 mb-4"},Js={class:"flex items-center justify-between"},Gs={class:"w-full flex items-center space-x-2"},Qs={class:"w-full flex items-center space-x-2"},Ks={class:"flex items-center"},Xs={class:"font-bold"},$s={class:"flex justify-end space-x-2"},eo={class:"col-span-4 space-y-4"},to={class:"flex flex-col justify-between bg-white shadow-lg rounded-lg border p-4"},so={class:"space-y-4"},oo={key:0},ro={class:"flex space-x-2"},io={key:1},no={class:"flex items-center whitespace-pre"},ao={key:1,class:"font-bold text-black"},lo={class:"flex justify-end"},co={class:"mb-8"},uo={class:"font-bold text-black"},mo={class:"text-lg border-b border-dashed pb-4 mb-4"},ho={class:"font-bold"},po={class:"mb-4"},fo=["value"],go={class:"space-y-4 mb-4"},yo=["value"],_o=["value"],wo={class:"space-y-4 mb-4"},xo=["value"],ko=["value"];function bo(o,t,i,S,r,d){const w=u("BackButton"),g=u("LineSkeleton"),x=u("ShineEffect"),M=u("TextHeader"),b=u("MoreInfoPopover"),k=u("PrimaryButton"),T=u("Alert"),L=u("FormErrorMessages"),D=u("OrderStatus"),O=u("OrderPaymentStatus"),W=u("CartSummary"),h=u("ButtonSkeleton"),C=u("PaymentSummary"),$=u("CustomerSummary"),z=u("CollectionSummary"),ee=u("BadgeIndicator"),H=u("ConfirmModal"),ne=u("OtpInput"),ae=u("TextareaInput"),E=u("SelectInput");return s(),n("div",null,[e("div",Is,[e("div",Ns,[a(w,{class:"w-16 mr-4",action:d.goBack},null,8,["action"]),r.isLoadingOrder?(s(),n("div",Fs,[t[7]||(t[7]=e("span",{class:"text-2xl font-bold tracking-tight text-gray-300 animate-pulse"},"Order #",-1)),a(x,{class:"flex space-x-2"},{default:l(()=>[a(g,{width:"w-12 mt-2"}),a(g,{width:"w-4 mt-2"})]),_:1})])):(s(),n("div",Rs,[a(M,null,{default:l(()=>[_(c(d.isCreating?"Add Order":"Order #"+r.order._attributes.number),1)]),_:1}),a(b,{class:"ml-2 mt-1",title:"What Is This?",description:"Orders are requests placed by customers to purchase products or services from your store.",placement:"top"})]))]),d.isEditting?(s(),n("div",qs,[r.isLoadingOrder?(s(),p(x,{key:0,class:"flex space-x-2"},{default:l(()=>[a(g,{width:"w-20"}),a(g,{width:"w-32"}),a(g,{width:"w-4"})]),_:1})):(s(),n(y,{key:1},[t[8]||(t[8]=e("span",null,"Created:",-1)),e("span",Hs,c(o.formattedDatetime(r.order.createdAt)),1),a(b,{title:o.formattedRelativeDate(r.order.createdAt),placement:"top"},null,8,["title"])],64))])):f("",!0)]),e("form",Zs,[d.mustCreate||d.mustSaveChanges?(s(),p(T,{key:0,type:"warning",class:"flex justify-between items-center mb-2"},{default:l(()=>[e("div",js,[t[9]||(t[9]=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})],-1)),e("span",null,c(d.isCreating?"Create your order":"Please save your changes"),1)]),a(k,{action:d.isCreating?d.createOrder:d.updateOrder,loading:r.isSubmitting,class:"w-40"},{default:l(()=>[_(c(d.isCreating?"Create Order":"Save Changes"),1)]),_:1},8,["action","loading"])]),_:1})):f("",!0),e("div",Ws,[e("div",zs,[a(L),e("div",Ys,[e("div",Js,[e("div",Gs,[t[10]||(t[10]=e("span",{class:"text-xs"},"Status:",-1)),r.isLoadingOrder?(s(),p(x,{key:0},{default:l(()=>[a(g,{width:"w-24"})]),_:1})):(s(),p(D,{key:1,order:r.order},null,8,["order"]))]),e("div",Qs,[t[11]||(t[11]=e("span",{class:"text-xs"},"Payment Status:",-1)),r.isLoadingOrder?(s(),p(x,{key:0},{default:l(()=>[a(g,{width:"w-24"})]),_:1})):(s(),p(O,{key:1,order:r.order},null,8,["order"]))])]),r.order&&r.order.cancellationReason?(s(),p(T,{key:0,type:"warning"},{default:l(()=>[e("div",Ks,[t[12]||(t[12]=e("span",null,[e("svg",{class:"w-4 h-4 mr-2 inline-block",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.05 4.575a1.575 1.575 0 1 0-3.15 0v3m3.15-3v-1.5a1.575 1.575 0 0 1 3.15 0v1.5m-3.15 0 .075 5.925m3.075.75V4.575m0 0a1.575 1.575 0 0 1 3.15 0V15M6.9 7.575a1.575 1.575 0 1 0-3.15 0v8.175a6.75 6.75 0 0 0 6.75 6.75h2.018a5.25 5.25 0 0 0 3.712-1.538l1.732-1.732a5.25 5.25 0 0 0 1.538-3.712l.003-2.024a.668.668 0 0 1 .198-.471 1.575 1.575 0 1 0-2.228-2.228 3.818 3.818 0 0 0-1.12 2.687M6.9 7.575V12m6.27 4.318A4.49 4.49 0 0 1 16.35 15m.002 0h-.002"})]),e("span",{class:"mr-1"},"Cancellation Reason:")],-1)),e("span",Xs,c(r.order.cancellationReason),1)])]),_:1})):f("",!0)]),a(W,{order:r.order,isLoadingOrder:r.isLoadingOrder},null,8,["order","isLoadingOrder"]),a(C,{order:r.order,isLoadingOrder:r.isLoadingOrder,refreshOrder:d.getOrder},{actionButtons:l(()=>[e("div",$s,[d.isEditting&&r.isLoadingOrder?(s(),p(h,{key:0,size:"xs"},{default:l(()=>t[13]||(t[13]=[e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 7.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"}),e("path",{"fill-rule":"evenodd",d:"M1.5 4.875C1.5 3.839 2.34 3 3.375 3h17.25c1.035 0 1.875.84 1.875 1.875v9.75c0 1.036-.84 1.875-1.875 1.875H3.375A1.875 1.875 0 0 1 1.5 14.625v-9.75ZM8.25 9.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM18.75 9a.75.75 0 0 0-.75.75v.008c0 .414.336.75.75.75h.008a.75.75 0 0 0 .75-.75V9.75a.75.75 0 0 0-.75-.75h-.008ZM4.5 9.75A.75.75 0 0 1 5.25 9h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H5.25a.75.75 0 0 1-.75-.75V9.75Z","clip-rule":"evenodd"}),e("path",{d:"M2.25 18a.75.75 0 0 0 0 1.5c5.4 0 10.63.722 15.6 2.075 1.19.324 2.4-.558 2.4-1.82V18.75a.75.75 0 0 0-.75-.75H2.25Z"})],-1),e("span",null,"Mark As Paid",-1)])),_:1})):r.order&&d.canMarkAsPaid?(s(),p(k,{key:1,action:d.confirmMarkAsPaid,disabled:r.isMarkingAsPaid,loading:r.isMarkingAsPaid,type:d.canRequestPayment?"light":"success",size:"xs"},{default:l(()=>t[14]||(t[14]=[e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 7.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"}),e("path",{"fill-rule":"evenodd",d:"M1.5 4.875C1.5 3.839 2.34 3 3.375 3h17.25c1.035 0 1.875.84 1.875 1.875v9.75c0 1.036-.84 1.875-1.875 1.875H3.375A1.875 1.875 0 0 1 1.5 14.625v-9.75ZM8.25 9.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM18.75 9a.75.75 0 0 0-.75.75v.008c0 .414.336.75.75.75h.008a.75.75 0 0 0 .75-.75V9.75a.75.75 0 0 0-.75-.75h-.008ZM4.5 9.75A.75.75 0 0 1 5.25 9h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H5.25a.75.75 0 0 1-.75-.75V9.75Z","clip-rule":"evenodd"}),e("path",{d:"M2.25 18a.75.75 0 0 0 0 1.5c5.4 0 10.63.722 15.6 2.075 1.19.324 2.4-.558 2.4-1.82V18.75a.75.75 0 0 0-.75-.75H2.25Z"})],-1),e("span",null,"Mark As Paid",-1)])),_:1},8,["action","disabled","loading","type"])):f("",!0),d.isEditting&&r.isLoadingOrder?(s(),p(h,{key:2,size:"xs"},{default:l(()=>t[15]||(t[15]=[e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4.5 3.75a3 3 0 0 0-3 3v.75h21v-.75a3 3 0 0 0-3-3h-15Z"}),e("path",{"fill-rule":"evenodd",d:"M22.5 9.75h-21v7.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3v-7.5Zm-18 3.75a.75.75 0 0 1 .75-.75h6a.75.75 0 0 1 0 1.5h-6a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 0-1.5h-3Z","clip-rule":"evenodd"})],-1),e("span",null,"Request Payment",-1)])),_:1})):r.order&&d.canRequestPayment?(s(),p(k,{key:3,action:d.confirmRequestPayment,disabled:r.isMarkingAsPaid,loading:r.isMarkingAsPaid,type:"success",size:"xs"},{default:l(()=>t[16]||(t[16]=[e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4.5 3.75a3 3 0 0 0-3 3v.75h21v-.75a3 3 0 0 0-3-3h-15Z"}),e("path",{"fill-rule":"evenodd",d:"M22.5 9.75h-21v7.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3v-7.5Zm-18 3.75a.75.75 0 0 1 .75-.75h6a.75.75 0 0 1 0 1.5h-6a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 0-1.5h-3Z","clip-rule":"evenodd"})],-1),e("span",null,"Request Payment",-1)])),_:1},8,["action","disabled","loading"])):f("",!0)])]),_:1},8,["order","isLoadingOrder","refreshOrder"])]),e("div",eo,[a($,{order:r.order,isLoadingOrder:r.isLoadingOrder},null,8,["order","isLoadingOrder"]),a(z,{order:r.order,isLoadingOrder:r.isLoadingOrder,refreshOrder:d.getOrder},null,8,["order","isLoadingOrder","refreshOrder"]),e("div",to,[e("div",so,[t[17]||(t[17]=e("p",{class:"font-bold text-lg mb-4"},"Change Status",-1)),r.isLoadingOrder?(s(),n("div",oo,[a(x,{class:"space-y-4"},{default:l(()=>[e("div",ro,[(s(),n(y,null,v(3,(m,P)=>a(g,{key:P})),64))]),a(g,{width:"w-32"})]),_:1})])):d.followUpStatuses.length>0?(s(),n("div",io,[a(ee,{showDot:!1,type:d.statusBadgeType,text:r.order.status.name,class:"border border-gray-500 mr-1"},null,8,["type","text"]),(s(!0),n(y,null,v(d.followUpStatuses,(m,P)=>(s(),p(ee,{type:"info",key:P,showDot:!1,clickable:!0,class:"mr-1",text:m.name,action:()=>d.confirmUpdateStatus(m)},null,8,["text","action"]))),128))])):f("",!0)])])])]),r.order?(s(),n("div",{key:1,class:Z(["space-y-4 shadow-lg rounded-lg border p-4",r.isLoadingOrder?"bg-gray-50":"border-red-300 bg-red-50"])},[e("div",no,[t[18]||(t[18]=e("span",null,"Do you want to permanently delete",-1)),r.isLoadingOrder?(s(),p(x,{key:0},{default:l(()=>[a(g,{width:"w-20 mx-2"})]),_:1})):(s(),n("span",ao," Order #"+c(r.order._attributes.number),1)),t[19]||(t[19]=e("span",null,"? Once this order is deleted you will not be able to recover it.",-1))]),e("div",lo,[d.isEditting&&r.isLoadingOrder?(s(),p(h,{key:0},{default:l(()=>t[20]||(t[20]=[_("Delete Order")])),_:1})):(s(),p(H,{key:1,approveText:"Delete Order",approveAction:d.deleteOrder,isLoading:r.isDeleting},{content:l(()=>[t[23]||(t[23]=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),e("p",co,[t[21]||(t[21]=_("Are you sure you want to permanently delete ")),e("span",uo,"Order #"+c(r.order._attributes.number),1),t[22]||(t[22]=_("?"))])]),trigger:l(m=>[a(k,{action:m.showModal,loading:r.isDeleting,class:"w-40",type:"danger"},{default:l(()=>t[24]||(t[24]=[_(" Delete Order ")])),_:2},1032,["action","loading"])]),_:1},8,["approveAction","isLoading"]))])],2)):f("",!0),r.order&&r.followUpStatus?(s(),p(H,{key:2,declineText:"Cancel",declineType:"light",isLoading:r.isUpdatingOrderStatus,autoHide:!1,approveText:r.followUpStatus.name,approveType:"primary",approveAction:m=>d.updateOrderStatus(r.followUpStatus.name,m)},{content:l(()=>[e("p",mo,[t[25]||(t[25]=_("Mark As ")),e("span",ho,c(r.followUpStatus.name),1)]),e("p",po,c(r.followUpStatus.description),1),e("div",{class:Z({"mb-8 space-y-4":r.followUpStatus.name.toLowerCase()=="completed"||r.followUpStatus.name.toLowerCase()=="cancelled"})},[r.followUpStatus.name.toLowerCase()=="completed"&&!d.isVerified?(s(),n(y,{key:0},[a(T,null,{default:l(()=>[_(c(r.order._attributes.dialToShowCollectionCode.instruction),1)]),_:1}),a(ne,{modelValue:r.collectionCode,"onUpdate:modelValue":t[0]||(t[0]=m=>r.collectionCode=m),errorText:o.getFormError("collectionCode")},null,8,["modelValue","errorText"]),a(ae,{modelValue:r.collectionNote,"onUpdate:modelValue":t[1]||(t[1]=m=>r.collectionNote=m),label:"Note (Optional)",placeholder:"Collected by John Doe",rows:2,errorText:o.getFormError("collectionNote"),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Important note regarding this order collection e.g Collected by John Doe"},null,8,["modelValue","errorText"])],64)):r.followUpStatus.name.toLowerCase()=="cancelled"?(s(),n(y,{key:1},[t[27]||(t[27]=e("div",{class:"border-b border-dashed"},null,-1)),a(E,{width:"w-full",modelValue:r.cancellationReason,"onUpdate:modelValue":t[2]||(t[2]=m=>r.cancellationReason=m),labelPopoverTitle:"What Is This?",label:"Cancellation Reason (Optional)",errorText:o.getFormError("cancellationReason"),labelPopoverDescription:"A reason for why you are cancelling this order. This helps you keep a record for your cancelled orders"},{default:l(()=>[t[26]||(t[26]=e("option",null,null,-1)),(s(!0),n(y,null,v(r.cancellationReasons,(m,P)=>(s(),n("option",{value:m,key:P},c(m),9,fo))),128))]),_:1},8,["modelValue","errorText"])],64)):f("",!0)],2)]),trigger:l(m=>[a(k,{ref:"confirmUpdateOrderStatus",action:m.showModal,class:"hidden"},{default:l(()=>[_(c(r.followUpStatus.name),1)]),_:2},1032,["action"])]),_:1},8,["isLoading","approveText","approveAction"])):f("",!0),r.order?(s(),p(H,{key:3,approveText:"Yes",declineText:"No",autoHide:!1,isLoading:r.isRequestingPayment,approveType:"primary",approveAction:m=>d.requestPayment(m)},{content:l(()=>[e("div",null,[t[29]||(t[29]=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Request Payment",-1)),a(T,{class:"mb-4"},{default:l(()=>t[28]||(t[28]=[_("Request a payment for this order using "),e("span",{class:"font-bold"},"Direct Pay Online",-1),_(" or "),e("span",{class:"font-bold"},"Orange Money",-1)])),_:1}),e("div",go,[a(E,{width:"w-full",label:"Payment Method",labelPopoverTitle:"What Is This?",modelValue:r._requestPayment.paymentMethodId,"onUpdate:modelValue":t[3]||(t[3]=m=>r._requestPayment.paymentMethodId=m),errorText:o.getFormError("paymentMethod"),labelPopoverDescription:"Select the payment method used to pay for this order e.g DPO (Direct Pay Online) or Orange Money"},{default:l(()=>[(s(!0),n(y,null,v(r._requestPayment.paymentMethods,(m,P)=>(s(),n("option",{value:m.id.toString(),key:P},c(m.name),9,yo))),128))]),_:1},8,["modelValue","errorText"]),a(E,{width:"w-full",label:"Amount",modelValue:r._requestPayment.percentage,"onUpdate:modelValue":t[4]||(t[4]=m=>r._requestPayment.percentage=m),labelPopoverTitle:"What Is This?",errorText:o.getFormError("percentage"),labelPopoverDescription:"Select the amonunt that has been paid"},{default:l(()=>[(s(!0),n(y,null,v(r.order._attributes.payableAmounts,(m,P)=>(s(),n("option",{value:m.percentage.toString(),key:P},c(m.name),9,_o))),128))]),_:1},8,["modelValue","errorText"])])])]),trigger:l(m=>[a(k,{ref:"confirmRequestPayment",action:m.showModal,class:"hidden"},{default:l(()=>t[30]||(t[30]=[_(" Request Payment ")])),_:2},1032,["action"])]),_:1},8,["isLoading","approveAction"])):f("",!0),r.order?(s(),p(H,{key:4,approveText:"Yes",declineText:"No",autoHide:!1,isLoading:r.isMarkingAsPaid,approveType:"primary",approveAction:m=>d.markAsUnverifiedPayment(m)},{content:l(()=>[e("div",null,[t[32]||(t[32]=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Mark As Paid",-1)),a(T,{class:"mb-4"},{default:l(()=>t[31]||(t[31]=[_("Mark this order as paid if you received payment from the customer via cash, ewallet, card swipping or any other way")])),_:1}),e("div",wo,[a(E,{width:"w-full",label:"Amount",modelValue:r.markAsPaid.percentage,"onUpdate:modelValue":t[5]||(t[5]=m=>r.markAsPaid.percentage=m),labelPopoverTitle:"What Is This?",errorText:o.getFormError("percentage"),labelPopoverDescription:"Select the amonunt that has been paid"},{default:l(()=>[(s(!0),n(y,null,v(r.order._attributes.payableAmounts,(m,P)=>(s(),n("option",{value:m.percentage.toString(),key:P},c(m.name),9,xo))),128))]),_:1},8,["modelValue","errorText"]),a(E,{width:"w-full",label:"Payment Method",labelPopoverTitle:"What Is This?",modelValue:r.markAsPaid.paymentMethodId,"onUpdate:modelValue":t[6]||(t[6]=m=>r.markAsPaid.paymentMethodId=m),errorText:o.getFormError("paymentMethod"),labelPopoverDescription:"Select the payment method used to pay for this order e.g Cash"},{default:l(()=>[(s(!0),n(y,null,v(r.markAsPaid.paymentMethods,(m,P)=>(s(),n("option",{value:m.id.toString(),key:P},c(m.name),9,ko))),128))]),_:1},8,["modelValue","errorText"])])])]),trigger:l(m=>[a(k,{ref:"confirmMarkAsPaid",action:m.showModal,class:"hidden"},{default:l(()=>t[33]||(t[33]=[_(" Mark As Paid ")])),_:2},1032,["action"])]),_:1},8,["isLoading","approveAction"])):f("",!0)])])}const cr=V(Us,[["render",bo]]);export{cr as default};
