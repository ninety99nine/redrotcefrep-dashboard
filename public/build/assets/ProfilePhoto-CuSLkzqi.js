import{F as m}from"./FormMixin-Dgvngqr1.js";import{a as c,o as r,c as l,b as s,n as a,f as u,d as g,r as p}from"./app-BBiNtTMT.js";import{a as f,p as w}from"./api-repository-CRee0Q10.js";import{I as _}from"./InputErrorMessage-B5IzqFhT.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";async function G(o,e){return await f(o._links.updateUser,e)}async function v(o,e){const t=new FormData;return t.append("profile_photo",e),await w(o._links.updateProfilePhoto,t,{headers:{"Content-Type":"multipart/form-data"}})}const b={props:{user:{type:Object},width:{type:String,default:"w-20"},height:{type:String,default:"h-20"},canUpload:{type:Boolean,default:!0}},mixins:[m],components:{InputErrorMessage:_},data(){return{selectedFile:null,isSubmitting:!1,authState:c(),imageUrl:this.user.profilePhoto,originalImageUrl:this.user.profilePhoto}},watch:{"user.profilePhoto":{handler(o,e){this.imageUrl=o},deep:!1}},methods:{selectImage(){this.canUpload&&this.$refs.fileInput.click()},handleImageChange(o){const e=o.target.files[0];e&&(this.selectedFile=e,this.imageUrl=URL.createObjectURL(e),this.user.id==this.authState.user.id&&(c().user.profilePhoto=this.imageUrl),this.$emit("selectedPhoto",e),this.uploadImage(o,e))},uploadImage(o,e){this.hideFormErrors(),this.isSubmitting=!0,v(this.user,e).then(t=>{t.status==200&&(this.isSubmitting=!1,this.showSuccessfulNotification("Profile photo updated"))}).catch(t=>{this.isSubmitting=!1,this.setServerFormErrors(t),this.user.id==this.authState.user.id&&(c().user.profilePhoto=this.originalImageUrl),o.target.value=null})}}},x=["src"],U={key:0,class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20"},y=s("svg",{class:"w-6 h-6 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})],-1),I=[y],P=["src"],C={key:0,class:"absolute bottom-0 -right-2 w-4 h-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},M=s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"},null,-1),S=s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"},null,-1),j=[M,S],A={key:0,class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20"},V=s("svg",{class:"w-6 h-6 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})],-1),F=[V],Z={key:1,class:a(["absolute top-0 bottom-0 left-0 right-0 z-10 bg-black/75 group-hover:bg-black/50"])},B={class:a(["w-full h-full text-gray-200 dark:text-gray-700"]),xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},E=s("path",{d:"M10 0a10 10 0 1 0 10 10A10.011 10.011 0 0 0 10 0Zm0 5a3 3 0 1 1 0 6 3 3 0 0 1 0-6Zm0 13a8.949 8.949 0 0 1-4.951-1.488A3.987 3.987 0 0 1 9 13h2a3.987 3.987 0 0 1 3.951 3.512A8.949 8.949 0 0 1 10 18Z"},null,-1),z=[E];function N(o,e,t,T,i,n){const d=p("InputErrorMessage");return r(),l("div",null,[s("div",{class:a([t.width,t.height,"relative","mx-auto"])},[i.imageUrl?(r(),l("div",{key:0,onClick:e[0]||(e[0]=(...h)=>n.selectImage&&n.selectImage(...h)),class:a(["w-full h-full",{"cursor-pointer group":t.canUpload}])},[s("div",{src:i.imageUrl,class:a(["w-full h-full rounded-full border-4 overflow-hidden relative"])},[i.isSubmitting?(r(),l("div",U,I)):u("",!0),t.canUpload?(r(),l("div",{key:1,class:a(["absolute top-0 bottom-0 left-0 right-0 z-10 group-hover:bg-black/50",{"bg-black/75":i.isSubmitting}])},null,2)):u("",!0),(r(),l("img",{class:"w-full h-full object-cover object-top",key:i.imageUrl,src:i.imageUrl,alt:"Profile Photo"},null,8,P))],8,x),t.canUpload?(r(),l("svg",C,j)):u("",!0)],2)):(r(),l("div",{key:1,onClick:e[1]||(e[1]=(...h)=>n.selectImage&&n.selectImage(...h)),class:a(["w-full h-full rounded-full border-4 border-transparent overflow-hidden relative",{"cursor-pointer group":t.canUpload}])},[t.canUpload?(r(),l("div",A,F)):u("",!0),t.canUpload?(r(),l("div",Z)):u("",!0),(r(),l("svg",B,z))],2)),s("input",{type:"file",ref:"fileInput",class:"hidden",onChange:e[2]||(e[2]=(...h)=>n.handleImageChange&&n.handleImageChange(...h)),accept:"image/jpeg, image/png, image/jpg, image/gif, image/bmp"},null,544)],2),g(d,{errorText:o.getFormError("profilePhoto"),class:a({"block text-center mt-4":this.getFormError("profilePhoto")})},null,8,["errorText","class"])])}const H=k(b,[["render",N]]);export{H as P,G as u};
