import{R as U,u as I,s as B,j as P,c as l,b as n,d as r,w as p,e as w,f,F as u,g as c,r as s,o as a,h as d,t as N}from"./app-DEkFCb1u.js";import{L as K}from"./Logo-BZxlr7up.js";import{A as L}from"./Alert-DEJps0rh.js";import{F as A}from"./FormMixin-D44Bj-el.js";import{B as M}from"./Button-CTlUNYLQ.js";import{U as H,u as O}from"./form-store-B_ZbhArT.js";import{T as G}from"./TextInput-CwB-G_mS.js";import{T as q}from"./TextHeader-DRGBY_Ui.js";import{B as j}from"./BackButton-DMqpm81M.js";import{P as D}from"./PasswordInput-BrOpAPQI.js";import{O as z,C as W}from"./ConfirmPasswordInput-S0eDFofB.js";import{P as J}from"./PrimaryButton-Cwf__Lsv.js";import{S as Q}from"./SocialLinks-BYV9UTUE.js";import{M as X}from"./MobileNumberInput-DB74IXOZ.js";import{F as Y}from"./FormErrorMessages-T64AgTW8.js";import{v as Z,r as $}from"./auth-repository-yDTpM9Oj.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ShineEffect-CWpUJr6E.js";import"./SpinningLoader-BnJGVf_7.js";import"./InputErrorMessage-lzTzq-uZ.js";import"./MoreInfoPopover-CrxGv8yo.js";/* empty css                                                                      */import"./api-repository-CIJPUswr.js";const te={mixins:[A,H],components:{Logo:K,Alert:L,Button:M,RouterLink:U,TextInput:G,TextHeader:q,BackButton:j,PasswordInput:D,OtpInput:z,PrimaryButton:J,SocialLinks:Q,MobileNumberInput:X,FormErrorMessages:Y,ConfirmPasswordInput:W},data(){return{registerUrl:null,isSubmitting:!1,accountExistsUrl:null,apiState:I(),validateRegisterUrl:null,appName:B.appName,mobileVerificationShortcode:null,notificationState:O(),accountExists:null,showVerificationCode:!1,lastName:"",password:"",firstName:"",mobileNumber:"",verificationCode:"",passwordConfirmation:""}},beforeRouteEnter(o,e,b){b(h=>{o.query.hasOwnProperty("mobileNumber")&&(h.mobileNumber=o.query.mobileNumber,h.handleRegistration())})},methods:{handleRegistration(){this.hideFormErrors(),this.showVerificationCode?this.attemptRegistration():this.accountExists==null?this.checkIfAccountExists():this.validateRegistration()},checkIfAccountExists(){this.mobileNumber.trim()==""?this.setFormError("mobileNumber","Enter your mobile number"):this.accountExistsUrl!=null?(this.isSubmitting=!0,P.post(this.accountExistsUrl,{mobileNumber:this.mobileNumber}).then(o=>{this.isSubmitting=!1,this.accountExists=o.data.exists,this.accountExists&&this.$router.push({name:"login",query:{mobileNumber:this.mobileNumber}})}).catch(o=>{this.isSubmitting=!1,this.setServerFormErrors(o)})):this.setGeneralFormError("The accountExistsUrl does not exist")},validateRegistration(){if(this.firstName.trim()=="")this.setFormError("firstName","Enter your first name");else if(this.lastName.trim()=="")this.setFormError("lastName","Enter your last name");else if(this.mobileNumber.trim()=="")this.setFormError("mobileNumber","Enter your mobile number");else if(this.password.trim()=="")this.setFormError("password","Enter your password");else if(this.passwordConfirmation.trim()=="")this.setFormError("passwordConfirmation","Enter your password confirmation");else if(this.password!=this.passwordConfirmation)this.setFormError("password","Password does not match confirmation");else if(this.validateRegisterUrl!=null){this.isSubmitting=!0;let o={lastName:this.lastName,password:this.password,firstName:this.firstName,mobileNumber:this.mobileNumber,passwordConfirmation:this.passwordConfirmation};Z(o).then(e=>{e.status==200&&(this.isSubmitting=!1,this.showVerificationCode=!0)}).catch(e=>{this.isSubmitting=!1,this.setServerFormErrors(e)})}else this.setGeneralFormError("The validateRegisterUrl does not exist")},attemptRegistration(){if(this.verificationCode.trim()=="")this.setFormError("verificationCode","Enter your verification code");else if(this.registerUrl!=null){this.isSubmitting=!0;let o={lastName:this.lastName,password:this.password,firstName:this.firstName,mobileNumber:this.mobileNumber,verificationCode:this.verificationCode,passwordConfirmation:this.passwordConfirmation};$(o).then(e=>{e.status==200&&(this.isSubmitting=!1,this.$router.replace({name:"show-stores"}),this.showSuccessfulNotification("Welcome to "+this.appName))}).catch(e=>{this.isSubmitting=!1,this.setServerFormErrors(e)})}else this.setGeneralFormError("The registerUrl does not exist")},backToRegistrationForm(){this.showVerificationCode=!1}},created(){this.registerUrl=this.apiState.apiHome._links.register,this.accountExistsUrl=this.apiState.apiHome._links.accountExists,this.validateRegisterUrl=this.apiState.apiHome._links.validateRegister,this.mobileVerificationShortcode=this.apiState.apiHome.mobileVerificationShortcode}},oe={class:"w-full flex flex-col justify-center bg-gradient-to-b from-blue-100 to-white-100 min-h-screen overflow-x-hidden px-6 py-12 lg:px-8"},se={class:"sm:mx-auto sm:w-full sm:max-w-sm"},re={class:"mt-10 sm:mx-auto sm:w-full sm:max-w-sm"},ie={class:"space-y-6",action:"#",method:"POST"},ne={class:"font-bold"},ae={class:"font-bold"},me={class:"grid grid-cols-2 gap-4"},le={class:"md:col-span-1 col-span-2"},ue={class:"md:col-span-1 col-span-2"},de={class:"flex"},ce={class:"text-sm text-center mt-8"};function pe(o,e,b,h,t,m){const x=s("Logo"),E=s("TextHeader"),y=s("FormErrorMessages"),C=s("Alert"),_=s("OtpInput"),S=s("MobileNumberInput"),g=s("TextInput"),F=s("PasswordInput"),V=s("ConfirmPasswordInput"),v=s("BackButton"),k=s("Button"),T=s("SocialLinks"),R=s("router-link");return a(),l("div",oe,[n("div",se,[r(x,{class:"mx-auto"}),r(E,{class:"mt-10 text-center"},{default:p(()=>e[6]||(e[6]=[d("Create your account")])),_:1})]),n("div",re,[n("form",ie,[o.hasGeneralError?(a(),w(y,{key:0})):f("",!0),t.showVerificationCode?(a(),l(u,{key:1},[r(C,null,{default:p(()=>[e[7]||(e[7]=d(" Dial ")),n("span",ne,N(t.mobileVerificationShortcode),1),e[8]||(e[8]=d(" and enter the verification code below to confirm ownership of the mobile number ")),n("span",ae,N(t.mobileNumber),1)]),_:1}),r(_,{modelValue:t.verificationCode,"onUpdate:modelValue":e[0]||(e[0]=i=>t.verificationCode=i),errorText:o.getFormError("verificationCode")},null,8,["modelValue","errorText"])],64)):(a(),l(u,{key:2},[r(S,{modelValue:t.mobileNumber,"onUpdate:modelValue":e[1]||(e[1]=i=>t.mobileNumber=i),errorText:o.getFormError("mobileNumber"),onKeydown:c(m.handleRegistration,["enter"])},null,8,["modelValue","errorText","onKeydown"]),t.accountExists==!1?(a(),l(u,{key:0},[n("div",me,[n("div",le,[r(g,{modelValue:t.firstName,"onUpdate:modelValue":e[2]||(e[2]=i=>t.firstName=i),label:"First Name",autocomplete:"given-name",errorText:o.getFormError("firstName"),onKeydown:c(m.handleRegistration,["enter"])},null,8,["modelValue","errorText","onKeydown"])]),n("div",ue,[r(g,{modelValue:t.lastName,"onUpdate:modelValue":e[3]||(e[3]=i=>t.lastName=i),label:"Last Name",autocomplete:"family-name",errorText:o.getFormError("lastName"),onKeydown:c(m.handleRegistration,["enter"])},null,8,["modelValue","errorText","onKeydown"])])]),t.firstName&&t.lastName?(a(),l(u,{key:0},[r(F,{modelValue:t.password,"onUpdate:modelValue":e[4]||(e[4]=i=>t.password=i),showForgotPassword:!1,errorText:o.getFormError("password"),onKeydown:c(m.handleRegistration,["enter"])},null,8,["modelValue","errorText","onKeydown"]),r(V,{modelValue:t.passwordConfirmation,"onUpdate:modelValue":e[5]||(e[5]=i=>t.passwordConfirmation=i),errorText:o.getFormError("passwordConfirmation"),onKeydown:c(m.handleRegistration,["enter"])},null,8,["modelValue","errorText","onKeydown"])],64)):f("",!0)],64)):f("",!0)],64)),n("div",de,[t.showVerificationCode?(a(),w(v,{key:0,action:m.backToRegistrationForm,class:"w-16 mr-2"},null,8,["action"])):f("",!0),r(k,{size:"sm",class:"w-full",type:"primary",loading:t.isSubmitting,disabled:t.isSubmitting,action:m.handleRegistration},{default:p(()=>[t.showVerificationCode?(a(),l(u,{key:0},[d("Create Account")],64)):(a(),l(u,{key:1},[d("Continue")],64))]),_:1},8,["loading","disabled","action"])])]),r(T,{message:"Or sign up with"}),n("p",ce,[e[10]||(e[10]=n("span",{class:"text-gray-500 mr-1"},"Already have an account?",-1)),r(R,{to:{name:"login"}},{default:p(()=>e[9]||(e[9]=[d("Login")])),_:1})])])])}const Le=ee(te,[["render",pe]]);export{Le as default};
