import{F as N}from"./FormMixin-qdO1rjuz.js";import{U as V,S as E}from"./SpiningLoader-J1-nNIfa.js";import{u as P}from"./store-store-CBrBaDw4.js";import{A as R}from"./AddButton-dYEhg52H.js";import{T as H}from"./TextHeader-JUklgYF2.js";import{C as F}from"./Checkbox-S4HFCLvf.js";import{B as O}from"./BasicTable-C1gT3HLK.js";import{C as U}from"./ConfirmModal-C68Ri80B.js";import{P as z}from"./PrimaryButton-DMrsQBv9.js";import{M as W}from"./MoreInfoPopover-DQ5pfucY.js";import{g as j,d as Y}from"./api-repository-4oAXcOw5.js";import{T as q}from"./ToogleSwitch-BmocHeJV.js";import{B as G}from"./BadgeIndicator-C4cD2V52.js";import{N as J}from"./NoDataPlaceholder-TmF65QX1.js";import{c as a,d as e,e as l,w as h,F as b,h as m,g as u,i as p,r as d,o,l as k,t as c,m as C,n as K}from"./app--JSNtfaf.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./InputErrorMessage-Dr4dBLGL.js";import"./StatusDot-JJuyzbj2.js";const X={mixins:[N,V],components:{AddButton:R,TextHeader:H,BasicTable:O,Checkbox:F,ConfirmModal:U,PrimaryButton:z,SpiningLoader:E,MoreInfoPopover:W,ToogleSwitch:q,BadgeIndicator:G,NoDataPlaceholder:J},data(){return{customers:[],pagination:null,searchTerm:null,checkedRowIds:[],showEverything:!1,deletableCustomer:null,isDeletingCustomerIds:[],isLoadingCustomers:!1,storeState:P()}},computed:{store(){return this.storeState.store},tableHeaders(){return this.showEverything?["","Name","Mobile Number","Email","Birthday","Total Orders","Total Spend","Total Average Spend","Last Order Date","Created Date",""]:["","Name","Mobile Number","Email","Total Orders","Total Spend",""]},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{onView(s){this.$router.push({name:"show-store-customer",params:{store_href:this.store._links.showStore,customer_href:s._links.showCustomer}}).then(()=>{window.scrollTo(0,0)})},onAddCustomer(){this.$router.push({name:"create-store-customer",params:{store_href:this.store._links.showStore}})},showDeleteConfirmationModal(s){this.deletableCustomer=s,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(s){return this.isDeletingCustomerIds.findIndex(n=>n==s.id)!=-1},paginate(s){this.getCustomers(s)},search(s){this.searchTerm=s,this.getCustomers()},getCustomers(s=null){this.isLoadingCustomers=!0;const n={};this.hasSearchTerm&&(n.search=this.searchTerm),s=s??this.store._links.showStoreCustomers,j(s,n).then(_=>{_.status==200&&(this.pagination=_.data,this.customers=this.pagination.data,this.checkedRowIds=this.customers.map(v=>!1)),this.isLoadingCustomers=!1}).catch(_=>{this.isLoadingCustomers=!1,this.setServerFormErrors(_)})},deleteCustomer(){this.isDeletingCustomerIds.push(this.deletableCustomer.id),Y(this.deletableCustomer._links.deleteCustomer).then(s=>{this.isDeletingCustomerIds.splice(this.isDeletingCustomerIds.findIndex(n=>n==this.deletableCustomer.id,1)),s.status==200&&(this.showSuccessfulNotification("Customer deleted"),this.isDeletingCustomerIds.length==0&&this.getCustomers())}).catch(s=>{this.isDeletingCustomerIds.splice(this.isDeletingCustomerIds.findIndex(n=>n==this.deletableCustomer.id,1)),this.setServerFormErrors(s)})}},mounted(){},created(){this.getCustomers()}},Z={class:"flex justify-between items-center border-dashed py-6"},$={class:"flex items-center"},ee=e("span",{class:"mr-2"},"ðŸ˜Š",-1),te=e("span",{class:"ml-2"},"Add Customer",-1),se=["onClick"],oe={class:"whitespace-nowrap align-top px-4 py-4"},re={class:"flex space-x-1 items-center w-40"},ie={class:"align-top px-4 py-4"},ae={class:"flex space-x-1 items-center"},ne={key:1},le={class:"align-top px-4 py-4"},de={class:"flex space-x-1 items-center"},ce={key:1},he={key:0,class:"align-top px-4 py-4"},me={class:"flex space-x-1 items-center w-24"},pe={key:1},ue={class:"align-top px-4 py-4"},_e={class:"whitespace-nowrap px-4 py-4"},ge={key:1,class:"whitespace-nowrap px-4 py-4"},fe={key:2,class:"whitespace-nowrap align-top px-4 py-4"},ye={class:"flex space-x-1 items-center"},Ce={key:3,class:"whitespace-nowrap align-top px-4 py-4"},we={class:"flex space-x-1 items-center"},be={class:"align-top px-4 py-4 flex items-center space-x-4"},xe=["onClick"],ke=e("span",{class:"text-xs ml-2"},"Deleting...",-1),ve=["onClick"],De={key:1,class:"flex justify-between space-x-20 bg-white shadow-lg rounded-lg border p-20"},Te={class:"space-y-4"},Se=e("h1",{class:"text-2xl font-bold"},"Add your first customer",-1),Ie=e("span",{class:"ml-2"},"Add Customer",-1),Ae=e("div",null,[e("span",{class:"text-8xl"},"ðŸŽ‰")],-1),Be=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1),Le={class:"mb-8"},Me={class:"font-bold text-black"};function Ne(s,n,_,v,r,i){const D=d("TextHeader"),f=d("MoreInfoPopover"),T=d("ToogleSwitch"),x=d("AddButton"),S=d("Checkbox"),w=d("NoDataPlaceholder"),I=d("SpiningLoader"),A=d("BasicTable"),B=d("BadgeIndicator"),L=d("PrimaryButton"),M=d("ConfirmModal");return o(),a("div",null,[e("div",Z,[e("div",$,[l(D,null,{default:h(()=>[ee,p(" Customers")]),_:1}),l(f,{class:"ml-2 mt-1",title:"What Is This?",description:"Customers are people who are interested in buying your goods or services",placement:"top"})]),(r.pagination??{}).total>0?(o(),a(b,{key:0},[l(T,{modelValue:r.showEverything,"onUpdate:modelValue":n[0]||(n[0]=t=>r.showEverything=t),size:"md",labelPopoverTitle:"What Is This?",labelPopoverDescription:"Turn on if you want to show more information about your customers"},{default:h(()=>[p(" Show Everything ")]),_:1},8,["modelValue"]),l(x,{action:i.onAddCustomer,class:"w-44"},{default:h(()=>[te]),_:1},8,["action"])],64)):m("",!0)]),r.isLoadingCustomers||(r.pagination??{}).total>0||i.hasSearchTerm?(o(),u(A,{key:0,pagination:r.pagination,isLoading:r.isLoadingCustomers,onPaginate:i.paginate,onSearch:i.search,onRefresh:i.getCustomers,totalHeaders:i.tableHeaders.length},{head:h(()=>[e("tr",null,[(o(!0),a(b,null,k(i.tableHeaders,(t,g)=>(o(),a("th",{key:g,scope:"col",class:"whitespace-nowrap px-4 py-3"},c(t),1))),128))])]),body:h(()=>[(o(!0),a(b,null,k(r.customers,(t,g)=>(o(),a("tr",{onClick:C(y=>i.onView(t),["stop"]),key:t.id,class:K(["group cursor-pointer border-b",r.checkedRowIds[g]?"bg-blue-100":"bg-white hover:bg-gray-50"])},[e("td",{onClick:n[1]||(n[1]=C(()=>{},["stop"])),class:"whitespace-nowrap pl-4"},[l(S,{size:"xs",modelValue:r.checkedRowIds[g],"onUpdate:modelValue":y=>r.checkedRowIds[g]=y},null,8,["modelValue","onUpdate:modelValue"])]),e("td",oe,[e("div",re,[e("span",null,c(t._attributes.name),1),l(f,{class:"opacity-0 group-hover:opacity-100",title:t._attributes.name,description:t.notes,placement:"top"},null,8,["title","description"])])]),e("td",ie,[e("div",ae,[t.mobileNumber==null?(o(),u(w,{key:0})):(o(),a("span",ne,c(t.mobileNumber.national),1))])]),e("td",le,[e("div",de,[t.email==null?(o(),u(w,{key:0})):(o(),a("span",ce,c(t.email),1))])]),r.showEverything?(o(),a("td",he,[e("div",me,[t.birthday==null?(o(),u(w,{key:0})):(o(),a("span",pe,c(s.formattedDate(t.birthday)),1))])])):m("",!0),e("td",ue,[e("span",null,c(t.totalOrders),1)]),e("td",_e,[e("span",null,c(t.totalSpend.amountWithCurrency),1)]),r.showEverything?(o(),a("td",ge,[e("span",null,c(t.totalAverageSpend.amountWithCurrency),1)])):m("",!0),r.showEverything?(o(),a("td",fe,[e("div",ye,[e("span",null,c(s.formattedDatetime(t.lastOrderAt)),1),l(f,{class:"opacity-0 group-hover:opacity-100",title:s.formattedRelativeDate(t.lastOrderAt),placement:"top"},null,8,["title"])])])):m("",!0),r.showEverything?(o(),a("td",Ce,[e("div",we,[e("span",null,c(s.formattedDatetime(t.createdAt)),1),l(f,{class:"opacity-0 group-hover:opacity-100",title:s.formattedRelativeDate(t.createdAt),placement:"top"},null,8,["title"])])])):m("",!0),e("td",be,[i.isDeleting(t)?m("",!0):(o(),a("a",{key:0,href:"#",onClick:C(y=>i.onView(t),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"View",8,xe)),i.isDeleting(t)?(o(),u(I,{key:1,type:"danger"},{default:h(()=>[ke]),_:1})):(o(),a("a",{key:2,href:"#",onClick:C(y=>i.showDeleteConfirmationModal(t),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,ve))])],10,se))),128))]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(o(),a("div",De,[e("div",Te,[Se,e("p",null,[p("Start building your customer base! You can "),l(B,{type:"primary",text:"add customers",showDot:!1,onClick:i.onAddCustomer,class:"cursor-pointer hover:opacity-80"},null,8,["onClick"]),p(" directly or let them find you by marketing your store.")]),l(x,{action:i.onAddCustomer,class:"w-40",size:"sm"},{default:h(()=>[Ie]),_:1},8,["action"])]),Ae])),r.deletableCustomer?(o(),u(M,{key:2,approveText:"Delete Customer",approveAction:i.deleteCustomer,isLoading:i.isDeleting(r.deletableCustomer)},{content:h(()=>[Be,e("p",Le,[p("Are you sure you want to permanently delete "),e("span",Me,c(r.deletableCustomer.name),1),p("?")])]),trigger:h(t=>[l(L,{ref:"confirmDeleteButton",onClick:t.showModal,class:"hidden",type:"danger"},{default:h(()=>[p(" Delete Customer ")]),_:2},1032,["onClick"])]),_:1},8,["approveAction","isLoading"])):m("",!0)])}const Ze=Q(X,[["render",Ne]]);export{Ze as default};
