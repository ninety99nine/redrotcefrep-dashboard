import{F as R}from"./FormMixin-ClKE1ojy.js";import{U as V}from"./UtilsMixin-CBwmyCNB.js";import{u as N}from"./store-store-DF7fWTGb.js";import{T as E}from"./TextHeader-C1e96a4g.js";import{A as H}from"./AddButton-DGxD_nDK.js";import{B as F}from"./BasicTable-CPShvsXm.js";import{C as U}from"./Checkbox-DurIne92.js";import{P as z}from"./ProfilePhoto-hxXBGUEL.js";import{C as j}from"./ConfirmModal-DlEfkiYJ.js";import{P as W}from"./PrimaryButton-XzNrM-C-.js";import{S as J}from"./SpinningLoader-DjKpE0mV.js";import{M as Y}from"./MoreInfoPopover-CsC9waCN.js";import{g as q,d as G}from"./api-repository-DGZ2q84F.js";import{T as K}from"./ToogleSwitch-DF5mWLE8.js";import{B as O}from"./BadgeIndicator-3HslKB2j.js";import{c as a,b as t,d as l,w as m,F as b,f,e as M,r as d,o,h as g,k as _,t as h,m as T,n as Q}from"./app-BcSPA593.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-store-BEfa8Mf9.js";import"./cloneDeep-BSUglKOW.js";import"./SearchInput-BFzG7Po0.js";import"./index-D19FfSVG.js";import"./TextInput-C76qkVLB.js";import"./InputErrorMessage-BQBt7GbC.js";const Z={mixins:[R,V],components:{TextHeader:E,AddButton:H,BasicTable:F,Checkbox:U,ProfilePhoto:z,ConfirmModal:j,PrimaryButton:W,SpinningLoader:J,MoreInfoPopover:Y,ToogleSwitch:K,BadgeIndicator:O},data(){return{teamMembers:[],pagination:null,searchTerm:null,checkedRowIds:[],showEverything:!1,deletableTeamMember:null,isDeletingTeamMemberIds:[],isLoadingTeamMembers:!1,storeState:N()}},computed:{store(){return this.storeState.store},tableHeaders(){return this.showEverything?["","","Name","Mobile","Status","Role","Permissions","Joined Date",""]:["","","Name","Mobile","Status","Role","Total Permissions",""]},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{onView(i){this.$router.push({name:"show-store-team-member",params:{store_href:this.store._links.showStore,team_member_href:i._links.showStoreTeamMember}}).then(()=>{window.scrollTo(0,0)})},showDeleteConfirmationModal(i){this.deletableTeamMember=i,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(i){return this.isDeletingTeamMemberIds.findIndex(e=>e==i.id)!=-1},onInviteTeamMember(){this.$router.push({name:"invite-store-team-member",params:{store_href:this.store._links.showStore}})},paginate(i){this.getTeamMembers(i)},search(i){this.searchTerm=i,this.getTeamMembers()},getTeamMembers(i=null){this.isLoadingTeamMembers=!0;const e={};this.hasSearchTerm&&(e.search=this.searchTerm),i=i??this.store._links.showStoreTeamMembers,q(i,e).then(p=>{p.status==200&&(this.pagination=p.data,this.teamMembers=this.pagination.data,this.checkedRowIds=this.teamMembers.map(k=>!1)),this.isLoadingTeamMembers=!1}).catch(p=>{this.isLoadingTeamMembers=!1,this.setServerFormErrors(p)})},deleteTeamMember(){this.isDeletingTeamMemberIds.push(this.deletableTeamMember.id);var i={mobileNumbers:[(this.deletableTeamMember.mobileNumber||{}).international||this.deletableTeamMember._relationships.userStoreAssociation.mobileNumber.international]};G(this.store._links.removeStoreTeamMembers,i).then(e=>{this.isDeletingTeamMemberIds.splice(this.isDeletingTeamMemberIds.findIndex(p=>p==this.deletableTeamMember.id,1)),e.status==200&&(e.data.deleted?(this.showSuccessfulNotification(e.data.message),this.isDeletingTeamMemberIds.length==0&&this.getTeamMembers()):(this.setFormError("general",e.data.message),this.showUnsuccessfulNotification(e.data.message)))}).catch(e=>{this.isDeletingTeamMemberIds.splice(this.isDeletingTeamMemberIds.findIndex(p=>p==this.deletableTeamMember.id,1)),this.setServerFormErrors(e)})}},mounted(){},created(){this.getTeamMembers()}},$={class:"flex justify-between items-center border-dashed py-6"},ee={class:"flex items-center"},te=["onClick"],se={class:"w-20 align-top"},oe={class:"whitespace-nowrap px-4 py-4 align-top"},ie={class:"px-4 py-4 align-top"},re={class:"whitespace-nowrap px-4 py-4 align-top"},ae={class:"whitespace-nowrap px-4 py-4 align-top"},ne={key:0,class:"px-4 py-4 align-top"},le={class:"space-y-2 list-disc"},me={key:1,class:"whitespace-nowrap px-4 py-4 align-top"},de={class:"flex items-center space-x-2"},pe={class:"whitespace-normal space-y-2 border-t border-dashed pt-2 mt-4"},ce={key:2,class:"whitespace-nowrap px-4 py-4 align-top"},he={class:"flex space-x-1 items-center"},ue={class:"px-4 py-4 space-x-4 align-top"},be=["onClick"],ge=["onClick"],fe={key:1,class:"flex justify-between space-x-20 bg-white shadow-lg rounded-lg border p-20"},_e={class:"space-y-4"},Te={class:"mb-8"},we={class:"font-bold text-black"};function ye(i,e,p,k,r,n){const S=d("TextHeader"),w=d("MoreInfoPopover"),I=d("ToogleSwitch"),v=d("AddButton"),D=d("Checkbox"),C=d("ProfilePhoto"),y=d("BadgeIndicator"),P=d("SpinningLoader"),A=d("BasicTable"),B=d("PrimaryButton"),L=d("ConfirmModal");return o(),a("div",null,[t("div",$,[t("div",ee,[l(S,null,{default:m(()=>e[2]||(e[2]=[t("span",{class:"mr-2"},"ðŸ’ª",-1),g(" Team Members")])),_:1}),l(w,{class:"ml-2 mt-1",title:"What Is This?",description:"Team members are people who help you manage your store and grow your business",placement:"top"})]),(r.pagination??{}).total>0?(o(),a(b,{key:0},[l(I,{modelValue:r.showEverything,"onUpdate:modelValue":e[0]||(e[0]=s=>r.showEverything=s),size:"md",labelPopoverTitle:"What Is This?",labelPopoverDescription:"Turn on if you want to show more information about your team members"},{default:m(()=>e[3]||(e[3]=[g(" Show Everything ")])),_:1},8,["modelValue"]),l(v,{action:n.onInviteTeamMember,class:"w-60"},{default:m(()=>e[4]||(e[4]=[t("span",{class:"ml-2"},"Add Team Member",-1)])),_:1},8,["action"])],64)):f("",!0)]),r.isLoadingTeamMembers||(r.pagination??{}).total>0||n.hasSearchTerm?(o(),M(A,{key:0,pagination:r.pagination,isLoading:r.isLoadingTeamMembers,onPaginate:n.paginate,onSearch:n.search,onRefresh:n.getTeamMembers,totalHeaders:n.tableHeaders.length},{head:m(()=>[t("tr",null,[(o(!0),a(b,null,_(n.tableHeaders,(s,u)=>(o(),a("th",{key:u,scope:"col",class:"whitespace-nowrap px-4 py-3"},h(s),1))),128))])]),body:m(()=>[(o(!0),a(b,null,_(r.teamMembers,(s,u)=>(o(),a("tr",{onClick:T(c=>n.onView(s),["stop"]),key:s.id,class:Q(["group cursor-pointer border-b",r.checkedRowIds[u]?"bg-blue-100":"bg-white hover:bg-gray-50"])},[t("td",{onClick:e[1]||(e[1]=T(()=>{},["stop"])),class:"whitespace-nowrap pl-4 align-top"},[l(D,{size:"xs",class:"mt-2",modelValue:r.checkedRowIds[u],"onUpdate:modelValue":c=>r.checkedRowIds[u]=c},null,8,["modelValue","onUpdate:modelValue"])]),t("td",se,[l(C,{user:s,canUpload:!1,width:"w-10",height:"h-10"},null,8,["user"])]),t("td",oe,[t("span",null,h(s._attributes.name),1)]),t("td",ie,[t("span",null,h((s.mobileNumber||{}).national||s._relationships.userStoreAssociation.mobileNumber.national),1)]),t("td",re,[l(y,{type:s._attributes.userStoreAssociation.teamMemberStatus.toLowerCase()=="invited"?"warning":"info",text:s._attributes.userStoreAssociation.teamMemberStatus,showDot:!1},null,8,["type","text"])]),t("td",ae,[l(y,{type:s._attributes.userStoreAssociation.teamMemberRole.toLowerCase()=="creator"?"success":"info",text:s._attributes.userStoreAssociation.teamMemberRole,showDot:s._attributes.userStoreAssociation.teamMemberRole.toLowerCase()=="creator"},null,8,["type","text","showDot"])]),r.showEverything?(o(),a("td",ne,[t("div",null,[t("ul",le,[(o(!0),a(b,null,_(s._attributes.userStoreAssociation.teamMemberPermissions,(c,x)=>(o(),a("li",{key:x},h(c.name),1))),128))])])])):(o(),a("td",me,[t("div",de,[l(y,{type:"info",text:s._attributes.userStoreAssociation.teamMemberPermissions.length,showDot:!1},null,8,["text"]),l(w,{class:"opacity-0 group-hover:opacity-100",title:"Permissions",placement:"top"},{description:m(()=>[t("div",pe,[(o(!0),a(b,null,_(s._attributes.userStoreAssociation.teamMemberPermissions,(c,x)=>(o(),a("p",{key:x},h(c.name),1))),128))])]),_:2},1024)])])),r.showEverything?(o(),a("td",ce,[t("div",he,[t("span",null,h(i.formattedDatetime(s.createdAt)),1),l(w,{class:"opacity-0 group-hover:opacity-100",title:i.formattedRelativeDate(s.createdAt),placement:"top"},null,8,["title"])])])):f("",!0),t("td",ue,[n.isDeleting(s)?f("",!0):(o(),a("a",{key:0,href:"#",onClick:T(c=>n.onView(s),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"View",8,be)),n.isDeleting(s)?(o(),M(P,{key:1,type:"danger"},{default:m(()=>e[5]||(e[5]=[t("span",{class:"text-xs ml-2"},"Deleting...",-1)])),_:1})):(o(),a("a",{key:2,href:"#",onClick:T(c=>n.showDeleteConfirmationModal(s),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Remove",8,ge))])],10,te))),128))]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(o(),a("div",fe,[t("div",_e,[e[7]||(e[7]=t("h1",{class:"text-2xl font-bold"},"Build Your Team",-1)),e[8]||(e[8]=t("p",null,"Invite others to help manage your store. Collaborate by adding team members to help you grow your business.",-1)),l(v,{action:n.onInviteTeamMember,class:"w-60",size:"sm"},{default:m(()=>e[6]||(e[6]=[t("span",{class:"ml-2"},"Add Team Member",-1)])),_:1},8,["action"])]),e[9]||(e[9]=t("div",null,[t("span",{class:"text-8xl"},"ðŸ’ª")],-1))])),r.deletableTeamMember?(o(),M(L,{key:2,approveText:"Remove Team Member",approveAction:n.deleteTeamMember,isLoading:n.isDeleting(r.deletableTeamMember)},{content:m(()=>[e[12]||(e[12]=t("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),t("p",Te,[e[10]||(e[10]=g("Are you sure you want to remove ")),t("span",we,h(r.deletableTeamMember._attributes.name),1),e[11]||(e[11]=g("?"))])]),trigger:m(s=>[l(B,{ref:"confirmDeleteButton",action:s.showModal,class:"hidden",type:"danger"},{default:m(()=>e[13]||(e[13]=[g(" Remove Team Member ")])),_:2},1032,["action"])]),_:1},8,["approveAction","isLoading"])):f("",!0)])}const Ye=X(Z,[["render",ye]]);export{Ye as default};
