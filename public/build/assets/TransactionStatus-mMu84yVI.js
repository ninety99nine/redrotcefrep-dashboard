import{F as _}from"./FormMixin-Cs0nwSp2.js";import{U as k}from"./UtilsMixin-CBwmyCNB.js";import{B as b}from"./Button-BvW3hBR9.js";import{S as L}from"./SpinningLoader-D5lul-fU.js";import{g as T,p as y}from"./api-repository-DcNefVxR.js";import{M as F}from"./MoreInfoPopover-DKoXncPa.js";import{c as l,b as t,t as i,d,f as c,F as x,n as m,k as S,w as g,e as H,r as h,o as r}from"./app-Clb7lIWV.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-store-Dk2TW4Pk.js";const B={mixins:[_,k],components:{Button:b,SpinningLoader:L,MoreInfoPopover:F},data(){return{status:null,storeHref:null,transaction:null,transactionHref:null,isRenewTransactionPaymentLink:!1,isLoadingTransaction:!1,transactionDescription:null,isGeneratingPaymentLink:!1}},computed:{isPaid(){return this.transaction._attributes.isPaid},isFailedPayment(){return this.transaction._attributes.isFailedPayment},isPendingPayment(){return this.transaction._attributes.isPendingPayment},store(){return this.transaction._relationships.store},pricingPlan(){return this.transaction._relationships.pricingPlan},dpoPaymentUrl(){return this.transaction.metadata.dpoPaymentUrl},dpoPaymentLinkHasExpired(){return this.transaction.metadata.dpoPaymentLinkHasExpired}},methods:{changePricingPlan(n){this.activePricingPlan=n},showTransaction(){this.isLoadingTransaction=!0;let e={_relationships:["owner","store","aiAssistant"].join(",")};T(this.transactionHref,e).then(o=>{o.status==200&&o.data.exists&&(this.transaction=o.data.transaction),this.isLoadingTransaction=!1}).catch(o=>{this.isLoadingTransaction=!1,this.setServerFormErrors(o)})},retryPayment(){this.dpoPaymentLinkHasExpired?window.location.href=this.dpoPaymentUrl:this.renewTransactionPaymentLink()},renewTransactionPaymentLink(){this.isRenewTransactionPaymentLink||(this.isRenewTransactionPaymentLink=!0,y(this.transaction._links.renewTransactionPaymentLink).then(n=>{if(n.status==200&&n.data.successful){const o=n.data.transaction.metadata.dpoPaymentUrl;window.location.href=o}else this.isRenewTransactionPaymentLink=!1}).catch(n=>{this.isRenewTransactionPaymentLink=!1,this.setServerFormErrors(n)}))},navigateToStoreHome(){this.$router.push({name:"show-store-home",params:{store_href:this.store._links.showStore}})},payPricingPlan(){if(this.isGeneratingPaymentLink)return;this.isGeneratingPaymentLink=!0;let n={storeId:this.store.id,paymentMethodType:"dpo"};this.store&&(n.storeId=this.store.id),y(this.pricingPlan._links.payPricingPlan,n).then(e=>{if(e.status==200&&e.data.successful){const u=e.data.transaction.metadata.dpoPaymentUrl;window.location.href=u}else this.isGeneratingPaymentLink=!1}).catch(e=>{this.isGeneratingPaymentLink=!1,this.setServerFormErrors(e)})}},created(){this.status=this.$route.query.status,this.storeHref=this.$route.query.storeHref,this.transactionHref=this.$route.query.transactionHref,this.status=="successful"?this.transactionDescription="Your payment was successful":this.transactionDescription="Your payment failed",this.showTransaction()}},M={class:"min-h-screen relative"},R={class:"z-10 pt-32 px-20 relative"},U={class:"flex flex-col items-center mb-10"},I={class:"w-96 text-sm text-gray-500 text-center"},Z={key:0,class:"flex justify-center"},D={class:"flex justify-center space-x-4 mb-8"},E={class:"flex items-center space-x-2 mb-2"},G={key:0,class:"w-8 h-8 text-green-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},j={key:1,class:"w-8 h-8 text-red-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},z={key:0,class:"text-red-500 p-4 bg-red-50 border border-red-300 rounded-lg mb-4"},A={class:"text-sm font-semibold mb-2"},V={key:0,class:"text-xs"},q={class:"bg-gray-50 border p-4 rounded-lg mb-4"},N={class:"text-gray-500 text-xs"},W={class:"flex items-center space-x-2 text-xs mb-2"},Y={class:"text-gray-400"},J={class:"flex items-center space-x-2 text-xs"},K={class:"text-gray-400"},O={class:"flex justify-center space-x-4"};function Q(n,e,o,u,a,s){const P=h("SpinningLoader"),p=h("MoreInfoPopover"),f=h("Button");return r(),l("div",M,[t("div",R,[t("div",U,[e[0]||(e[0]=t("h1",{class:"flex flex-col items-center space-y-2 text-xl text-gray-700 font-semibold mb-4"},[t("span",{class:"text-4xl"},"ðŸŽ‰"),t("span",null,"Transaction Status")],-1)),t("p",I,i(a.transactionDescription),1)]),a.isLoadingTransaction?(r(),l("div",Z,[d(P)])):c("",!0),a.isLoadingTransaction?c("",!0):(r(),l(x,{key:1},[e[5]||(e[5]=t("div",{class:"flex justify-center mb-8"},[t("img",{src:"/images/store-rooftop.png",class:"w-96"})],-1)),t("div",D,[t("div",{class:m([{"animated-border-green":s.isPaid},{"animated-border-red":s.isFailedPayment},{"animated-border-cyan":s.isPendingPayment},"w-96 bg-white py-4 px-4 shadow-sm rounded-xl"])},[t("div",E,[s.isPaid?(r(),l("svg",G,e[1]||(e[1]=[t("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"},null,-1)]))):c("",!0),s.isFailedPayment?(r(),l("svg",j,e[2]||(e[2]=[t("path",{"fill-rule":"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z","clip-rule":"evenodd"},null,-1)]))):c("",!0),t("h1",{class:m([{"text-green-500":s.isPaid},{"text-red-500":s.isFailedPayment},{"text-yellow-500":s.isPendingPayment},"text-xl font-bold"])},i(n.capitalize(a.transaction.paymentStatus.name)),3)]),t("h2",{class:m([{"text-green-500":s.isPaid},{"text-red-500":s.isFailedPayment},{"text-yellow-500":s.isPendingPayment},"text-sm mb-4"])},i(a.transaction.description),3),t("h2",{class:m([{"text-green-500":s.isPaid},{"text-red-500":s.isFailedPayment},{"text-yellow-500":s.isPendingPayment},"text-3xl text-gray-700 font-bold space-x-1 mb-4"])},[t("span",null,i(a.transaction.amount.amountWithCurrency),1)],2),s.isFailedPayment?(r(),l("div",z,[t("p",A,i(a.transaction.failureType??"Failure Reason"),1),a.transaction.failureReason?(r(),l("p",V,i(a.transaction.failureReason),1)):c("",!0)])):c("",!0),t("div",q,[(r(!0),l(x,null,S(a.transaction._relationships.owner.features,(w,v)=>(r(),l("div",{key:v},[t("span",N,i(w),1)]))),128))]),t("div",W,[t("span",Y,i(n.formattedDatetime(a.transaction.createdAt)),1),d(p,{title:"What Is This?",description:"This is the transaction date",placement:"top"})]),t("div",J,[t("span",K,i(a.transaction.id),1),d(p,{title:"What Is This?",description:"This is the transaction ID",placement:"top"})])],2)]),t("div",O,[d(f,{onClick:s.retryPayment,type:"light",size:"xs"},{default:g(()=>e[3]||(e[3]=[t("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M4.755 10.059a7.5 7.5 0 0 1 12.548-3.364l1.903 1.903h-3.183a.75.75 0 1 0 0 1.5h4.992a.75.75 0 0 0 .75-.75V4.356a.75.75 0 0 0-1.5 0v3.18l-1.9-1.9A9 9 0 0 0 3.306 9.67a.75.75 0 1 0 1.45.388Zm15.408 3.352a.75.75 0 0 0-.919.53 7.5 7.5 0 0 1-12.548 3.364l-1.902-1.903h3.183a.75.75 0 0 0 0-1.5H2.984a.75.75 0 0 0-.75.75v4.992a.75.75 0 0 0 1.5 0v-3.18l1.9 1.9a9 9 0 0 0 15.059-4.035.75.75 0 0 0-.53-.918Z","clip-rule":"evenodd"})],-1),t("span",null,"Retry Payment",-1)])),_:1},8,["onClick"]),s.store?(r(),H(f,{key:0,onClick:s.navigateToStoreHome,type:"primary",size:"xs"},{default:g(()=>[t("span",null,"Go to "+i(s.store.name),1),e[4]||(e[4]=t("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M16.72 7.72a.75.75 0 0 1 1.06 0l3.75 3.75a.75.75 0 0 1 0 1.06l-3.75 3.75a.75.75 0 1 1-1.06-1.06l2.47-2.47H3a.75.75 0 0 1 0-1.5h16.19l-2.47-2.47a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})],-1))]),_:1},8,["onClick"])):c("",!0)])],64))]),e[6]||(e[6]=t("img",{src:"/images/clouds.png",class:"absolute top-32"},null,-1))])}const ot=C(B,[["render",Q]]);export{ot as default};
