import{P as D}from"./Pill-CD_3pjy5.js";import{F as A}from"./FormMixin-D44Bj-el.js";import{u as V,c as i,b as t,e as h,w as g,f as c,F as u,k as P,d,r as l,o as a,n as I,t as v,m as b,h as x}from"./app-DEkFCb1u.js";import{V as B}from"./vue-draggable-next.esm-bundler-C7oHOHQm.js";import{u as M}from"./store-store-CxinBL3L.js";import{S as T}from"./SearchInput-BKDyZ1Nd.js";import{C as N}from"./ConfirmModal-CKYpWGJT.js";import{L as j}from"./LineSkeleton-DFWRI7XC.js";import{P as F}from"./PrimaryButton-Cwf__Lsv.js";import{S as H}from"./SpinningLoader-BnJGVf_7.js";import{g as U,p as E,d as z}from"./api-repository-CIJPUswr.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-store-B_ZbhArT.js";import"./cloneDeep-BGE7Bmb-.js";import"./index-D14zHmA0.js";import"./TextInput-CwB-G_mS.js";import"./InputErrorMessage-lzTzq-uZ.js";import"./MoreInfoPopover-CrxGv8yo.js";import"./Button-CTlUNYLQ.js";import"./ShineEffect-CWpUJr6E.js";/* empty css                                                                      */const O={mixins:[A],components:{Pill:D,draggable:B,SearchInput:T,ConfirmModal:N,SpinningLoader:H,LineSkeleton:j,PrimaryButton:F},props:{form:{type:Object}},data(){return{pages:[],searchTerm:"",deletablePage:null,isDeletingPageIds:[],isLoadingPages:!1,apiState:V(),storeState:M(),isUpdatingPageArrangement:!1}},watch:{searchTerm(r,e){this.showPages()}},computed:{store(){return this.storeState.store},isSearching(){return this.hasSearchTerm&&this.isLoadingPages},hasSearchTerm(){return this.searchTerm.length>0},hasPages(){return this.pages.length>0}},methods:{onViewPage(r){this.$router.push({name:"show-store-page",params:{page_href:r._links.showPage}})},onAddPage(){this.$router.push({name:"create-store-page",params:{store_href:this.store._links.showStore}})},showDeleteConfirmationModal(r){this.deletablePage=r,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(r){return this.isDeletingPageIds.findIndex(e=>e==r.id)!=-1},showPages(){this.isLoadingPages=!0;const r={storeId:this.store.id};this.searchTerm&&(r.search=this.searchTerm),U(this.store._links.showStorePages,r).then(e=>{e.status==200&&(this.pagination=e.data,this.pages=this.pagination.data),this.isLoadingPages=!1}).catch(e=>{this.isLoadingPages=!1,this.setServerFormErrors(e)})},updatePageArrangement(){this.isUpdatingPageArrangement=!0;const r={storeId:this.store.id,pageIds:this.pages.map(e=>e.id)};E(this.apiState.apiHome._links.updatePageArrangement,r).then(e=>{e.status==200&&(e.data.updated?this.showSuccessfulNotification("Page arrangement updated"):(this.setFormError("general",e.data.message),this.showUnsuccessfulNotification(e.data.message))),this.isUpdatingPageArrangement=!1}).catch(e=>{this.isUpdatingPageArrangement=!1,this.setServerFormErrors(e)})},deletePage(r){this.isDeletingPageIds.push(this.deletablePage.id),z(this.deletablePage._links.deletePage).then(e=>{r(),this.isDeletingPageIds.splice(this.isDeletingPageIds.findIndex(m=>m==this.deletePage.id,1)),e.status==200&&(e.data.deleted?(this.showSuccessfulNotification("Page deleted"),this.isDeletingPageIds.length==0&&this.showPages()):(this.setFormError("general",e.data.message),this.showUnsuccessfulNotification(e.data.message)))}).catch(e=>{this.isDeletingPageIds.splice(this.isDeletingPageIds.findIndex(m=>m==this.deletePage.id,1)),this.setServerFormErrors(e)})}},created(){this.showPages()}},q={class:"bg-white shadow-lg border p-6 mt-6 rounded-lg"},G={class:"flex justify-between items-center mb-4"},J={class:"space-y-4"},K={key:1,class:"space-y-2"},Q={class:"w-full flex items-center justify-between"},R=["onClick"],W={class:"w-full flex items-center justify-between"},X={key:0,class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},Y={key:1,class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},$={class:"text-sm font-semibold"},ee={class:"flex items-center space-x-2"},te=["onClick"],se={key:0},ae={class:"flex items-center space-x-8 p-8 border rounded-lg bg-gray-50"},oe={class:"space-y-4"},re={key:0,class:"text-sm font-bold"},ie={key:1,class:"space-y-1"},ne={class:"mb-8"},le={class:"font-bold text-black"};function de(r,e,m,ge,n,o){const k=l("Button"),y=l("SearchInput"),f=l("LineSkeleton"),w=l("Pill"),_=l("SpinningLoader"),S=l("draggable"),L=l("PrimaryButton"),C=l("ConfirmModal");return a(),i("div",q,[t("div",G,[e[4]||(e[4]=t("h1",{class:"flex items-center text-lg font-bold mb-2"},[t("svg",{class:"w-6 h-6 mr-2 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})]),t("span",null,"Pages")],-1)),o.hasSearchTerm||o.hasPages?(a(),h(k,{key:0,type:"primary",size:"sm",icon:"add",skeleton:n.isLoadingPages,action:()=>o.onAddPage(),class:"w-40"},{default:g(()=>e[3]||(e[3]=[t("span",null,"Add Page",-1)])),_:1},8,["skeleton","action"])):c("",!0)]),t("div",J,[o.hasSearchTerm||o.hasPages?(a(),h(y,{key:0,modelValue:n.searchTerm,"onUpdate:modelValue":e[0]||(e[0]=s=>n.searchTerm=s),isSearching:o.isSearching,class:"md:max-w-80"},null,8,["modelValue","isSearching"])):c("",!0),n.isLoadingPages?(a(),i("div",K,[(a(),i(u,null,P([1,2,3],(s,p)=>t("div",{key:p,class:"border shadow-sm rounded-lg p-4 bg-gray-50"},[t("div",Q,[d(f,{width:"w-32"}),d(f,{width:"w-16"})])])),64))])):(a(),i(u,{key:2},[d(S,{modelValue:n.pages,"onUpdate:modelValue":e[2]||(e[2]=s=>n.pages=s),class:"space-y-2",handle:".draggable-handle","ghost-class":"bg-yellow-50",onChange:o.updatePageArrangement},{default:g(()=>[(a(!0),i(u,null,P(n.pages,(s,p)=>(a(),i("div",{key:p,onClick:()=>o.onViewPage(s),class:"flex items-center justify-between space-x-4 border shadow-sm rounded-lg p-4 bg-gray-50 cursor-pointer hover:border-blue-200 hover:bg-blue-50 group"},[t("div",W,[t("div",{class:I(["flex items-center space-x-2",{"text-blue-500":s.homepage}])},[s.homepage?(a(),i("svg",X,e[5]||(e[5]=[t("path",{d:"M11.47 3.841a.75.75 0 0 1 1.06 0l8.69 8.69a.75.75 0 1 0 1.06-1.061l-8.689-8.69a2.25 2.25 0 0 0-3.182 0l-8.69 8.69a.75.75 0 1 0 1.061 1.06l8.69-8.689Z"},null,-1),t("path",{d:"m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 0 1-.75-.75v-4.5a.75.75 0 0 0-.75-.75h-3a.75.75 0 0 0-.75.75V21a.75.75 0 0 1-.75.75H5.625a1.875 1.875 0 0 1-1.875-1.875v-6.198a2.29 2.29 0 0 0 .091-.086L12 5.432Z"},null,-1)]))):(a(),i("svg",Y,e[6]||(e[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"},null,-1)]))),t("h1",$,v(s.title),1)],2),t("div",ee,[d(w,{type:s.visible?"success":"warning",text:s.visible?"visible":"hidden",showDot:!1},null,8,["type","text"])])]),o.isDeleting(s)?(a(),h(_,{key:0,type:"danger"},{default:g(()=>e[7]||(e[7]=[t("span",{class:"text-xs ml-2"},"Deleting...",-1)])),_:1})):(a(),i("svg",{key:1,onClick:b(me=>o.showDeleteConfirmationModal(s),["stop","prevent"]),class:"w-4 h-4 cursor-pointer hover:text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},e[8]||(e[8]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"},null,-1)]),8,te)),(a(),i("svg",{onClick:e[1]||(e[1]=b(()=>{},["stop"])),class:"draggable-handle w-4 h-4 cursor-grab hover:text-yellow-500 visible:cursor-grabbing",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},e[9]||(e[9]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"},null,-1)])))],8,R))),128))]),_:1},8,["modelValue","onChange"]),o.hasPages?c("",!0):(a(),i("div",se,[t("div",ae,[e[11]||(e[11]=t("span",{class:"text-9xl"},"ðŸŽ¨",-1)),t("div",oe,[o.hasSearchTerm?(a(),i("p",re,"No pages found.")):(a(),i("div",ie,e[10]||(e[10]=[t("p",{class:"text-2xl font-bold"},"Pages help build your shop",-1),t("p",{class:"text-sm"},"Home, about us, terms and conditions and more are created using pages",-1)]))),d(w,{type:"primary",text:"+ Add Page",size:"px-8 py-2",showDot:!1,clickable:!0,action:()=>o.onAddPage()},null,8,["action"])])])]))],64)),n.deletablePage?(a(),h(C,{key:3,approveText:"Delete",approveAction:s=>o.deletePage(s),isLoading:o.isDeleting(o.deletePage)},{content:g(()=>[e[14]||(e[14]=t("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),t("p",ne,[e[12]||(e[12]=x("Are you sure you want to delete ")),t("span",le,v(n.deletablePage.name),1),e[13]||(e[13]=x("?"))])]),trigger:g(s=>[d(L,{ref:"confirmDeleteButton",action:s.showModal,class:"hidden",type:"danger"},null,8,["action"])]),_:1},8,["approveAction","isLoading"])):c("",!0)])])}const Me=Z(O,[["render",de]]);export{Me as default};
