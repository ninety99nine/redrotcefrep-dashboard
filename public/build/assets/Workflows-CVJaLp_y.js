import{P as b}from"./Pill-CD_3pjy5.js";import{F as _}from"./FormMixin-D44Bj-el.js";import{B as y}from"./Button-CTlUNYLQ.js";import{u as x,c as d,b as t,e as f,f as c,F as I,k as v,w as m,r as s,o as l,d as h,h as k,t as D}from"./app-DEkFCb1u.js";import{V as L}from"./vue-draggable-next.esm-bundler-C7oHOHQm.js";import{u as A}from"./store-store-CxinBL3L.js";import{S as B}from"./SearchInput-BKDyZ1Nd.js";import{C as T}from"./ConfirmModal-CKYpWGJT.js";import{u as V}from"./workflow-store-D5s1F-Ms.js";import{L as C}from"./LineSkeleton-DFWRI7XC.js";import{P as F}from"./PrimaryButton-Cwf__Lsv.js";import{S as M}from"./SpinningLoader-BnJGVf_7.js";import{g as N,p as P,d as E}from"./api-repository-CIJPUswr.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-store-B_ZbhArT.js";import"./ShineEffect-CWpUJr6E.js";import"./cloneDeep-BGE7Bmb-.js";import"./index-D14zHmA0.js";import"./TextInput-CwB-G_mS.js";import"./InputErrorMessage-lzTzq-uZ.js";import"./MoreInfoPopover-CrxGv8yo.js";/* empty css                                                                      */const j={mixins:[_],components:{Pill:b,Button:y,draggable:L,SearchInput:B,ConfirmModal:T,SpinningLoader:M,LineSkeleton:C,PrimaryButton:F},props:{form:{type:Object}},data(){return{workflows:[],searchTerm:"",apiState:x(),deletableWorkflow:null,isDeletingWorkflowIds:[],isLoadingWorkflows:!1,storeState:A(),workflowState:V()}},watch:{searchTerm(o,e){this.showWorkflows()}},computed:{store(){return this.storeState.store},isSearching(){return this.hasSearchTerm&&this.isLoadingWorkflows},hasSearchTerm(){return this.searchTerm.length>0},hasWorkflows(){return this.workflows.length>0}},methods:{onViewWorkflow(o){this.$router.push({name:"show-store-workflow",params:{workflow_href:o._links.showWorkflow}}).then(()=>{window.scrollTo(0,0)})},onAddWorkflow(){this.$router.push({name:"create-store-workflow",params:{store_href:this.store._links.showStore}})},showDeleteConfirmationModal(o){this.deletableWorkflow=o,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(o){return this.isDeletingWorkflowIds.findIndex(e=>e==o.id)!=-1},showWorkflows(){this.isLoadingWorkflows=!0;const o={storeId:this.store.id};this.searchTerm&&(o.search=this.searchTerm),N(this.store._links.showStoreWorkflows,o).then(e=>{e.status==200&&(this.pagination=e.data,this.workflows=this.pagination.data),this.isLoadingWorkflows=!1}).catch(e=>{this.isLoadingWorkflows=!1,this.setServerFormErrors(e)})},updateWorkflowArrangement(){this.workflowState.setIsUpdatingWorkflowArrangement(!0);const o={storeId:this.store.id,workflowIds:this.workflows.map(e=>e.id)};P(this.apiState.apiHome._links.updateWorkflowArrangement,o).then(e=>{e.status==200&&(e.data.updated?this.showSuccessfulNotification("Workflow arrangement updated"):(this.setFormError("general",e.data.message),this.showUnsuccessfulNotification(e.data.message))),this.workflowState.setIsUpdatingWorkflowArrangement(!1)}).catch(e=>{this.workflowState.setIsUpdatingWorkflowArrangement(!1),this.setServerFormErrors(e)})},deleteWorkflow(o){this.isDeletingWorkflowIds.push(this.deletableWorkflow.id),E(this.deletableWorkflow._links.deleteWorkflow).then(e=>{o(),this.isDeletingWorkflowIds.splice(this.isDeletingWorkflowIds.findIndex(n=>n==this.deleteWorkflow.id,1)),e.status==200&&(e.data.deleted?(this.showSuccessfulNotification("Workflow deleted"),this.isDeletingWorkflowIds.length==0&&this.showWorkflows()):(this.setFormError("general",e.data.message),this.showUnsuccessfulNotification(e.data.message)))}).catch(e=>{this.isDeletingWorkflowIds.splice(this.isDeletingWorkflowIds.findIndex(n=>n==this.deleteWorkflow.id,1)),this.setServerFormErrors(e)})}},created(){this.showWorkflows()}},z={class:"bg-white shadow-lg border p-8 rounded-lg"},H={class:"space-y-4"},O={key:1,class:"space-y-2"},q={class:"w-full flex items-center justify-between"},G={class:"mb-8"},J={class:"font-bold text-black"};function K(o,e,n,Q,i,r){const p=s("SearchInput"),w=s("LineSkeleton");s("Pill"),s("SpinningLoader"),s("draggable");const u=s("Button"),g=s("PrimaryButton"),W=s("ConfirmModal");return l(),d("div",z,[e[14]||(e[14]=t("h1",{class:"flex items-center text-lg font-bold mb-2"},[t("svg",{class:"w-6 h-6 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3"})]),t("span",null,"Workflows")],-1)),e[15]||(e[15]=t("p",{class:"text-sm text-gray-500 mb-4"}," Automate repetitive tasks in your store to save time and focus on growing your business. Let the platform handle things like order processing, inventory updates, and customer notifications for you. ",-1)),t("div",H,[r.hasSearchTerm||r.hasWorkflows?(l(),f(p,{key:0,modelValue:i.searchTerm,"onUpdate:modelValue":e[0]||(e[0]=a=>i.searchTerm=a),isSearching:r.isSearching},null,8,["modelValue","isSearching"])):c("",!0),i.isLoadingWorkflows?(l(),d("div",O,[(l(),d(I,null,v([1,2,3],(a,S)=>t("div",{key:S,class:"border shadow-sm rounded-lg p-4 bg-gray-50"},[t("div",q,[h(w,{width:"w-32",shine:!0}),h(w,{width:"w-16",shine:!0})])])),64))])):(l(),f(u,{key:3,type:"light",size:"sm",skeleton:i.isLoadingWorkflows,action:()=>r.onAddWorkflow()},{default:m(()=>e[10]||(e[10]=[t("span",{class:"ml-2"},"Add Workflow",-1)])),_:1},8,["skeleton","action"])),i.deletableWorkflow?(l(),f(W,{key:4,approveText:"Delete",approveAction:a=>r.deleteWorkflow(a),isLoading:r.isDeleting(r.deleteWorkflow)},{content:m(()=>[e[13]||(e[13]=t("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),t("p",G,[e[11]||(e[11]=k("Are you sure you want to delete ")),t("span",J,D(i.deletableWorkflow.name),1),e[12]||(e[12]=k("?"))])]),trigger:m(a=>[h(g,{ref:"confirmDeleteButton",action:a.showModal,class:"hidden",type:"danger"},null,8,["action"])]),_:1},8,["approveAction","isLoading"])):c("",!0)])])}const ue=U(j,[["render",K]]);export{ue as default};
