import{F as R}from"./FormMixin-CYiBG1ca.js";import{U as V,S as N}from"./SpiningLoader-CsPmXxst.js";import{u as E}from"./store-store-C2_eLuQh.js";import{T as H}from"./TextHeader-Cdgnrugi.js";import{A as F}from"./AddButton-YPx_iiuG.js";import{B as U}from"./BasicTable-BSovyWYs.js";import{C as z}from"./Checkbox-C6zZavZf.js";import{P as j}from"./ProfilePhoto-DoqfiMPl.js";import{C as W}from"./ConfirmModal-DrJlS0Sa.js";import{P as q}from"./PrimaryButton-DULDYb5e.js";import{M as J}from"./MoreInfoPopover-gLIaCQca.js";import{g as Y,d as G}from"./api-repository-C4cDgx_E.js";import{T as K}from"./ToogleSwitch-CDDQu6G0.js";import{B as O}from"./BadgeIndicator-BRfv_GU4.js";import{c as r,d as e,e as l,w as m,F as b,g,f as M,r as c,o as s,i as _,l as f,t as p,p as T,q as Q}from"./app-Kf0mCOXy.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SearchInput-Csxtp266.js";import"./TextInput-_gM6fl6u.js";import"./InputLabel-B11U1-WT.js";import"./InputErrorMessage-B1NpEu7u.js";import"./StatusDot-B0b3cfnt.js";const Z={mixins:[R,V],components:{TextHeader:H,AddButton:F,BasicTable:U,Checkbox:z,ProfilePhoto:j,ConfirmModal:W,PrimaryButton:q,SpiningLoader:N,MoreInfoPopover:J,ToogleSwitch:K,BadgeIndicator:O},data(){return{teamMembers:[],pagination:null,searchTerm:null,checkedRowIds:[],showEverything:!1,deletableTeamMember:null,isDeletingTeamMemberIds:[],isLoadingTeamMembers:!1,storeState:E()}},computed:{store(){return this.storeState.store},tableHeaders(){return this.showEverything?["","","Name","Mobile","Status","Role","Permissions","Joined Date",""]:["","","Name","Mobile","Status","Role","Total Permissions",""]},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{onView(o){this.$router.push({name:"show-store-team-member",params:{store_href:this.store._links.showStore,team_member_href:o._links.showStoreTeamMember}}).then(()=>{window.scrollTo(0,0)})},showDeleteConfirmationModal(o){this.deletableTeamMember=o,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(o){return this.isDeletingTeamMemberIds.findIndex(a=>a==o.id)!=-1},onInviteTeamMember(){this.$router.push({name:"invite-store-team-member",params:{store_href:this.store._links.showStore}})},paginate(o){this.getTeamMembers(o)},search(o){this.searchTerm=o,this.getTeamMembers()},getTeamMembers(o=null){this.isLoadingTeamMembers=!0;const a={};this.hasSearchTerm&&(a.search=this.searchTerm),o=o??this.store._links.showStoreTeamMembers,Y(o,a).then(d=>{d.status==200&&(this.pagination=d.data,this.teamMembers=this.pagination.data,this.checkedRowIds=this.teamMembers.map(k=>!1)),this.isLoadingTeamMembers=!1}).catch(d=>{this.isLoadingTeamMembers=!1,this.setServerFormErrors(d)})},deleteTeamMember(){this.isDeletingTeamMemberIds.push(this.deletableTeamMember.id);var o={mobileNumbers:[(this.deletableTeamMember.mobileNumber||{}).international||this.deletableTeamMember._relationships.userStoreAssociation.mobileNumber.international]};G(this.store._links.removeStoreTeamMembers,o).then(a=>{this.isDeletingTeamMemberIds.splice(this.isDeletingTeamMemberIds.findIndex(d=>d==this.deletableTeamMember.id,1)),a.status==200&&(a.data.deleted?(this.showSuccessfulNotification(a.data.message),this.isDeletingTeamMemberIds.length==0&&this.getTeamMembers()):(this.setFormError("general",a.data.message),this.showUnsuccessfulNotification(a.data.message)))}).catch(a=>{this.isDeletingTeamMemberIds.splice(this.isDeletingTeamMemberIds.findIndex(d=>d==this.deletableTeamMember.id,1)),this.setServerFormErrors(a)})}},mounted(){},created(){this.getTeamMembers()}},$={class:"flex justify-between items-center border-dashed py-6"},ee={class:"flex items-center"},te=e("span",{class:"mr-2"},"ðŸ’ª",-1),se=e("span",{class:"ml-2"},"Add Team Member",-1),oe=["onClick"],ae={class:"w-20 align-top"},ie={class:"whitespace-nowrap px-4 py-4 align-top"},re={class:"px-4 py-4 align-top"},ne={class:"whitespace-nowrap px-4 py-4 align-top"},le={class:"whitespace-nowrap px-4 py-4 align-top"},me={key:0,class:"px-4 py-4 align-top"},ce={class:"space-y-2 list-disc"},de={key:1,class:"whitespace-nowrap px-4 py-4 align-top"},he={class:"flex items-center space-x-2"},pe={class:"whitespace-normal space-y-2 border-t border-dashed pt-2 mt-4"},ue={key:2,class:"whitespace-nowrap px-4 py-4 align-top"},be={class:"flex space-x-1 items-center"},_e={class:"px-4 py-4 space-x-4 align-top"},ge=["onClick"],fe=e("span",{class:"text-xs ml-2"},"Deleting...",-1),Te=["onClick"],we={key:1,class:"flex justify-between space-x-20 bg-white shadow-lg rounded-lg border p-20"},ye={class:"space-y-4"},xe=e("h1",{class:"text-2xl font-bold"},"Build Your Team",-1),Me=e("p",null,"Invite others to help manage your store. Collaborate by adding team members to help you grow your business.",-1),ve=e("span",{class:"ml-2"},"Add Team Member",-1),ke=e("div",null,[e("span",{class:"text-8xl"},"ðŸ’ª")],-1),Se=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1),Ce={class:"mb-8"},Ie={class:"font-bold text-black"};function De(o,a,d,k,i,n){const S=c("TextHeader"),w=c("MoreInfoPopover"),C=c("ToogleSwitch"),v=c("AddButton"),I=c("Checkbox"),D=c("ProfilePhoto"),y=c("BadgeIndicator"),P=c("SpiningLoader"),A=c("BasicTable"),B=c("PrimaryButton"),L=c("ConfirmModal");return s(),r("div",null,[e("div",$,[e("div",ee,[l(S,null,{default:m(()=>[te,_(" Team Members")]),_:1}),l(w,{class:"ml-2 mt-1",title:"What Is This?",description:"Team members are people who help you manage your store and grow your business",placement:"top"})]),(i.pagination??{}).total>0?(s(),r(b,{key:0},[l(C,{modelValue:i.showEverything,"onUpdate:modelValue":a[0]||(a[0]=t=>i.showEverything=t),size:"md",labelPopoverTitle:"What Is This?",labelPopoverDescription:"Turn on if you want to show more information about your team members"},{default:m(()=>[_(" Show Everything ")]),_:1},8,["modelValue"]),l(v,{action:n.onInviteTeamMember,class:"w-60"},{default:m(()=>[se]),_:1},8,["action"])],64)):g("",!0)]),i.isLoadingTeamMembers||(i.pagination??{}).total>0||n.hasSearchTerm?(s(),M(A,{key:0,pagination:i.pagination,isLoading:i.isLoadingTeamMembers,onPaginate:n.paginate,onSearch:n.search,onRefresh:n.getTeamMembers,totalHeaders:n.tableHeaders.length},{head:m(()=>[e("tr",null,[(s(!0),r(b,null,f(n.tableHeaders,(t,u)=>(s(),r("th",{key:u,scope:"col",class:"whitespace-nowrap px-4 py-3"},p(t),1))),128))])]),body:m(()=>[(s(!0),r(b,null,f(i.teamMembers,(t,u)=>(s(),r("tr",{onClick:T(h=>n.onView(t),["stop"]),key:t.id,class:Q(["group cursor-pointer border-b",i.checkedRowIds[u]?"bg-blue-100":"bg-white hover:bg-gray-50"])},[e("td",{onClick:a[1]||(a[1]=T(()=>{},["stop"])),class:"whitespace-nowrap pl-4 align-top"},[l(I,{size:"xs",class:"mt-2",modelValue:i.checkedRowIds[u],"onUpdate:modelValue":h=>i.checkedRowIds[u]=h},null,8,["modelValue","onUpdate:modelValue"])]),e("td",ae,[l(D,{user:t,canUpload:!1,width:"w-10",height:"h-10"},null,8,["user"])]),e("td",ie,[e("span",null,p(t._attributes.name),1)]),e("td",re,[e("span",null,p((t.mobileNumber||{}).national||t._relationships.userStoreAssociation.mobileNumber.national),1)]),e("td",ne,[l(y,{type:t._attributes.userStoreAssociation.teamMemberStatus.toLowerCase()=="invited"?"warning":"info",text:t._attributes.userStoreAssociation.teamMemberStatus,showDot:!1},null,8,["type","text"])]),e("td",le,[l(y,{type:t._attributes.userStoreAssociation.teamMemberRole.toLowerCase()=="creator"?"success":"info",text:t._attributes.userStoreAssociation.teamMemberRole,showDot:t._attributes.userStoreAssociation.teamMemberRole.toLowerCase()=="creator"},null,8,["type","text","showDot"])]),i.showEverything?(s(),r("td",me,[e("div",null,[e("ul",ce,[(s(!0),r(b,null,f(t._attributes.userStoreAssociation.teamMemberPermissions,(h,x)=>(s(),r("li",{key:x},p(h.name),1))),128))])])])):(s(),r("td",de,[e("div",he,[l(y,{type:"info",text:t._attributes.userStoreAssociation.teamMemberPermissions.length,showDot:!1},null,8,["text"]),l(w,{class:"opacity-0 group-hover:opacity-100",title:"Permissions",placement:"top"},{description:m(()=>[e("div",pe,[(s(!0),r(b,null,f(t._attributes.userStoreAssociation.teamMemberPermissions,(h,x)=>(s(),r("p",{key:x},p(h.name),1))),128))])]),_:2},1024)])])),i.showEverything?(s(),r("td",ue,[e("div",be,[e("span",null,p(o.formattedDatetime(t.createdAt)),1),l(w,{class:"opacity-0 group-hover:opacity-100",title:o.formattedRelativeDate(t.createdAt),placement:"top"},null,8,["title"])])])):g("",!0),e("td",_e,[n.isDeleting(t)?g("",!0):(s(),r("a",{key:0,href:"#",onClick:T(h=>n.onView(t),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"View",8,ge)),n.isDeleting(t)?(s(),M(P,{key:1,type:"danger"},{default:m(()=>[fe]),_:1})):(s(),r("a",{key:2,href:"#",onClick:T(h=>n.showDeleteConfirmationModal(t),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Remove",8,Te))])],10,oe))),128))]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(s(),r("div",we,[e("div",ye,[xe,Me,l(v,{action:n.onInviteTeamMember,class:"w-60",size:"sm"},{default:m(()=>[ve]),_:1},8,["action"])]),ke])),i.deletableTeamMember?(s(),M(L,{key:2,approveText:"Remove Team Member",approveAction:n.deleteTeamMember,isLoading:n.isDeleting(i.deletableTeamMember)},{content:m(()=>[Se,e("p",Ce,[_("Are you sure you want to remove "),e("span",Ie,p(i.deletableTeamMember._attributes.name),1),_("?")])]),trigger:m(t=>[l(B,{ref:"confirmDeleteButton",onClick:t.showModal,class:"hidden",type:"danger"},{default:m(()=>[_(" Remove Team Member ")]),_:2},1032,["onClick"])]),_:1},8,["approveAction","isLoading"])):g("",!0)])}const Xe=X(Z,[["render",De]]);export{Xe as default};
