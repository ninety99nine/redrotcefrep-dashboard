import{F as B}from"./FormMixin-CULzALzX.js";import{u as D,c as i,b as t,e as m,f as w,F as p,k as W,d,w as c,h,r as n,o as s,t as x,m as b}from"./app-BoGXsv54.js";import{V as M}from"./vue-draggable-next.esm-bundler-BIOBP9p-.js";import{u as V}from"./store-store-D6KBR7nZ.js";import{A as T}from"./AddButton-CsMQc9aT.js";import{S as N}from"./SearchInput-oKDF-Tqv.js";import{C as j}from"./ConfirmModal-BGWNF6pf.js";import{u as E}from"./workflow-store-ClAUxGzf.js";import{S as F}from"./ShineEffect-D65G_ZGD.js";import{S as U}from"./SpinningLoader-BEnaF0ac.js";import{L as z}from"./LineSkeleton-Ccwgk_3w.js";import{P}from"./PrimaryButton-H3KL-bqb.js";import{B as X}from"./ButtonSkeleton-DLZzv2KY.js";import{B as H}from"./BadgeIndicator-DlVYZEkg.js";import{g as O,p as q,d as G}from"./api-repository-bdlVH5Lr.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-store-CuTEKvPg.js";import"./UtilsMixin-CBwmyCNB.js";import"./cloneDeep-BSUglKOW.js";import"./index-D19FfSVG.js";import"./TextInput-CYwxZsJZ.js";import"./InputErrorMessage-BzaNbvNM.js";import"./MoreInfoPopover-DUIgEZ-J.js";import"./Button-DeRn3xZE.js";const K={mixins:[B],components:{draggable:M,AddButton:T,SearchInput:N,ConfirmModal:j,ShineEffect:F,SpinningLoader:U,LineSkeleton:z,PrimaryButton:P,ButtonSkeleton:X,BadgeIndicator:H},props:{form:{type:Object}},data(){return{workflows:[],searchTerm:"",apiState:D(),deletableWorkflow:null,isDeletingWorkflowIds:[],isLoadingWorkflows:!1,storeState:V(),workflowState:E()}},watch:{searchTerm(r,e){this.showWorkflows()}},computed:{store(){return this.storeState.store},isSearching(){return this.hasSearchTerm&&this.isLoadingWorkflows},hasSearchTerm(){return this.searchTerm.length>0},hasWorkflows(){return this.workflows.length>0}},methods:{onViewWorkflow(r){this.$router.push({name:"show-store-workflow",params:{workflow_href:r._links.showWorkflow}}).then(()=>{window.scrollTo(0,0)})},onAddWorkflow(){this.$router.push({name:"create-store-workflow",params:{store_href:this.store._links.showStore}})},showDeleteConfirmationModal(r){this.deletableWorkflow=r,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(r){return this.isDeletingWorkflowIds.findIndex(e=>e==r.id)!=-1},showWorkflows(){this.isLoadingWorkflows=!0;const r={storeId:this.store.id};this.searchTerm&&(r.search=this.searchTerm),O(this.store._links.showStoreWorkflows,r).then(e=>{e.status==200&&(this.pagination=e.data,this.workflows=this.pagination.data),this.isLoadingWorkflows=!1}).catch(e=>{this.isLoadingWorkflows=!1,this.setServerFormErrors(e)})},updateWorkflowArrangement(){this.workflowState.setIsUpdatingWorkflowArrangement(!0);const r={storeId:this.store.id,workflowIds:this.workflows.map(e=>e.id)};q(this.apiState.apiHome._links.updateWorkflowArrangement,r).then(e=>{e.status==200&&(e.data.updated?this.showSuccessfulNotification("Workflow arrangement updated"):(this.setFormError("general",e.data.message),this.showUnsuccessfulNotification(e.data.message))),this.workflowState.setIsUpdatingWorkflowArrangement(!1)}).catch(e=>{this.workflowState.setIsUpdatingWorkflowArrangement(!1),this.setServerFormErrors(e)})},deleteWorkflow(r){this.isDeletingWorkflowIds.push(this.deletableWorkflow.id),G(this.deletableWorkflow._links.deleteWorkflow).then(e=>{r(),this.isDeletingWorkflowIds.splice(this.isDeletingWorkflowIds.findIndex(f=>f==this.deleteWorkflow.id,1)),e.status==200&&(e.data.deleted?(this.showSuccessfulNotification("Workflow deleted"),this.isDeletingWorkflowIds.length==0&&this.showWorkflows()):(this.setFormError("general",e.data.message),this.showUnsuccessfulNotification(e.data.message)))}).catch(e=>{this.isDeletingWorkflowIds.splice(this.isDeletingWorkflowIds.findIndex(f=>f==this.deleteWorkflow.id,1)),this.setServerFormErrors(e)})}},created(){this.showWorkflows()}},Q={class:"bg-white shadow-lg border p-8 rounded-lg"},R={class:"space-y-4"},Y={key:1,class:"space-y-2"},Z=["onClick"],$={class:"w-full flex items-center justify-between"},ee={class:"flex items-center space-x-2"},te={class:"text-sm font-semibold"},oe={class:"flex items-center space-x-2"},se=["onClick"],re={key:0},le={class:"flex justify-between items-center space-x-8 px-16 py-4 border rounded-lg bg-gray-50"},ie={class:"space-y-2"},ne={key:0,class:"font-bold"},ae={class:"mb-8"},de={class:"font-bold text-black"};function ce(r,e,f,me,a,l){const y=n("SearchInput"),k=n("LineSkeleton"),g=n("ShineEffect"),v=n("BadgeIndicator"),_=n("SpinningLoader"),S=n("draggable"),L=n("ButtonSkeleton"),C=n("AddButton"),I=n("PrimaryButton"),A=n("ConfirmModal");return s(),i("div",Q,[e[15]||(e[15]=t("h1",{class:"flex items-center text-lg font-bold mb-2"},[t("svg",{class:"w-6 h-6 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3"})]),t("span",null,"Workflows")],-1)),e[16]||(e[16]=t("p",{class:"text-sm text-gray-500 mb-4"}," Automate repetitive tasks in your store to save time and focus on growing your business. Let the platform handle things like order processing, inventory updates, and customer notifications for you. ",-1)),t("div",R,[l.hasSearchTerm||l.hasWorkflows?(s(),m(y,{key:0,modelValue:a.searchTerm,"onUpdate:modelValue":e[0]||(e[0]=o=>a.searchTerm=o),isSearching:l.isSearching},null,8,["modelValue","isSearching"])):w("",!0),a.isLoadingWorkflows?(s(),i("div",Y,[(s(),i(p,null,W([1,2,3],(o,u)=>t("div",{key:u,class:"border shadow-sm rounded-lg p-4 bg-gray-50"},[d(g,{class:"w-full flex items-center justify-between"},{default:c(()=>[d(k,{width:"w-32"}),d(k,{width:"w-16"})]),_:1})])),64))])):(s(),i(p,{key:2},[d(S,{class:"space-y-2",modelValue:a.workflows,"onUpdate:modelValue":e[2]||(e[2]=o=>a.workflows=o),handle:".draggable-handle","ghost-class":"bg-yellow-50",onChange:l.updateWorkflowArrangement},{default:c(()=>[(s(!0),i(p,null,W(a.workflows,(o,u)=>(s(),i("div",{onClick:()=>l.onViewWorkflow(o),key:u,class:"flex items-center justify-between space-x-4 border shadow-sm rounded-lg p-4 bg-gray-50 cursor-pointer hover:border-blue-200 hover:bg-blue-50 group"},[t("div",$,[t("div",ee,[e[3]||(e[3]=t("svg",{class:"w-6 h-6 mt-1 ml-3",fill:"#44c152",version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 308 308","xml:space":"preserve"},[t("g",{id:"XMLID_468_"},[t("path",{id:"XMLID_469_",d:"M227.904,176.981c-0.6-0.288-23.054-11.345-27.044-12.781c-1.629-0.585-3.374-1.156-5.23-1.156c-3.032,0-5.579,1.511-7.563,4.479c-2.243,3.334-9.033,11.271-11.131,13.642c-0.274,0.313-0.648,0.687-0.872,0.687c-0.201,0-3.676-1.431-4.728-1.888c-24.087-10.463-42.37-35.624-44.877-39.867c-0.358-0.61-0.373-0.887-0.376-0.887c0.088-0.323,0.898-1.135,1.316-1.554c1.223-1.21,2.548-2.805,3.83-4.348c0.607-0.731,1.215-1.463,1.812-2.153c1.86-2.164,2.688-3.844,3.648-5.79l0.503-1.011c2.344-4.657,0.342-8.587-0.305-9.856c-0.531-1.062-10.012-23.944-11.02-26.348c-2.424-5.801-5.627-8.502-10.078-8.502c-0.413,0,0,0-1.732,0.073c-2.109,0.089-13.594,1.601-18.672,4.802c-5.385,3.395-14.495,14.217-14.495,33.249c0,17.129,10.87,33.302,15.537,39.453c0.116,0.155,0.329,0.47,0.638,0.922c17.873,26.102,40.154,45.446,62.741,54.469c21.745,8.686,32.042,9.69,37.896,9.69c0.001,0,0.001,0,0.001,0c2.46,0,4.429-0.193,6.166-0.364l1.102-0.105c7.512-0.666,24.02-9.22,27.775-19.655c2.958-8.219,3.738-17.199,1.77-20.458C233.168,179.508,230.845,178.393,227.904,176.981z"}),t("path",{id:"XMLID_470_",d:"M156.734,0C73.318,0,5.454,67.354,5.454,150.143c0,26.777,7.166,52.988,20.741,75.928L0.212,302.716c-0.484,1.429-0.124,3.009,0.933,4.085C1.908,307.58,2.943,308,4,308c0.405,0,0.813-0.061,1.211-0.188l79.92-25.396c21.87,11.685,46.588,17.853,71.604,17.853C240.143,300.27,308,232.923,308,150.143C308,67.354,240.143,0,156.734,0zM156.734,268.994c-23.539,0-46.338-6.797-65.936-19.657c-0.659-0.433-1.424-0.655-2.194-0.655c-0.407,0-0.815,0.062-1.212,0.188l-40.035,12.726l12.924-38.129c0.418-1.234,0.209-2.595-0.561-3.647c-14.924-20.392-22.813-44.485-22.813-69.677c0-65.543,53.754-118.867,119.826-118.867c66.064,0,119.812,53.324,119.812,118.867C276.546,215.678,222.799,268.994,156.734,268.994z"})])],-1)),t("h1",te,x(o.name),1)]),t("div",oe,[d(v,{type:o.active?"success":"warning",text:o.active?"Active":"Inactive",showDot:!1},null,8,["type","text"])])]),l.isDeleting(o)?(s(),m(_,{key:0,type:"danger"},{default:c(()=>e[4]||(e[4]=[t("span",{class:"text-xs ml-2"},"Deleting...",-1)])),_:1})):(s(),i("svg",{key:1,onClick:b(fe=>l.showDeleteConfirmationModal(o),["stop","prevent"]),class:"w-4 h-4 cursor-pointer hover:text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},e[5]||(e[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"},null,-1)]),8,se)),(s(),i("svg",{onClick:e[1]||(e[1]=b(()=>{},["stop"])),class:"draggable-handle w-4 h-4 cursor-grab hover:text-yellow-500 active:cursor-grabbing",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},e[6]||(e[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"},null,-1)])))],8,Z))),128))]),_:1},8,["modelValue","onChange"]),l.hasWorkflows?w("",!0):(s(),i("div",re,[t("div",le,[e[9]||(e[9]=t("svg",{class:"w-80 text-gray-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3"})],-1)),t("div",ie,[l.hasSearchTerm?(s(),i("p",ne,"No workflows found.")):w("",!0),t("p",null,[e[7]||(e[7]=h("Click the ")),d(v,{type:"primary",text:"+ Add Workflow",showDot:!1,clickable:!0,action:()=>l.onAddWorkflow()},null,8,["action"]),e[8]||(e[8]=h(" button to set up automations that will handle time-consuming tasks for you"))])])])]))],64)),a.isLoadingWorkflows?(s(),m(g,{key:3},{default:c(()=>[d(L,{size:"sm",class:"w-full"},{default:c(()=>e[10]||(e[10]=[t("span",{class:"leading-none text-sm"},"＋",-1),t("span",{class:"ml-2"},"Add Workflow",-1)])),_:1})]),_:1})):(s(),m(C,{key:4,action:()=>l.onAddWorkflow(),size:"sm",type:"light"},{default:c(()=>e[11]||(e[11]=[t("span",{class:"ml-2"},"Add Workflow",-1)])),_:1},8,["action"])),a.deletableWorkflow?(s(),m(A,{key:5,approveText:"Delete",approveAction:o=>l.deleteWorkflow(o),isLoading:l.isDeleting(l.deleteWorkflow)},{content:c(()=>[e[14]||(e[14]=t("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),t("p",ae,[e[12]||(e[12]=h("Are you sure you want to delete ")),t("span",de,x(a.deletableWorkflow.name),1),e[13]||(e[13]=h("?"))])]),trigger:c(o=>[d(I,{ref:"confirmDeleteButton",action:o.showModal,class:"hidden",type:"danger"},null,8,["action"])]),_:1},8,["approveAction","isLoading"])):w("",!0)])])}const Ee=J(K,[["render",ce]]);export{Ee as default};
