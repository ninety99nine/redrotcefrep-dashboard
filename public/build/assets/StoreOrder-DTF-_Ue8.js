import{u as j,c as A,i as le}from"./store-store-Bg5rYxD_.js";import{A as G}from"./Alert-CDjV7k-S.js";import{F as N}from"./FormMixin-Dgvngqr1.js";import{U as Q}from"./UtilsMixin-CbFS-0FV.js";import{o as t,c as i,b as e,F as g,k as v,d as n,w as l,e as p,f as _,n as Z,t as c,r as h,s as de,h as y,A as J,p as Y,y as ce,i as he,u as ue}from"./app-BBiNtTMT.js";import{T as me}from"./TextInput-ENsoNhZ_.js";import{I as pe}from"./InputTags-eUwC9IQC.js";import{T as te}from"./TextHeader-2OONdxAo.js";import{B as _e}from"./BackButton-kxLtsZ-p.js";import{N as fe}from"./NumberInput-RXW9an2d.js";import{S as ge}from"./SelectInput-BJmjyHHD.js";import{O as ye,a as we}from"./OrderPaymentStatus-Bf7doeja.js";import{C as K}from"./ConfirmModal-DKlczlqI.js";import{S as F}from"./ShineEffect-Bnha0U3_.js";import{T as se}from"./TextareaInput-CPlqaTKy.js";import{L as B}from"./LineSkeleton-DXcAQlf7.js";import{P as X}from"./PrimaryButton-DHUftccA.js";import{S as oe}from"./SpinningLoader-DBJE88C5.js";import{O as re}from"./OtpInput-B7Nc_Utl.js";import{S as xe}from"./SelectInputTags-BuEeqIA-.js";import{B as ke}from"./ButtonSkeleton-Dg7UyU4o.js";import{M as R}from"./MoreInfoPopover-BZ2tVscg.js";import{B as be}from"./BackdropLoader-B5_rh3lZ.js";import{B as q}from"./BadgeIndicator-CQIXUZqg.js";import{N as ve}from"./NoDataPlaceholder-D5cUVnek.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{F as Pe}from"./FormErrorMessages-C4RomT-2.js";import{A as Se}from"./AddButton-DSp6KANw.js";import{B as Oe}from"./BasicTable-uw6X2awn.js";import{E as Te}from"./ExternalLink-BnDKbcqQ.js";import{g as U,d as ie,p as I,a as Me}from"./api-repository-CRee0Q10.js";import{T as Ce}from"./ToogleSwitch-C2xupFTj.js";import{T as Le}from"./TransactionPaymentStatus-DQrhNfrS.js";import{R as Ae}from"./RoundSkeleton-BMRSoDbb.js";import"./form-store-DVy4TZqf.js";import"./InputLabel-BcWBYAbx.js";import"./InputErrorMessage-B5IzqFhT.js";import"./vue3-tags-input.esm-Qx7rdUJO.js";import"./StatusDot-Cj_cMTkK.js";import"./SearchInput-CDeKnusL.js";import"./index-B_gOZyBG.js";const Be={mixins:[N],components:{Alert:G,ShineEffect:F,LineSkeleton:B,MoreInfoPopover:R,BadgeIndicator:q,NoDataPlaceholder:ve},props:{order:{type:Object},isLoadingOrder:{type:Boolean}},data(){return{storeState:j()}},computed:{store(){return this.storeState.store}},methods:{canViewProduct(s){return s._links.showProduct?s._links.showProduct:!1},onViewProduct(s){this.canViewProduct(s)?this.$router.push({name:"show-store-product",params:{store_href:this.store._links.showStore,product_href:s._links.showProduct}}):this.showUnsuccessfulNotification("This product does not exist anymore. It might be deleted")}}},Ve={class:"space-y-3 bg-white shadow-lg rounded-lg border p-4 mb-4"},De=e("p",{class:"font-bold text-lg"},"Items",-1),Ee={class:"w-full text-sm text-left rtl:text-right text-gray-500"},Ue=e("thead",{class:"font-bold text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("td",{class:"whitespace-nowrap px-4 py-3"},"Image"),e("td",{class:"w-80 whitespace-nowrap px-4 py-3"},"Name"),e("td",{class:"whitespace-nowrap px-4 py-3"},"Price"),e("td",{class:"whitespace-nowrap px-4 py-3 text-right"},"Quantity"),e("td",{class:"whitespace-nowrap px-4 py-3 text-right"},"Total")])],-1),Ie=["onClick"],Ne={class:"whitespace-nowrap px-4 py-3"},Fe={class:"w-80 whitespace-nowrap px-4 py-3"},Re={class:"whitespace-nowrap px-4 py-3"},qe={class:"whitespace-nowrap px-4 py-3 text-right"},He={class:"whitespace-nowrap px-4 py-3 text-right"},Ze={class:"text-xs text-right"},je=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-2"},"Subtotal",-1),We={colspan:"1",class:"whitespace-nowrap px-4 py-2"},ze={key:1},Ye={class:"text-xs text-right"},Je=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-2"},"Sale Discount Total",-1),Ge={colspan:"1",class:"whitespace-nowrap px-4 py-2"},Qe={key:1},Ke={class:"text-xs text-right"},Xe=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-2"},"Coupon Discount Total",-1),$e={colspan:"1",class:"whitespace-nowrap px-4 py-2"},et={key:1},tt={class:"text-right text-black text-lg font-bold border-t"},st=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-3"},"Grand Total",-1),ot={colspan:"1",class:"whitespace-nowrap px-4 py-3"},rt={key:1},it=e("span",null,[e("svg",{class:"w-6 h-6 mr-2 inline-block",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"})]),e("span",{class:"font-bold mr-1"},"Special Note:")],-1);function nt(s,a,r,S,o,d){const w=h("LineSkeleton"),f=h("ShineEffect"),x=h("NoDataPlaceholder"),M=h("Alert");return t(),i("div",Ve,[De,e("table",Ee,[Ue,e("tbody",null,[r.isLoadingOrder?(t(),i(g,{key:0},v(3,(b,k)=>e("tr",{key:k,class:"border-b"},[(t(),i(g,null,v(5,(T,L)=>e("td",{key:L,class:"whitespace-nowrap px-4 py-3"},[n(f,null,{default:l(()=>[r.isLoadingOrder?(t(),p(w,{key:0})):_("",!0)]),_:1})])),64))])),64)):(t(!0),i(g,{key:1},v(r.order._relationships.cart._relationships.productLines,(b,k)=>(t(),i("tr",{key:k,onClick:()=>d.onViewProduct(b),class:Z(["border-b cursor-pointer",d.canViewProduct(b)?"hover:bg-gray-50":"hover:bg-red-50"])},[e("td",Ne,[n(x)]),e("td",Fe,[e("span",null,c(b.name),1)]),e("td",Re,[e("span",null,c(b.unitPrice.amountWithCurrency),1)]),e("td",qe,[e("span",null,c(b.quantity),1)]),e("td",He,[e("span",null,c(b.grandTotal.amountWithCurrency),1)])],10,Ie))),128)),e("tr",Ze,[je,e("td",We,[r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[n(w)]),_:1})):(t(),i("span",ze,c(r.order._relationships.cart.subTotal.amountWithCurrency),1))])]),e("tr",Ye,[Je,e("td",Ge,[r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[n(w)]),_:1})):(t(),i("span",Qe,c(r.order._relationships.cart.saleDiscountTotal.amount>0?"-":"")+" "+c(r.order._relationships.cart.saleDiscountTotal.amountWithCurrency),1))])]),e("tr",Ke,[Xe,e("td",$e,[r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[n(w)]),_:1})):(t(),i("span",et,c(r.order._relationships.cart.couponDiscountTotal.amount>0?"-":"")+" "+c(r.order._relationships.cart.couponDiscountTotal.amountWithCurrency),1))])]),e("tr",tt,[st,e("td",ot,[r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[n(w)]),_:1})):(t(),i("span",rt,c(r.order._relationships.cart.grandTotal.amountWithCurrency),1))])])])]),r.order&&r.order.specialNote?(t(),p(M,{key:0},{default:l(()=>[it,e("span",null,c(r.order.specialNote),1)]),_:1})):_("",!0)])}const at=V(Be,[["render",nt]]),lt={mixins:[N,Q],components:{AddButton:Se,TextHeader:te,BasicTable:Oe,ExternalLink:Te,ConfirmModal:K,ShineEffect:F,LineSkeleton:B,SpinningLoader:oe,PrimaryButton:X,MoreInfoPopover:R,ToogleSwitch:Ce,BadgeIndicator:q,TransactionPaymentStatus:Le},props:{order:{type:Object},isLoadingOrder:{type:Boolean},refreshOrder:{type:Function}},data(){return{transactions:[],pagination:null,searchTerm:null,showEverything:!1,appName:de.appName,deletableTransaction:null,isDeletingTransactionIds:[],isLoadingTransactions:!1,storeState:j()}},computed:{store(){return this.storeState.store},tableHeaders(){return this.showEverything?["#","Description","Payment Status","Amount","Percentage","Payment Method","Paid By","Verified By","Requested By","DPO Payment Link","DPO Link Status","DPO Expiry Date","Created Date",""]:["#","Payment Status","Amount","Payment Method","Paid By","Verified By","Requested By","DPO Payment Link","DPO Link Status",""]},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{onView(s){this.$router.push({name:"show-store-transaction",params:{store_href:this.store._links.showStore,transaction_href:s._links.showTransaction}}).then(()=>{window.scrollTo(0,0)})},showDeleteConfirmationModal(s){this.deletableTransaction=s,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(s){return this.isDeletingTransactionIds.findIndex(a=>a==s.id)!=-1},paginate(s){this.url=s,this.getTransactions()},search(s){this.url=this.store._links.showOrderTransactions,this.searchTerm=s,this.getTransactions()},getTransactions(){this.isLoadingTransactions=!0;const s={_relationships:"customer,requestedByUser,manuallyVerifiedByUser,paymentMethod"};this.hasSearchTerm&&(s.search=this.searchTerm),U(this.url,s).then(a=>{a.status==200&&(this.pagination=a.data,this.transactions=this.pagination.data),this.isLoadingTransactions=!1}).catch(a=>{this.isLoadingTransactions=!1})},deleteTransaction(){this.isDeletingTransactionIds.push(this.deletableTransaction.id),ie(this.deletableTransaction._links.deleteTransaction).then(s=>{this.isDeletingTransactionIds.splice(this.isDeletingTransactionIds.findIndex(a=>a==this.deletableTransaction.id,1)),s.status==200&&(s.data.deleted?(this.showSuccessfulNotification("Transaction deleted"),this.isDeletingTransactionIds.length==0&&this.getTransactions()):(this.setFormError("general",s.data.message),this.showUnsuccessfulNotification(s.data.message)))}).catch(s=>{this.isDeletingTransactionIds.splice(this.isDeletingTransactionIds.findIndex(a=>a==this.deletableTransaction.id,1)),this.setServerFormErrors(s)})}},created(){this.url=this.order._links.showOrderTransactions,this.getTransactions()}},dt={class:"flex justify-between items-center border-dashed border-b pb-4 mb-4"},ct={class:"flex items-center"},ht={class:"font-bold text-sm"},ut={key:0},mt=["onClick"],pt={class:"whitespace-nowrap px-4 py-4"},_t={class:"flex space-x-1 items-center"},ft={key:0,class:"px-4 py-4"},gt={class:"min-w-80"},yt={class:"whitespace-nowrap px-4 py-4"},wt={class:"whitespace-nowrap px-4 py-4 text-center"},xt={key:1,class:"whitespace-nowrap px-4 py-4 text-center"},kt={class:"whitespace-nowrap px-4 py-4 text-center"},bt={class:"whitespace-nowrap px-4 py-4"},vt={key:0},Pt={key:1,class:"text-xs text-center text-gray-300"},St={class:"text-xs text-center text-gray-300"},Ot={key:0,class:"whitespace-nowrap px-4 py-4"},Tt={class:"whitespace-nowrap px-4 py-4"},Mt={key:0},Ct={key:1,class:"text-xs text-center text-gray-300"},Lt={class:"px-4 py-4"},At={key:0,class:"max-w-80"},Bt={key:1,class:"text-xs text-center text-gray-300"},Vt={class:"text-xs text-center text-gray-300"},Dt={key:0,class:"text-xs text-center text-gray-300"},Et={key:2,class:"whitespace-nowrap px-4 py-4"},Ut={key:0,class:"flex space-x-1 items-center"},It={key:1,class:"text-xs text-center text-gray-300"},Nt={key:3,class:"whitespace-nowrap px-4 py-4"},Ft={class:"flex space-x-1 items-center"},Rt={class:"px-4 py-4 flex items-center space-x-4"},qt=["onClick"],Ht=e("span",{class:"text-xs ml-2"},"Deleting...",-1),Zt=["onClick"],jt={key:1,class:"p-8 border rounded-lg bg-gray-50"},Wt=ce('<div class="flex justify-between space-x-20 mb-2"><div><span class="text-8xl">ðŸ’µ</span></div><div class="space-y-3"><h1 class="text-lg font-bold">No Transactions Yet</h1><p class="text-sm">Your transactions will appear here once customers start paying for this order. <span class="underline decoration-dashed underline-offset-4">Request payments</span> or <span class="underline decoration-dashed underline-offset-4">mark this order as paid</span>.</p></div></div>',1),zt={class:"flex justify-end"},Yt=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1),Jt={class:"mb-8"},Gt={class:"font-bold text-black"};function Qt(s,a,r,S,o,d){const w=h("MoreInfoPopover"),f=h("ToogleSwitch"),x=h("LineSkeleton"),M=h("ShineEffect"),b=h("TransactionPaymentStatus"),k=h("BadgeIndicator"),T=h("ExternalLink"),L=h("SpinningLoader"),D=h("BasicTable"),O=h("PrimaryButton"),W=h("ConfirmModal");return t(),i("div",null,[e("div",dt,[e("div",ct,[e("p",ht,[y("Transactions "),(o.pagination??{}).total>0?(t(),i("span",ut,"("+c((o.pagination??{}).total)+")",1)):_("",!0)]),n(w,{class:"ml-2 mt-1",title:"What Is This?",description:"Transactions are records of payments made by customers for their orders.",placement:"top"})]),(o.pagination??{}).total>0?J(s.$slots,"actionButtons",{key:0}):_("",!0)]),o.isLoadingTransactions||(o.pagination??{}).total>0||d.hasSearchTerm?(t(),p(D,{key:0,pagination:o.pagination,isLoading:o.isLoadingTransactions,onPaginate:d.paginate,onSearch:d.search,onRefresh:d.getTransactions,totalHeaders:d.tableHeaders.length},{primaryFilters:l(()=>[n(f,{modelValue:o.showEverything,"onUpdate:modelValue":a[0]||(a[0]=m=>o.showEverything=m),size:"md",labelPopoverTitle:"What Is This?",labelPopoverDescription:"Turn on if you want to show more information about your transactions"},{default:l(()=>[y(" Show Everything ")]),_:1},8,["modelValue"])]),head:l(()=>[e("tr",null,[(t(!0),i(g,null,v(d.tableHeaders,(m,C)=>(t(),i("th",{key:C,scope:"col",class:"whitespace-nowrap px-4 py-3"},c(m),1))),128))])]),body:l(()=>[o.isLoadingTransactions?(t(),i(g,{key:0},v(3,(m,C)=>e("tr",{key:C,class:"border-b"},[(t(!0),i(g,null,v(d.tableHeaders,($,z)=>(t(),i("td",{key:z,class:"whitespace-nowrap px-4 py-3"},[n(M,null,{default:l(()=>[n(x)]),_:1})]))),128))])),64)):(t(!0),i(g,{key:1},v(o.transactions,m=>(t(),i("tr",{onClick:Y(C=>d.onView(m),["stop"]),key:m.id,class:"group cursor-pointer bg-white hover:bg-gray-50 border-b"},[e("td",pt,[e("div",_t,[e("span",null,"#"+c(m._attributes.number),1),n(w,{class:"opacity-0 group-hover:opacity-100",title:"#"+m._attributes.number,description:m.description,placement:"top"},null,8,["title","description"])])]),o.showEverything?(t(),i("td",ft,[e("div",gt,c(m.description),1)])):_("",!0),e("td",yt,[n(b,{transaction:m},null,8,["transaction"])]),e("td",wt,c(m.amount.amountWithCurrency),1),o.showEverything?(t(),i("td",xt,c(m.percentage.valueSymbol),1)):_("",!0),e("td",kt,c(m._relationships.paymentMethod.name),1),e("td",bt,[m._relationships.paidByUser?(t(),i("span",vt,c(m._relationships.paidByUser._attributes.name),1)):(t(),i("span",Pt,"---"))]),e("td",St,[m._relationships.verifiedByUser?(t(),i("span",Ot,c(m._relationships.verifiedByUser._attributes.name),1)):(t(),p(k,{key:1,type:"info",text:o.appName,showDot:!1},null,8,["text"]))]),e("td",Tt,[m._relationships.requestedByUser?(t(),i("span",Mt,c(m._relationships.requestedByUser._attributes.name),1)):(t(),i("span",Ct,"---"))]),e("td",Lt,[m.dpoPaymentUrl?(t(),i("div",At,[n(T,{url:m.dpoPaymentUrl,class:"text-xs"},{default:l(()=>[y(c(m.dpoPaymentUrl),1)]),_:2},1032,["url"])])):(t(),i("span",Bt,"---"))]),e("td",Vt,[m._attributes.dpoPaymentLinkHasExpired==null?(t(),i("span",Dt,"---")):(t(),p(k,{key:1,type:m._attributes.dpoPaymentLinkHasExpired==!1?"success":"warning",text:m._attributes.dpoPaymentLinkHasExpired==!1?"Active":"Expired",showDot:!1},null,8,["type","text"]))]),o.showEverything?(t(),i("td",Et,[m.dpoPaymentUrlExpiresAt?(t(),i("div",Ut,[e("span",null,c(s.formattedDatetime(m.dpoPaymentUrlExpiresAt)),1),n(w,{class:"opacity-0 group-hover:opacity-100",title:s.formattedRelativeDate(m.dpoPaymentUrlExpiresAt),placement:"top"},null,8,["title"])])):(t(),i("span",It,"---"))])):_("",!0),o.showEverything?(t(),i("td",Nt,[e("div",Ft,[e("span",null,c(s.formattedDatetime(m.createdAt)),1),n(w,{class:"opacity-0 group-hover:opacity-100",title:s.formattedRelativeDate(m.createdAt),placement:"top"},null,8,["title"])])])):_("",!0),e("td",Rt,[d.isDeleting(m)?_("",!0):(t(),i("a",{key:0,href:"#",onClick:Y(C=>d.onView(m),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"Edit",8,qt)),d.isDeleting(m)?(t(),p(L,{key:1,type:"danger"},{default:l(()=>[Ht]),_:1})):(t(),i("a",{key:2,href:"#",onClick:Y(C=>d.showDeleteConfirmationModal(m),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,Zt))])],8,mt))),128))]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(t(),i("div",jt,[Wt,e("div",zt,[J(s.$slots,"actionButtons")])])),o.deletableTransaction?(t(),p(W,{key:2,approveText:"Delete Transaction",approveAction:d.deleteTransaction,isLoading:d.isDeleting(o.deletableTransaction)},{content:l(()=>[Yt,e("p",Jt,[y("Are you sure you want to permanently delete "),e("span",Gt,"transaction #"+c(o.deletableTransaction._attributes.number),1),y("?")])]),trigger:l(m=>[n(O,{ref:"confirmDeleteButton",action:m.showModal,class:"hidden",type:"danger"},{default:l(()=>[y(" Delete Transaction ")]),_:2},1032,["action"])]),_:1},8,["approveAction","isLoading"])):_("",!0)])}const Kt=V(lt,[["render",Qt]]),Xt={mixins:[N],components:{LineSkeleton:B,MoreInfoPopover:R,BadgeIndicator:q,OrderTransactions:Kt},props:{order:{type:Object},isLoadingOrder:{type:Boolean},refreshOrder:{type:Function}},data(){return{}}},$t={class:"mb-4"},es={class:"bg-white shadow-lg rounded-lg border p-4"},ts={class:"space-y-3"},ss=e("p",{class:"font-bold text-lg"},"Payment",-1),os={class:"flex items-center space-x-2 text-sm"},rs=e("span",null,"Amount Paid: ",-1),is={key:1,class:"font-bold"},ns={key:1,class:"w-3/4 flex items-center space-x-4"},as={class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700"},ls={class:"text-xs"},ds={key:0,class:"bg-white shadow-lg rounded-lg border p-4 mt-4"};function cs(s,a,r,S,o,d){const w=h("LineSkeleton"),f=h("OrderTransactions");return t(),i("div",$t,[e("div",es,[e("div",ts,[ss,e("div",os,[rs,r.isLoadingOrder?(t(),p(w,{key:0,width:"w-32"})):(t(),i("span",is,c(r.order.paidTotal.amountWithCurrency),1))]),r.isLoadingOrder?(t(),p(w,{key:0,width:"w-full"})):(t(),i("div",ns,[e("div",as,[e("div",{class:"bg-green-500 h-2.5 rounded-full",style:he("width: "+r.order.paidPercentage.value+"%")},null,4)]),e("span",ls,c(r.order.paidPercentage.valueSymbol),1)]))])]),r.isLoadingOrder?_("",!0):(t(),i("div",ds,[n(f,{order:r.order,refreshOrder:r.refreshOrder},{actionButtons:l(()=>[J(s.$slots,"actionButtons")]),_:3},8,["order","refreshOrder"])]))])}const hs=V(Xt,[["render",cs]]),us={components:{ShineEffect:F,LineSkeleton:B},props:{order:{type:Object},isLoadingOrder:{type:Boolean}},computed:{hasCustomer(){return this.order._relationships.customer!=null},customer(){return this.order._relationships.customer}}},ms={class:"bg-white shadow-lg rounded-lg border space-y-3 p-4"},ps={class:"flex items-center space-x-2"},_s=e("div",{class:"p-1.5 bg-gray-100 rounded-full border border-gray-200"},[e("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})])],-1),fs={key:1,class:"font-bold"},gs={key:2,class:"font-bold text-lg"},ys={class:"space-y-2"},ws={key:0,class:"flex items-center space-x-2 text-sm"},xs=e("svg",{class:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"})],-1),ks={key:1,class:"font-bold"},bs={key:1,class:"flex items-center space-x-2 text-sm"},vs=e("svg",{class:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})],-1),Ps={key:1,class:"font-bold"},Ss={key:1,class:"text-xs"};function Os(s,a,r,S,o,d){const w=h("LineSkeleton"),f=h("ShineEffect");return t(),i("div",ms,[e("div",ps,[_s,r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[n(w,{width:"w-32"})]),_:1})):r.order._attributes.customerName?(t(),i("span",fs,c(r.order._attributes.customerName),1)):(t(),i("span",gs,"Customer"))]),e("div",ys,[r.isLoadingOrder||r.order.customerMobileNumber||r.order.customerEmail?(t(),i(g,{key:0},[r.isLoadingOrder||r.order.customerMobileNumber?(t(),i("div",ws,[xs,r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[n(w,{width:"w-32"})]),_:1})):(t(),i("span",ks,c(r.order.customerMobileNumber.national),1))])):_("",!0),r.isLoadingOrder||r.order.customerEmail?(t(),i("div",bs,[vs,r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[n(w,{width:"w-32"})]),_:1})):(t(),i("span",Ps,c(r.order.customerEmail),1))])):_("",!0)],64)):(t(),i("span",Ss,"No information"))])])}const Ts=V(us,[["render",Os]]),Ms={mixins:[N,Q],components:{Alert:G,ConfirmModal:K,ShineEffect:F,TextareaInput:se,OtpInput:re,LineSkeleton:B,PrimaryButton:X,RoundSkeleton:Ae,MoreInfoPopover:R,BadgeIndicator:q},props:{order:{type:Object},refreshOrder:{type:Function},isLoadingOrder:{type:Boolean}},data(){return{collectionCode:"",collectionNote:"",storeState:j(),isUpdatingOrderStatus:!1}},computed:{store(){return this.storeState.store},isVerified(){return this.order.collectionVerified.status},collectionVerifiedByUser(){return this.order._relationships.collectionVerifiedByUser},canManageOrders(){return this.store._relationships.userStoreAssociation._attributes.canManageOrders}},methods:{verifyOrderCollection(s){this.isUpdatingOrderStatus=!0;var a={collectionCode:this.collectionCode};this.collectionNote.trim()!=""&&(a.collectionNote=this.collectionNote),I(this.order._links.verifyOrderCollection,a).then(r=>{r.status==200&&(s(),this.refreshOrder(),this.showSuccessfulNotification("Order collection confirmed")),this.isUpdatingOrderStatus=!1}).catch(r=>{this.isUpdatingOrderStatus=!1,this.setServerFormErrors(r)})}}},Cs={class:"bg-white shadow-lg rounded-lg border space-y-3 p-4 mb-4"},Ls={key:0,class:"flex items-center space-x-2"},As=e("p",{class:"font-bold text-lg"},"Collection",-1),Bs={key:1,class:"flex items-center space-x-2 font-bold text-lg"},Vs=e("svg",{class:"w-6 h-6 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1),Ds=e("span",null,"Collected",-1),Es=[Vs,Ds],Us=e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})]),e("p",{class:"font-bold text-lg"},"Confirm Collection")],-1),Is={class:"text-xs"},Ns={key:3,class:"flex space-x-1"},Fs={key:0,class:"flex space-x-1 items-center"},Rs=e("span",{class:"text-xs"},"Type: ",-1),qs={class:"font-bold text-xs"},Hs={key:1},Zs=e("span",{class:"text-xs"},"Location: ",-1),js={class:"font-bold text-xs"},Ws={key:5,class:"space-y-2 pb-2"},zs={class:"flex items-center space-x-2 text-xs"},Ys=e("div",{class:"flex items-center space-x-1"},[e("svg",{class:"w-4 h-4 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})]),e("span",null,"Verified By: ")],-1),Js={class:"font-bold"},Gs={class:"flex items-center space-x-2 text-xs"},Qs=e("div",{class:"flex items-center space-x-1"},[e("svg",{class:"w-4 h-4 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]),e("span",null,"Verified Date:")],-1),Ks={key:0,class:"flex space-x-2"},Xs={class:"font-bold"},$s={key:0,class:"flex space-x-1 border-t border-dashed pt-4"},eo=e("svg",{class:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})],-1),to={class:"text-xs"},so={key:6,class:"border-b border-dashed"},oo={class:"space-y-4 mb-8"},ro=e("p",{class:"text-lg font-bold border-b border-dashed pb-4"},"Confirm Collection",-1),io=e("span",{class:"font-bold mr-1"},"How to verify collection",-1),no={class:"flex justify-end"};function ao(s,a,r,S,o,d){const w=h("RoundSkeleton"),f=h("ShineEffect"),x=h("LineSkeleton"),M=h("MoreInfoPopover"),b=h("Alert"),k=h("OtpInput"),T=h("TextareaInput"),L=h("PrimaryButton"),D=h("ConfirmModal");return t(),i("div",Cs,[r.isLoadingOrder?(t(),i("div",Ls,[n(f,null,{default:l(()=>[n(w,{size:"w-6 h-6"})]),_:1}),As])):!r.isLoadingOrder&&d.isVerified?(t(),i("div",Bs,Es)):_("",!0),!r.isLoadingOrder&&!d.isVerified?(t(),i(g,{key:2},[Us,e("p",Is,c(r.order.collectionVerified.description),1)],64)):_("",!0),r.isLoadingOrder?(t(),i("div",Ns,[n(x,{width:"w-12"}),n(x,{width:"w-24"}),n(x,{width:"w-4"})])):r.order.collectionType||r.order.destinationName?(t(),i("div",{key:4,class:Z(["flex items-end space-x-4 text-sm",r.isLoadingOrder||!r.isLoadingOrder&&d.isVerified?"border-b border-dashed pb-2":"border-t border-dashed pt-2 mt-2"])},[r.order.collectionType?(t(),i("div",Fs,[Rs,e("span",qs,c(r.order.collectionType.name),1),n(M,{title:r.order.collectionType.description,placement:"top"},null,8,["title"])])):_("",!0),r.order.destinationName?(t(),i("div",Hs,[Zs,e("span",js,c(r.order.destinationName),1)])):_("",!0)],2)):_("",!0),r.isLoadingOrder||!r.isLoadingOrder&&d.isVerified?(t(),i("div",Ws,[e("div",zs,[Ys,r.isLoadingOrder?(t(),p(x,{key:0,width:"w-24"})):(t(),i(g,{key:1},[e("span",Js,c(d.collectionVerifiedByUser._attributes.name),1),n(M,{title:"Contact: "+d.collectionVerifiedByUser.mobileNumber.national,placement:"top"},null,8,["title"])],64))]),e("div",Gs,[Qs,r.isLoadingOrder?(t(),i("div",Ks,[n(x,{width:"w-32"}),n(x,{width:"w-4"})])):(t(),i(g,{key:1},[e("span",Xs,c(s.formattedDatetime(r.order.collectionVerifiedAt)),1),n(M,{title:s.formattedRelativeDate(r.order.collectionVerifiedAt),placement:"top"},null,8,["title"])],64))]),r.isLoadingOrder||r.order.collectionNote?(t(),i("div",$s,[r.isLoadingOrder?(t(),i(g,{key:0},[r.isLoadingOrder?(t(),p(x,{key:0,width:"w-4"})):_("",!0),r.isLoadingOrder?(t(),p(x,{key:1,width:"w-32"})):_("",!0)],64)):(t(),i(g,{key:1},[eo,e("p",to,c(r.order.collectionNote),1)],64))])):_("",!0)])):_("",!0),!r.isLoadingOrder&&!d.isVerified?(t(),i("div",so)):_("",!0),!r.isLoadingOrder&&!d.isVerified?(t(),p(D,{key:7,declineText:"Cancel",declineType:"light",isLoading:o.isUpdatingOrderStatus,autoHide:!1,approveAction:O=>d.verifyOrderCollection(O),approveText:"Confirm Collection",approveType:"primary",approveDisabled:o.collectionCode.length<6||o.isUpdatingOrderStatus},{content:l(()=>[e("div",oo,[ro,r.order._attributes.dialToShowCollectionCode?(t(),p(b,{key:0},{default:l(()=>[io,y(" - "+c(r.order._attributes.dialToShowCollectionCode.instruction),1)]),_:1})):_("",!0),n(k,{modelValue:o.collectionCode,"onUpdate:modelValue":a[0]||(a[0]=O=>o.collectionCode=O),errorText:s.getFormError("collectionCode"),class:"mb-8"},null,8,["modelValue","errorText"]),n(T,{modelValue:o.collectionNote,"onUpdate:modelValue":a[1]||(a[1]=O=>o.collectionNote=O),label:"Note (Optional)",placeholder:"Collected by John Doe",rows:2,errorText:s.getFormError("collectionNote"),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Important note regarding this order collection e.g Collected by John Doe"},null,8,["modelValue","errorText"])])]),trigger:l(O=>[e("div",no,[n(L,{ref:"confirmCollection",size:"xs",type:"light",action:O.showModal,disabled:o.isUpdatingOrderStatus},{default:l(()=>[y(" Confirm Collection ")]),_:2},1032,["action","disabled"])])]),_:1},8,["isLoading","approveAction","approveDisabled"])):_("",!0)])}const lo=V(Ms,[["render",ao]]),co={mixins:[Q,N],components:{Alert:G,TextInput:me,TextHeader:te,InputTags:pe,BackButton:_e,NumberInput:fe,SelectInput:ge,OrderStatus:ye,ConfirmModal:K,ShineEffect:F,TextareaInput:se,LineSkeleton:B,PrimaryButton:X,SpinningLoader:oe,OtpInput:re,SelectInputTags:xe,ButtonSkeleton:ke,MoreInfoPopover:R,BackdropLoader:be,CartSummary:at,OrderPaymentStatus:we,BadgeIndicator:q,FormErrorMessages:Pe,PaymentSummary:hs,CustomerSummary:Ts,CollectionSummary:lo},data(){return{form:{number:""},markAsPaid:{percentage:null,paymentMethods:[],paymentMethodId:null,proofOfPaymentPhoto:null},_requestPayment:{percentage:null,paymentMethods:[],paymentMethodId:null},order:null,isDeleting:!1,originalForm:null,collectionCode:"",collectionNote:"",isSubmitting:!1,markAsPaidAmount:0,followUpStatus:null,isLoadingOrder:!1,cancellationReason:"",isMarkingAsPaid:!1,cancellationReasons:[],apiState:ue(),markAsPaidPercentage:0,proofOfPaymentPhoto:null,isRequestingPayment:!1,storeState:j(),isUpdatingOrderStatus:!1,payableAmountPercentage:null,isLoadingCancellationReasons:!1}},watch:{"$route.params.order_href"(s,a){window.scrollTo(0,0),this.getOrder()}},computed:{store(){return this.storeState.store},isVerified(){return((this.order||{}).collectionVerified||{}).status},canMarkAsPaid(){return((this.order||{})._attributes||{}).canMarkAsPaid},followUpStatuses(){return((this.order||{})._attributes||{}).followUpStatuses},canRequestPayment(){return((this.order||{})._attributes||{}).canRequestPayment},mobileVerificationShortcode(){return this.apiState.apiHome.mobileVerificationShortcode},isCreating(){return this.$route.name==="create-store-order"},isEditting(){return this.$route.name==="show-store-order"},statusBadgeType(){var s=((this.order||{}).status||{}).name.toLowerCase();return s=="completed"?"success":s=="cancelled"?"warning":s=="on its way"||s=="ready for pickup"?"primary":"info"},formHasChanged(){var s=A(this.form),a=A(this.originalForm);return!le(s,a)},mustSaveChanges(){return this.isEditting&&this.formHasChanged&&!this.isLoadingOrder&&!this.isSubmitting},mustCreate(){return this.isCreating&&this.formHasChanged&&!this.isLoadingOrder&&!this.isSubmitting}},methods:{goBack(){this.$router.replace({name:"show-store-orders",params:{store_href:this.store._links.showStore}})},setOrderFields(){this.form.number=this.order.number,this.order._attributes.payableAmounts.length&&(this._requestPayment.percentage=this.order._attributes.payableAmounts[0].percentage.toString(),this.markAsPaid.percentage=this.order._attributes.payableAmounts[0].percentage.toString()),this.originalForm=A(this.form)},confirmUpdateStatus(s){this.followUpStatus=s,this.followUpStatus.name.toLowerCase()=="cancelled"&&this.cancellationReasons.length==0&&this.getCancellationReasons(),this.$nextTick(()=>{this.$refs.confirmUpdateOrderStatus.$el.click()})},confirmMarkAsPaid(){this.$refs.confirmMarkAsPaid.$el.click()},confirmRequestPayment(){this.$refs.confirmRequestPayment.$el.click()},getOrder(){this.isLoadingOrder=!0;const s={_relationships:"cart,customer,occasion,collectionVerifiedByUser"};U(this.$route.params.order_href,s).then(a=>{a.status==200&&(a.data.exists?(this.order=a.data.order,this.setOrderFields(),this.canRequestPayment&&this._requestPayment.paymentMethods.length==0&&this.showPaymentMethodsForRequestingOrderPayment(),this.markAsPaid.paymentMethods.length==0&&this.showPaymentMethodsForMarkingAsPaid()):(this.showUnsuccessfulNotification("This order does not exist"),this.$router.push({name:"show-store-orders",params:{store_href:this.store._links.showStore}}))),this.isLoadingOrder=!1}).catch(a=>{this.isLoadingOrder=!1,this.setServerFormErrors(a)})},showPaymentMethodsForRequestingOrderPayment(){this.isLoadingPaymentMethodsForMarkingAsPaidForRequestingOrderPayment=!0,U(this.order._links.showPaymentMethodsForRequestingOrderPayment).then(s=>{s.status==200&&(this._requestPayment.paymentMethods=s.data.data,this._requestPayment.paymentMethods.length&&(this._requestPayment.paymentMethodId=this._requestPayment.paymentMethods[0].id.toString())),this.isLoadingPaymentMethodsForMarkingAsPaidForRequestingOrderPayment=!1}).catch(s=>{this.isLoadingPaymentMethodsForMarkingAsPaidForRequestingOrderPayment=!1,this.setServerFormErrors(s)})},showPaymentMethodsForMarkingAsPaid(){this.isLoadingPaymentMethodsForMarkingAsPaid=!0,U(this.order._links.showPaymentMethodsForMarkingAsPaid).then(s=>{s.status==200&&(this.markAsPaid.paymentMethods=s.data.data,this.markAsPaid.paymentMethods.length&&(this.markAsPaid.paymentMethodId=this.markAsPaid.paymentMethods[0].id.toString())),this.isLoadingPaymentMethodsForMarkingAsPaid=!1}).catch(s=>{this.isLoadingPaymentMethodsForMarkingAsPaid=!1,this.setServerFormErrors(s)})},getCancellationReasons(){this.isLoadingCancellationReasons=!0,U(this.order._links.showOrderCancellationReasons).then(s=>{s.status==200&&(this.cancellationReasons=s.data),this.isLoadingCancellationReasons=!1}).catch(s=>{this.isLoadingCancellationReasons=!1,this.setServerFormErrors(s)})},parseForm(){var s=A(this.form);return s.hoursOfDay=s.hoursOfDay.map(a=>a.text),s.daysOfTheWeek=s.daysOfTheWeek.map(a=>a.text),s.daysOfTheMonth=s.daysOfTheMonth.map(a=>a.text),s.monthsOfTheYear=s.monthsOfTheYear.map(a=>a.text),s},createOrder(){this.isSubmitting=!0,I(this.store._links.createOrders,this.parseForm()).then(s=>{s.status==200&&(this.showSuccessfulNotification("Order created"),this.$router.push({name:"show-store-orders",params:{store_href:this.store._links.showStore}}),window.scrollTo(0,0)),this.isSubmitting=!1}).catch(s=>{this.isSubmitting=!1,this.setServerFormErrors(s)})},updateOrder(){this.isSubmitting=!0,Me(this.order._links.showOrder,this.parseForm()).then(s=>{s.status==200&&(this.originalForm=A(this.form),this.showSuccessfulNotification("Order updated")),this.isSubmitting=!1}).catch(s=>{this.isSubmitting=!1,this.setServerFormErrors(s)})},updateOrderStatus(s,a){this.isUpdatingOrderStatus=!0;var r={status:s};s.toLowerCase()=="completed"&&!this.isVerified&&(r.collectionCode=this.collectionCode,this.collectionNote.trim()!=""&&(r.collectionNote=this.collectionNote)),s.toLowerCase()=="cancelled"&&this.cancellationReason.trim()!=""&&(r.cancellationReason=this.cancellationReason),I(this.order._links.updateOrderStatus,r).then(S=>{S.status==200&&(S.data.updated?(a(),this.getOrder(),this.showSuccessfulNotification("Order updated")):this.showUnsuccessfulNotification(S.data.message)),this.isUpdatingOrderStatus=!1}).catch(S=>{this.isUpdatingOrderStatus=!1,this.setServerFormErrors(S)})},requestPayment(s){this.isRequestingPayment=!0;var a={percentage:this._requestPayment.percentage,paymentMethodId:this._requestPayment.paymentMethodId};return I(this.order._links.requestPayment,a).then(r=>{r.status==200&&(s(),this.getOrder(),this.showSuccessfulNotification("Payment requested")),this.isRequestingPayment=!1}).catch(r=>{this.isRequestingPayment=!1,this.setServerFormErrors(r)})},markAsUnverifiedPayment(s){this.isMarkingAsPaid=!0;var a={percentage:this.markAsPaid.percentage,paymentMethodId:this.markAsPaid.paymentMethodId,proofOfPaymentPhoto:this.markAsPaid.proofOfPaymentPhoto};this.markAsPaidAmount?a.amount=this.markAsPaidAmount:this.markAsPaidPercentage&&(a.percentage=this.markAsPaidPercentage),I(this.order._links.markAsUnverifiedPayment,a).then(r=>{r.status==200&&(this.getOrder(),s&&s(),this.showSuccessfulNotification("Order marked as paid")),this.isMarkingAsPaid=!1}).catch(r=>{this.isMarkingAsPaid=!1,this.setServerFormErrors(r)})},deleteOrder(){this.isDeleting=!0,ie(this.order._links.deleteOrder).then(s=>{s.status==200&&(s.data.deleted?(this.showSuccessfulNotification("Order deleted"),this.$router.push({name:"show-store-orders",params:{store_href:this.store._links.showStore}}),window.scrollTo(0,0)):(this.setFormError("general",s.data.message),this.showUnsuccessfulNotification(s.data.message))),this.isDeleting=!1}).catch(s=>{this.isDeleting=!1,this.setServerFormErrors(s)})}},created(){this.originalForm=A(this.form),this.isEditting&&this.getOrder()}},ho={class:"flex justify-between items-center border-dashed py-6"},uo={class:"flex justify-start"},mo={key:0,class:"flex items-center space-x-2"},po=e("span",{class:"text-2xl font-bold tracking-tight text-gray-300 animate-pulse"},"Order #",-1),_o={key:1,class:"flex items-center"},fo={key:0,class:"flex space-x-1 items-center"},go=e("span",null,"Created:",-1),yo={class:"font-bold"},wo={class:"relative",action:"#",method:"POST"},xo={class:"flex items-center space-x-2"},ko=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})],-1),bo={class:"grid grid-cols-12 gap-4 mb-8"},vo={class:"col-span-8"},Po={class:"bg-white shadow-lg rounded-lg border space-y-4 p-4 mb-4"},So={class:"flex items-center justify-between"},Oo={class:"w-full flex items-center space-x-2"},To=e("span",{class:"text-xs"},"Status:",-1),Mo={class:"w-full flex items-center space-x-2"},Co=e("span",{class:"text-xs"},"Payment Status:",-1),Lo={class:"flex items-center"},Ao=e("span",null,[e("svg",{class:"w-4 h-4 mr-2 inline-block",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.05 4.575a1.575 1.575 0 1 0-3.15 0v3m3.15-3v-1.5a1.575 1.575 0 0 1 3.15 0v1.5m-3.15 0 .075 5.925m3.075.75V4.575m0 0a1.575 1.575 0 0 1 3.15 0V15M6.9 7.575a1.575 1.575 0 1 0-3.15 0v8.175a6.75 6.75 0 0 0 6.75 6.75h2.018a5.25 5.25 0 0 0 3.712-1.538l1.732-1.732a5.25 5.25 0 0 0 1.538-3.712l.003-2.024a.668.668 0 0 1 .198-.471 1.575 1.575 0 1 0-2.228-2.228 3.818 3.818 0 0 0-1.12 2.687M6.9 7.575V12m6.27 4.318A4.49 4.49 0 0 1 16.35 15m.002 0h-.002"})]),e("span",{class:"mr-1"},"Cancellation Reason:")],-1),Bo={class:"font-bold"},Vo={class:"flex justify-end space-x-2"},Do=e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 7.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"}),e("path",{"fill-rule":"evenodd",d:"M1.5 4.875C1.5 3.839 2.34 3 3.375 3h17.25c1.035 0 1.875.84 1.875 1.875v9.75c0 1.036-.84 1.875-1.875 1.875H3.375A1.875 1.875 0 0 1 1.5 14.625v-9.75ZM8.25 9.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM18.75 9a.75.75 0 0 0-.75.75v.008c0 .414.336.75.75.75h.008a.75.75 0 0 0 .75-.75V9.75a.75.75 0 0 0-.75-.75h-.008ZM4.5 9.75A.75.75 0 0 1 5.25 9h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H5.25a.75.75 0 0 1-.75-.75V9.75Z","clip-rule":"evenodd"}),e("path",{d:"M2.25 18a.75.75 0 0 0 0 1.5c5.4 0 10.63.722 15.6 2.075 1.19.324 2.4-.558 2.4-1.82V18.75a.75.75 0 0 0-.75-.75H2.25Z"})],-1),Eo=e("span",null,"Mark As Paid",-1),Uo=e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 7.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"}),e("path",{"fill-rule":"evenodd",d:"M1.5 4.875C1.5 3.839 2.34 3 3.375 3h17.25c1.035 0 1.875.84 1.875 1.875v9.75c0 1.036-.84 1.875-1.875 1.875H3.375A1.875 1.875 0 0 1 1.5 14.625v-9.75ZM8.25 9.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM18.75 9a.75.75 0 0 0-.75.75v.008c0 .414.336.75.75.75h.008a.75.75 0 0 0 .75-.75V9.75a.75.75 0 0 0-.75-.75h-.008ZM4.5 9.75A.75.75 0 0 1 5.25 9h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H5.25a.75.75 0 0 1-.75-.75V9.75Z","clip-rule":"evenodd"}),e("path",{d:"M2.25 18a.75.75 0 0 0 0 1.5c5.4 0 10.63.722 15.6 2.075 1.19.324 2.4-.558 2.4-1.82V18.75a.75.75 0 0 0-.75-.75H2.25Z"})],-1),Io=e("span",null,"Mark As Paid",-1),No=e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4.5 3.75a3 3 0 0 0-3 3v.75h21v-.75a3 3 0 0 0-3-3h-15Z"}),e("path",{"fill-rule":"evenodd",d:"M22.5 9.75h-21v7.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3v-7.5Zm-18 3.75a.75.75 0 0 1 .75-.75h6a.75.75 0 0 1 0 1.5h-6a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 0-1.5h-3Z","clip-rule":"evenodd"})],-1),Fo=e("span",null,"Request Payment",-1),Ro=e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4.5 3.75a3 3 0 0 0-3 3v.75h21v-.75a3 3 0 0 0-3-3h-15Z"}),e("path",{"fill-rule":"evenodd",d:"M22.5 9.75h-21v7.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3v-7.5Zm-18 3.75a.75.75 0 0 1 .75-.75h6a.75.75 0 0 1 0 1.5h-6a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 0-1.5h-3Z","clip-rule":"evenodd"})],-1),qo=e("span",null,"Request Payment",-1),Ho={class:"col-span-4 space-y-4"},Zo={class:"flex flex-col justify-between bg-white shadow-lg rounded-lg border p-4"},jo={class:"space-y-4"},Wo=e("p",{class:"font-bold text-lg mb-4"},"Change Status",-1),zo={key:0},Yo={class:"flex space-x-2"},Jo={key:1},Go={class:"flex items-center whitespace-pre"},Qo=e("span",null,"Do you want to permanently delete",-1),Ko={key:1,class:"font-bold text-black"},Xo=e("span",null,"? Once this order is deleted you will not be able to recover it.",-1),$o={class:"flex justify-end"},er=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1),tr={class:"mb-8"},sr={class:"font-bold text-black"},or={class:"text-lg border-b border-dashed pb-4 mb-4"},rr={class:"font-bold"},ir={class:"mb-4"},nr=e("div",{class:"border-b border-dashed"},null,-1),ar=e("option",null,null,-1),lr=["value"],dr=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Request Payment",-1),cr=e("span",{class:"font-bold"},"Direct Pay Online",-1),hr=e("span",{class:"font-bold"},"Orange Money",-1),ur={class:"space-y-4 mb-4"},mr=["value"],pr=["value"],_r=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Mark As Paid",-1),fr={class:"space-y-4 mb-4"},gr=["value"],yr=["value"];function wr(s,a,r,S,o,d){const w=h("BackButton"),f=h("LineSkeleton"),x=h("ShineEffect"),M=h("TextHeader"),b=h("MoreInfoPopover"),k=h("PrimaryButton"),T=h("Alert"),L=h("FormErrorMessages"),D=h("OrderStatus"),O=h("OrderPaymentStatus"),W=h("CartSummary"),m=h("ButtonSkeleton"),C=h("PaymentSummary"),$=h("CustomerSummary"),z=h("CollectionSummary"),ee=h("BadgeIndicator"),H=h("ConfirmModal"),ne=h("OtpInput"),ae=h("TextareaInput"),E=h("SelectInput");return t(),i("div",null,[e("div",ho,[e("div",uo,[n(w,{class:"w-16 mr-4",action:d.goBack},null,8,["action"]),o.isLoadingOrder?(t(),i("div",mo,[po,n(x,{class:"flex space-x-2"},{default:l(()=>[n(f,{width:"w-12 mt-2"}),n(f,{width:"w-4 mt-2"})]),_:1})])):(t(),i("div",_o,[n(M,null,{default:l(()=>[y(c(d.isCreating?"Add Order":"Order #"+o.order._attributes.number),1)]),_:1}),n(b,{class:"ml-2 mt-1",title:"What Is This?",description:"Orders are requests placed by customers to purchase products or services from your store.",placement:"top"})]))]),d.isEditting?(t(),i("div",fo,[o.isLoadingOrder?(t(),p(x,{key:0,class:"flex space-x-2"},{default:l(()=>[n(f,{width:"w-20"}),n(f,{width:"w-32"}),n(f,{width:"w-4"})]),_:1})):(t(),i(g,{key:1},[go,e("span",yo,c(s.formattedDatetime(o.order.createdAt)),1),n(b,{title:s.formattedRelativeDate(o.order.createdAt),placement:"top"},null,8,["title"])],64))])):_("",!0)]),e("form",wo,[d.mustCreate||d.mustSaveChanges?(t(),p(T,{key:0,type:"warning",class:"flex justify-between items-center mb-2"},{default:l(()=>[e("div",xo,[ko,e("span",null,c(d.isCreating?"Create your order":"Please save your changes"),1)]),n(k,{action:d.isCreating?d.createOrder:d.updateOrder,loading:o.isSubmitting,class:"w-40"},{default:l(()=>[y(c(d.isCreating?"Create Order":"Save Changes"),1)]),_:1},8,["action","loading"])]),_:1})):_("",!0),e("div",bo,[e("div",vo,[n(L),e("div",Po,[e("div",So,[e("div",Oo,[To,o.isLoadingOrder?(t(),p(x,{key:0},{default:l(()=>[n(f,{width:"w-24"})]),_:1})):(t(),p(D,{key:1,order:o.order},null,8,["order"]))]),e("div",Mo,[Co,o.isLoadingOrder?(t(),p(x,{key:0},{default:l(()=>[n(f,{width:"w-24"})]),_:1})):(t(),p(O,{key:1,order:o.order},null,8,["order"]))])]),o.order&&o.order.cancellationReason?(t(),p(T,{key:0,type:"warning"},{default:l(()=>[e("div",Lo,[Ao,e("span",Bo,c(o.order.cancellationReason),1)])]),_:1})):_("",!0)]),n(W,{order:o.order,isLoadingOrder:o.isLoadingOrder},null,8,["order","isLoadingOrder"]),n(C,{order:o.order,isLoadingOrder:o.isLoadingOrder,refreshOrder:d.getOrder},{actionButtons:l(()=>[e("div",Vo,[d.isEditting&&o.isLoadingOrder?(t(),p(m,{key:0,size:"xs"},{default:l(()=>[Do,Eo]),_:1})):o.order&&d.canMarkAsPaid?(t(),p(k,{key:1,action:d.confirmMarkAsPaid,disabled:o.isMarkingAsPaid,loading:o.isMarkingAsPaid,type:d.canRequestPayment?"light":"success",size:"xs"},{default:l(()=>[Uo,Io]),_:1},8,["action","disabled","loading","type"])):_("",!0),d.isEditting&&o.isLoadingOrder?(t(),p(m,{key:2,size:"xs"},{default:l(()=>[No,Fo]),_:1})):o.order&&d.canRequestPayment?(t(),p(k,{key:3,action:d.confirmRequestPayment,disabled:o.isMarkingAsPaid,loading:o.isMarkingAsPaid,type:"success",size:"xs"},{default:l(()=>[Ro,qo]),_:1},8,["action","disabled","loading"])):_("",!0)])]),_:1},8,["order","isLoadingOrder","refreshOrder"])]),e("div",Ho,[n($,{order:o.order,isLoadingOrder:o.isLoadingOrder},null,8,["order","isLoadingOrder"]),n(z,{order:o.order,isLoadingOrder:o.isLoadingOrder,refreshOrder:d.getOrder},null,8,["order","isLoadingOrder","refreshOrder"]),e("div",Zo,[e("div",jo,[Wo,o.isLoadingOrder?(t(),i("div",zo,[n(x,{class:"space-y-4"},{default:l(()=>[e("div",Yo,[(t(),i(g,null,v(3,(u,P)=>n(f,{key:P})),64))]),n(f,{width:"w-32"})]),_:1})])):d.followUpStatuses.length>0?(t(),i("div",Jo,[n(ee,{showDot:!1,type:d.statusBadgeType,text:o.order.status.name,class:"border border-gray-500 mr-1"},null,8,["type","text"]),(t(!0),i(g,null,v(d.followUpStatuses,(u,P)=>(t(),p(ee,{type:"info",key:P,showDot:!1,clickable:!0,class:"mr-1",text:u.name,action:()=>d.confirmUpdateStatus(u)},null,8,["text","action"]))),128))])):_("",!0)])])])]),o.order?(t(),i("div",{key:1,class:Z(["space-y-4 shadow-lg rounded-lg border p-4",o.isLoadingOrder?"bg-gray-50":"border-red-300 bg-red-50"])},[e("div",Go,[Qo,o.isLoadingOrder?(t(),p(x,{key:0},{default:l(()=>[n(f,{width:"w-20 mx-2"})]),_:1})):(t(),i("span",Ko," Order #"+c(o.order._attributes.number),1)),Xo]),e("div",$o,[d.isEditting&&o.isLoadingOrder?(t(),p(m,{key:0},{default:l(()=>[y("Delete Order")]),_:1})):(t(),p(H,{key:1,approveText:"Delete Order",approveAction:d.deleteOrder,isLoading:o.isDeleting},{content:l(()=>[er,e("p",tr,[y("Are you sure you want to permanently delete "),e("span",sr,"Order #"+c(o.order._attributes.number),1),y("?")])]),trigger:l(u=>[n(k,{action:u.showModal,loading:o.isDeleting,class:"w-40",type:"danger"},{default:l(()=>[y(" Delete Order ")]),_:2},1032,["action","loading"])]),_:1},8,["approveAction","isLoading"]))])],2)):_("",!0),o.order&&o.followUpStatus?(t(),p(H,{key:2,declineText:"Cancel",declineType:"light",isLoading:o.isUpdatingOrderStatus,autoHide:!1,approveText:o.followUpStatus.name,approveType:"primary",approveAction:u=>d.updateOrderStatus(o.followUpStatus.name,u)},{content:l(()=>[e("p",or,[y("Mark As "),e("span",rr,c(o.followUpStatus.name),1)]),e("p",ir,c(o.followUpStatus.description),1),e("div",{class:Z({"mb-8 space-y-4":o.followUpStatus.name.toLowerCase()=="completed"||o.followUpStatus.name.toLowerCase()=="cancelled"})},[o.followUpStatus.name.toLowerCase()=="completed"&&!d.isVerified?(t(),i(g,{key:0},[n(T,null,{default:l(()=>[y(c(o.order._attributes.dialToShowCollectionCode.instruction),1)]),_:1}),n(ne,{modelValue:o.collectionCode,"onUpdate:modelValue":a[0]||(a[0]=u=>o.collectionCode=u),errorText:s.getFormError("collectionCode")},null,8,["modelValue","errorText"]),n(ae,{modelValue:o.collectionNote,"onUpdate:modelValue":a[1]||(a[1]=u=>o.collectionNote=u),label:"Note (Optional)",placeholder:"Collected by John Doe",rows:2,errorText:s.getFormError("collectionNote"),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Important note regarding this order collection e.g Collected by John Doe"},null,8,["modelValue","errorText"])],64)):o.followUpStatus.name.toLowerCase()=="cancelled"?(t(),i(g,{key:1},[nr,n(E,{width:"w-full",modelValue:o.cancellationReason,"onUpdate:modelValue":a[2]||(a[2]=u=>o.cancellationReason=u),labelPopoverTitle:"What Is This?",label:"Cancellation Reason (Optional)",errorText:s.getFormError("cancellationReason"),labelPopoverDescription:"A reason for why you are cancelling this order. This helps you keep a record for your cancelled orders"},{default:l(()=>[ar,(t(!0),i(g,null,v(o.cancellationReasons,(u,P)=>(t(),i("option",{value:u,key:P},c(u),9,lr))),128))]),_:1},8,["modelValue","errorText"])],64)):_("",!0)],2)]),trigger:l(u=>[n(k,{ref:"confirmUpdateOrderStatus",action:u.showModal,class:"hidden"},{default:l(()=>[y(c(o.followUpStatus.name),1)]),_:2},1032,["action"])]),_:1},8,["isLoading","approveText","approveAction"])):_("",!0),o.order?(t(),p(H,{key:3,approveText:"Yes",declineText:"No",autoHide:!1,isLoading:o.isRequestingPayment,approveType:"primary",approveAction:u=>d.requestPayment(u)},{content:l(()=>[e("div",null,[dr,n(T,{class:"mb-4"},{default:l(()=>[y("Request a payment for this order using "),cr,y(" or "),hr]),_:1}),e("div",ur,[n(E,{width:"w-full",label:"Payment Method",labelPopoverTitle:"What Is This?",modelValue:o._requestPayment.paymentMethodId,"onUpdate:modelValue":a[3]||(a[3]=u=>o._requestPayment.paymentMethodId=u),errorText:s.getFormError("paymentMethod"),labelPopoverDescription:"Select the payment method used to pay for this order e.g DPO (Direct Pay Online) or Orange Money"},{default:l(()=>[(t(!0),i(g,null,v(o._requestPayment.paymentMethods,(u,P)=>(t(),i("option",{value:u.id.toString(),key:P},c(u.name),9,mr))),128))]),_:1},8,["modelValue","errorText"]),n(E,{width:"w-full",label:"Amount",modelValue:o._requestPayment.percentage,"onUpdate:modelValue":a[4]||(a[4]=u=>o._requestPayment.percentage=u),labelPopoverTitle:"What Is This?",errorText:s.getFormError("percentage"),labelPopoverDescription:"Select the amonunt that has been paid"},{default:l(()=>[(t(!0),i(g,null,v(o.order._attributes.payableAmounts,(u,P)=>(t(),i("option",{value:u.percentage.toString(),key:P},c(u.name),9,pr))),128))]),_:1},8,["modelValue","errorText"])])])]),trigger:l(u=>[n(k,{ref:"confirmRequestPayment",action:u.showModal,class:"hidden"},{default:l(()=>[y(" Request Payment ")]),_:2},1032,["action"])]),_:1},8,["isLoading","approveAction"])):_("",!0),o.order?(t(),p(H,{key:4,approveText:"Yes",declineText:"No",autoHide:!1,isLoading:o.isMarkingAsPaid,approveType:"primary",approveAction:u=>d.markAsUnverifiedPayment(u)},{content:l(()=>[e("div",null,[_r,n(T,{class:"mb-4"},{default:l(()=>[y("Mark this order as paid if you received payment from the customer via cash, ewallet, card swipping or any other way")]),_:1}),e("div",fr,[n(E,{width:"w-full",label:"Amount",modelValue:o.markAsPaid.percentage,"onUpdate:modelValue":a[5]||(a[5]=u=>o.markAsPaid.percentage=u),labelPopoverTitle:"What Is This?",errorText:s.getFormError("percentage"),labelPopoverDescription:"Select the amonunt that has been paid"},{default:l(()=>[(t(!0),i(g,null,v(o.order._attributes.payableAmounts,(u,P)=>(t(),i("option",{value:u.percentage.toString(),key:P},c(u.name),9,gr))),128))]),_:1},8,["modelValue","errorText"]),n(E,{width:"w-full",label:"Payment Method",labelPopoverTitle:"What Is This?",modelValue:o.markAsPaid.paymentMethodId,"onUpdate:modelValue":a[6]||(a[6]=u=>o.markAsPaid.paymentMethodId=u),errorText:s.getFormError("paymentMethod"),labelPopoverDescription:"Select the payment method used to pay for this order e.g Cash"},{default:l(()=>[(t(!0),i(g,null,v(o.markAsPaid.paymentMethods,(u,P)=>(t(),i("option",{value:u.id.toString(),key:P},c(u.name),9,yr))),128))]),_:1},8,["modelValue","errorText"])])])]),trigger:l(u=>[n(k,{ref:"confirmMarkAsPaid",action:u.showModal,class:"hidden"},{default:l(()=>[y(" Mark As Paid ")]),_:2},1032,["action"])]),_:1},8,["isLoading","approveAction"])):_("",!0)])])}const ai=V(co,[["render",wr]]);export{ai as default};
