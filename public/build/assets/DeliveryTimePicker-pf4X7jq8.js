import{d as y}from"./debounce-DXQVMQyV.js";import{F as v}from"./FormMixin-6JkaGLLr.js";import{U as L,d as k}from"./form-store-C265_0LO.js";import{u as D,r as l,o,c as d,e as n,w as p,b as a,d as M,F as w,k as I,t as g}from"./app-jXH5QC3l.js";import{p as S}from"./api-repository--xE_j9dL.js";import{D as x}from"./Datepicker-B1KIg2S4.js";import{S as O}from"./ShineEffect-DfG5M4Ts.js";import{L as V}from"./LineSkeleton-3g5h70H3.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as _}from"./SelectInput-D7XUHB9M.js";const F={mixins:[v,L],components:{Datepicker:x,ShineEffect:O,LineSkeleton:V},props:{modelValue:{type:String},form:{type:Object},deliveryMethod:{type:Object}},emits:["isLoading","update:modelValue","scheduleOptions"],data(){return{minDate:null,maxDate:null,isLoading:!1,datesDisabled:[],apiRequestCounter:0,daysOfWeekDisabled:[],debounceInstance:null,apiState:D(),localModelValue:this.modelValue}},watch:{modelValue(e){this.updateValue(e)},localModelValue(e){this.$emit("update:modelValue",e)},...["scheduleType","dailyOrderLimit","sameDayDelivery","setDailyOrderLimit","timeSlotIntervalUnit","autoGenerateTimeSlots","timeSlotIntervalValue","latestDeliveryTimeValue","earliestDeliveryTimeUnit","earliestDeliveryTimeValue","requireMinimumNoticeForOrders","restrictMaximumNoticeForOrders"].reduce((e,t)=>(e[`form.${t}`]=function(){this.debouncedShowDeliveryMethodScheduleOptions()},e),{}),"form.operationalHours":{handler(){this.debouncedShowDeliveryMethodScheduleOptions()},deep:!0}},computed:{key(){return this.minDate+this.maxDate+this.datesDisabled.length+this.daysOfWeekDisabled.length}},methods:{updateValue(e){this.localModelValue=e},setIsLoading(e){this.isLoading=e,this.$emit("isLoading",e)},parseForm(){return{scheduleType:this.form?this.form.scheduleType:this.deliveryMethod.scheduleType,dailyOrderLimit:this.form?this.form.dailyOrderLimit:this.deliveryMethod.dailyOrderLimit,sameDayDelivery:this.form?this.form.sameDayDelivery:this.deliveryMethod.sameDayDelivery,operationalHours:this.form?this.form.operationalHours:this.deliveryMethod.operationalHours,setDailyOrderLimit:this.form?this.form.setDailyOrderLimit:this.deliveryMethod.setDailyOrderLimit,timeSlotIntervalUnit:this.form?this.form.timeSlotIntervalUnit:this.deliveryMethod.timeSlotIntervalUnit,autoGenerateTimeSlots:this.form?this.form.autoGenerateTimeSlots:this.deliveryMethod.autoGenerateTimeSlots,timeSlotIntervalValue:this.form?this.form.timeSlotIntervalValue:this.deliveryMethod.timeSlotIntervalValue,latestDeliveryTimeValue:this.form?this.form.latestDeliveryTimeValue:this.deliveryMethod.latestDeliveryTimeValue,earliestDeliveryTimeUnit:this.form?this.form.earliestDeliveryTimeUnit:this.deliveryMethod.earliestDeliveryTimeUnit,earliestDeliveryTimeValue:this.form?this.form.earliestDeliveryTimeValue:this.deliveryMethod.earliestDeliveryTimeValue,requireMinimumNoticeForOrders:this.form?this.form.requireMinimumNoticeForOrders:this.deliveryMethod.requireMinimumNoticeForOrders,restrictMaximumNoticeForOrders:this.form?this.form.restrictMaximumNoticeForOrders:this.deliveryMethod.restrictMaximumNoticeForOrders}},showDeliveryMethodScheduleOptions(){const e=++this.apiRequestCounter;S(this.apiState.apiHome._links.showDeliveryMethodScheduleOptions,this.parseForm()).then(t=>{if(e===this.apiRequestCounter){if(t.status==200){const s=t.data;this.minDate=this.formattedDate(s.minDate),this.daysOfWeekDisabled=s.daysOfWeekDisabled,this.datesDisabled=s.datesDisabled.map(h=>this.formattedDate(h)),this.maxDate=s.maxDate?this.formattedDate(s.maxDate):null,this.$emit("scheduleOptions",s)}this.setIsLoading(!1)}}).catch(t=>{this.setIsLoading(!1),this.setServerFormErrors(t)})},debouncedShowDeliveryMethodScheduleOptions(){this.debounceInstance&&this.debounceInstance.cancel(),this.setIsLoading(!0),this.debounceInstance=y(()=>{this.showDeliveryMethodScheduleOptions()},1e3),this.debounceInstance()}},created(){this.setIsLoading(!0),this.showDeliveryMethodScheduleOptions()}},U={class:"flex items-center space-x-2"};function N(e,t,s,h,i,f){const m=l("LineSkeleton"),u=l("ShineEffect"),c=l("Datepicker");return o(),d("div",null,[i.isLoading?(o(),n(u,{key:0},{default:p(()=>[a("div",U,[t[1]||(t[1]=a("svg",{class:"w-4 h-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})],-1)),M(m,{width:"w-1/2"})])]),_:1})):(o(),n(c,{key:f.key,minDate:i.minDate,maxDate:i.maxDate,modelValue:i.localModelValue,"onUpdate:modelValue":t[0]||(t[0]=r=>i.localModelValue=r),datesDisabled:i.datesDisabled,daysOfWeekDisabled:i.daysOfWeekDisabled},null,8,["minDate","maxDate","modelValue","datesDisabled","daysOfWeekDisabled"]))])}const z=b(F,[["render",N]]),q={mixins:[v],components:{SelectInput:_,ShineEffect:O,LineSkeleton:V},props:{modelValue:{type:String},form:{type:Object},deliveryMethod:{type:Object},deliveryDate:{type:String}},emits:["isLoading","update:modelValue","scheduleOptions"],data(){return{isLoading:!1,apiRequestCounter:0,debounceInstance:null,apiState:D(),availableTimeSlots:null,localModelValue:this.modelValue}},watch:{modelValue(e){this.updateValue(e)},localModelValue(e){this.$emit("update:modelValue",e)},deliveryDate(e){e&&this.debouncedShowDeliveryMethodScheduleOptions()}},methods:{updateValue(e){this.localModelValue=e},setIsLoading(e){this.isLoading=e,this.$emit("isLoading",e)},parseForm(){return{deliveryDate:k(this.deliveryDate).format("YYYY-MM-DD"),scheduleType:this.form?this.form.scheduleType:this.deliveryMethod.scheduleType,dailyOrderLimit:this.form?this.form.dailyOrderLimit:this.deliveryMethod.dailyOrderLimit,sameDayDelivery:this.form?this.form.sameDayDelivery:this.deliveryMethod.sameDayDelivery,operationalHours:this.form?this.form.operationalHours:this.deliveryMethod.operationalHours,setDailyOrderLimit:this.form?this.form.setDailyOrderLimit:this.deliveryMethod.setDailyOrderLimit,timeSlotIntervalUnit:this.form?this.form.timeSlotIntervalUnit:this.deliveryMethod.timeSlotIntervalUnit,autoGenerateTimeSlots:this.form?this.form.autoGenerateTimeSlots:this.deliveryMethod.autoGenerateTimeSlots,timeSlotIntervalValue:this.form?this.form.timeSlotIntervalValue:this.deliveryMethod.timeSlotIntervalValue,latestDeliveryTimeValue:this.form?this.form.latestDeliveryTimeValue:this.deliveryMethod.latestDeliveryTimeValue,earliestDeliveryTimeUnit:this.form?this.form.earliestDeliveryTimeUnit:this.deliveryMethod.earliestDeliveryTimeUnit,earliestDeliveryTimeValue:this.form?this.form.earliestDeliveryTimeValue:this.deliveryMethod.earliestDeliveryTimeValue,requireMinimumNoticeForOrders:this.form?this.form.requireMinimumNoticeForOrders:this.deliveryMethod.requireMinimumNoticeForOrders,restrictMaximumNoticeForOrders:this.form?this.form.restrictMaximumNoticeForOrders:this.deliveryMethod.restrictMaximumNoticeForOrders}},showDeliveryMethodScheduleOptions(){const e=++this.apiRequestCounter;S(this.apiState.apiHome._links.showDeliveryMethodScheduleOptions,this.parseForm()).then(t=>{if(e===this.apiRequestCounter){if(t.status==200){const s=t.data;this.availableTimeSlots=s.availableTimeSlots,this.availableTimeSlots.length&&(this.localModelValue=this.availableTimeSlots[0]),this.$emit("scheduleOptions",s)}this.setIsLoading(!1)}}).catch(t=>{this.setIsLoading(!1),this.setServerFormErrors(t)})},debouncedShowDeliveryMethodScheduleOptions(){this.debounceInstance&&this.debounceInstance.cancel(),this.setIsLoading(!0),this.availableTimeSlots=[],this.debounceInstance=y(()=>{this.showDeliveryMethodScheduleOptions()},1e3),this.debounceInstance()},debouncedShowDeliveryMethodScheduleOptions:function(){this.setIsLoading(!0),this.availableTimeSlots=[],y((function(){this.showDeliveryMethodScheduleOptions()}).bind(this),1e3)()}},created(){this.setIsLoading(!0),this.showDeliveryMethodScheduleOptions()}},C={class:"flex items-center space-x-2"},H=["value"];function E(e,t,s,h,i,f){const m=l("LineSkeleton"),u=l("ShineEffect"),c=l("SelectInput");return o(),d("div",null,[i.isLoading?(o(),n(u,{key:0},{default:p(()=>[a("div",C,[t[1]||(t[1]=a("svg",{class:"w-4 h-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1)),M(m,{width:"w-1/2"})])]),_:1})):(o(),n(c,{key:1,width:"w-full",modelValue:i.localModelValue,"onUpdate:modelValue":t[0]||(t[0]=r=>i.localModelValue=r)},{default:p(()=>[(o(!0),d(w,null,I(i.availableTimeSlots,(r,T)=>(o(),d("option",{key:T,value:r},g(r),9,H))),128))]),_:1},8,["modelValue"]))])}const J=b(q,[["render",E]]);export{z as D,J as a};
