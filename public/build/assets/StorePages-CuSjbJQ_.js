import{F as D}from"./FormMixin-CULzALzX.js";import{u as I,c as i,b as t,F as c,e as m,w as d,f as p,k as b,d as g,r as n,o as s,n as V,t as k,m as v,h as x}from"./app-BoGXsv54.js";import{V as T}from"./vue-draggable-next.esm-bundler-BIOBP9p-.js";import{u as M}from"./store-store-D6KBR7nZ.js";import{A as N}from"./AddButton-CsMQc9aT.js";import{S as j}from"./SearchInput-oKDF-Tqv.js";import{C as E}from"./ConfirmModal-BGWNF6pf.js";import{S as F}from"./ShineEffect-D65G_ZGD.js";import{L as H}from"./LineSkeleton-Ccwgk_3w.js";import{P as U}from"./PrimaryButton-H3KL-bqb.js";import{S as z}from"./SpinningLoader-BEnaF0ac.js";import{B as Z}from"./ButtonSkeleton-DLZzv2KY.js";import{B as O}from"./BadgeIndicator-DlVYZEkg.js";import{g as q,p as G,d as J}from"./api-repository-bdlVH5Lr.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-store-CuTEKvPg.js";import"./UtilsMixin-CBwmyCNB.js";import"./cloneDeep-BSUglKOW.js";import"./index-D19FfSVG.js";import"./TextInput-CYwxZsJZ.js";import"./InputErrorMessage-BzaNbvNM.js";import"./MoreInfoPopover-DUIgEZ-J.js";import"./Button-DeRn3xZE.js";const Q={mixins:[D],components:{draggable:T,AddButton:N,SearchInput:j,ConfirmModal:E,ShineEffect:F,SpinningLoader:z,LineSkeleton:H,PrimaryButton:U,ButtonSkeleton:Z,BadgeIndicator:O},props:{form:{type:Object}},data(){return{pages:[],searchTerm:"",deletablePage:null,isDeletingPageIds:[],isLoadingPages:!1,apiState:I(),storeState:M(),isUpdatingPageArrangement:!1}},watch:{searchTerm(r,e){this.showPages()}},computed:{store(){return this.storeState.store},isSearching(){return this.hasSearchTerm&&this.isLoadingPages},hasSearchTerm(){return this.searchTerm.length>0},hasPages(){return this.pages.length>0}},methods:{onViewPage(r){this.$router.push({name:"show-store-page",params:{page_href:r._links.showPage}}).then(()=>{window.scrollTo(0,0)})},onAddPage(){this.$router.push({name:"create-store-page",params:{store_href:this.store._links.showStore}})},showDeleteConfirmationModal(r){this.deletablePage=r,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(r){return this.isDeletingPageIds.findIndex(e=>e==r.id)!=-1},showPages(){this.isLoadingPages=!0;const r={storeId:this.store.id};this.searchTerm&&(r.search=this.searchTerm),q(this.store._links.showStorePages,r).then(e=>{e.status==200&&(this.pagination=e.data,this.pages=this.pagination.data),this.isLoadingPages=!1}).catch(e=>{this.isLoadingPages=!1,this.setServerFormErrors(e)})},updatePageArrangement(){this.isUpdatingPageArrangement=!0;const r={storeId:this.store.id,pageIds:this.pages.map(e=>e.id)};G(this.apiState.apiHome._links.updatePageArrangement,r).then(e=>{e.status==200&&(e.data.updated?this.showSuccessfulNotification("Page arrangement updated"):(this.setFormError("general",e.data.message),this.showUnsuccessfulNotification(e.data.message))),this.isUpdatingPageArrangement=!1}).catch(e=>{this.isUpdatingPageArrangement=!1,this.setServerFormErrors(e)})},deletePage(r){this.isDeletingPageIds.push(this.deletablePage.id),J(this.deletablePage._links.deletePage).then(e=>{r(),this.isDeletingPageIds.splice(this.isDeletingPageIds.findIndex(h=>h==this.deletePage.id,1)),e.status==200&&(e.data.deleted?(this.showSuccessfulNotification("Page deleted"),this.isDeletingPageIds.length==0&&this.showPages()):(this.setFormError("general",e.data.message),this.showUnsuccessfulNotification(e.data.message)))}).catch(e=>{this.isDeletingPageIds.splice(this.isDeletingPageIds.findIndex(h=>h==this.deletePage.id,1)),this.setServerFormErrors(e)})}},created(){this.showPages()}},R={class:"bg-white shadow-lg border p-6 mt-6 rounded-lg"},W={class:"flex justify-between items-center mb-4"},X={class:"space-y-4"},Y={key:1,class:"space-y-2"},$=["onClick"],ee={class:"w-full flex items-center justify-between"},te={key:0,class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},se={key:1,class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},ae={class:"text-sm font-semibold"},oe={class:"flex items-center space-x-2"},re=["onClick"],ie={key:0},ne={class:"flex items-center space-x-8 p-8 border rounded-lg bg-gray-50"},le={class:"space-y-4"},de={key:0,class:"text-sm font-bold"},ge={key:1,class:"space-y-1"},me={class:"mb-8"},he={class:"font-bold text-black"};function ce(r,e,h,pe,l,o){const _=n("ButtonSkeleton"),f=n("ShineEffect"),y=n("AddButton"),S=n("SearchInput"),w=n("LineSkeleton"),P=n("BadgeIndicator"),A=n("SpinningLoader"),B=n("draggable"),L=n("PrimaryButton"),C=n("ConfirmModal");return s(),i("div",R,[t("div",W,[e[5]||(e[5]=t("h1",{class:"flex items-center text-lg font-bold mb-2"},[t("svg",{class:"w-6 h-6 mr-2 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})]),t("span",null,"Pages")],-1)),o.hasSearchTerm||o.hasPages?(s(),i(c,{key:0},[l.isLoadingPages?(s(),m(f,{key:0},{default:d(()=>[g(_,{class:"w-40",size:"sm"},{default:d(()=>e[3]||(e[3]=[t("span",{class:"leading-none text-sm"},"ï¼‹",-1),t("span",{class:"ml-2"},"Add Page",-1)])),_:1})]),_:1})):(s(),m(y,{key:1,action:()=>o.onAddPage(),class:"w-40",size:"sm"},{default:d(()=>e[4]||(e[4]=[t("span",{class:"ml-2"},"Add Page",-1)])),_:1},8,["action"]))],64)):p("",!0)]),t("div",X,[o.hasSearchTerm||o.hasPages?(s(),m(S,{key:0,modelValue:l.searchTerm,"onUpdate:modelValue":e[0]||(e[0]=a=>l.searchTerm=a),isSearching:o.isSearching,class:"md:max-w-80"},null,8,["modelValue","isSearching"])):p("",!0),l.isLoadingPages?(s(),i("div",Y,[(s(),i(c,null,b([1,2,3],(a,u)=>t("div",{key:u,class:"border shadow-sm rounded-lg p-4 bg-gray-50"},[g(f,{class:"w-full flex items-center justify-between"},{default:d(()=>[g(w,{width:"w-32"}),g(w,{width:"w-16"})]),_:1})])),64))])):(s(),i(c,{key:2},[g(B,{modelValue:l.pages,"onUpdate:modelValue":e[2]||(e[2]=a=>l.pages=a),class:"space-y-2",handle:".draggable-handle","ghost-class":"bg-yellow-50",onChange:o.updatePageArrangement},{default:d(()=>[(s(!0),i(c,null,b(l.pages,(a,u)=>(s(),i("div",{key:u,onClick:()=>o.onViewPage(a),class:"flex items-center justify-between space-x-4 border shadow-sm rounded-lg p-4 bg-gray-50 cursor-pointer hover:border-blue-200 hover:bg-blue-50 group"},[t("div",ee,[t("div",{class:V(["flex items-center space-x-2",{"text-blue-500":a.homepage}])},[a.homepage?(s(),i("svg",te,e[6]||(e[6]=[t("path",{d:"M11.47 3.841a.75.75 0 0 1 1.06 0l8.69 8.69a.75.75 0 1 0 1.06-1.061l-8.689-8.69a2.25 2.25 0 0 0-3.182 0l-8.69 8.69a.75.75 0 1 0 1.061 1.06l8.69-8.689Z"},null,-1),t("path",{d:"m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 0 1-.75-.75v-4.5a.75.75 0 0 0-.75-.75h-3a.75.75 0 0 0-.75.75V21a.75.75 0 0 1-.75.75H5.625a1.875 1.875 0 0 1-1.875-1.875v-6.198a2.29 2.29 0 0 0 .091-.086L12 5.432Z"},null,-1)]))):(s(),i("svg",se,e[7]||(e[7]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"},null,-1)]))),t("h1",ae,k(a.title),1)],2),t("div",oe,[g(P,{type:a.visible?"success":"warning",text:a.visible?"visible":"hidden",showDot:!1},null,8,["type","text"])])]),o.isDeleting(a)?(s(),m(A,{key:0,type:"danger"},{default:d(()=>e[8]||(e[8]=[t("span",{class:"text-xs ml-2"},"Deleting...",-1)])),_:1})):(s(),i("svg",{key:1,onClick:v(ue=>o.showDeleteConfirmationModal(a),["stop","prevent"]),class:"w-4 h-4 cursor-pointer hover:text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},e[9]||(e[9]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"},null,-1)]),8,re)),(s(),i("svg",{onClick:e[1]||(e[1]=v(()=>{},["stop"])),class:"draggable-handle w-4 h-4 cursor-grab hover:text-yellow-500 visible:cursor-grabbing",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},e[10]||(e[10]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"},null,-1)])))],8,$))),128))]),_:1},8,["modelValue","onChange"]),o.hasPages?p("",!0):(s(),i("div",ie,[t("div",ne,[e[12]||(e[12]=t("span",{class:"text-9xl"},"ðŸŽ¨",-1)),t("div",le,[o.hasSearchTerm?(s(),i("p",de,"No pages found.")):(s(),i("div",ge,e[11]||(e[11]=[t("p",{class:"text-2xl font-bold"},"Pages help build your shop",-1),t("p",{class:"text-sm"},"Home, about us, terms and conditions and more are created using pages",-1)]))),g(P,{type:"primary",text:"+ Add Page",size:"px-8 py-2",showDot:!1,clickable:!0,action:()=>o.onAddPage()},null,8,["action"])])])]))],64)),l.deletablePage?(s(),m(C,{key:3,approveText:"Delete",approveAction:a=>o.deletePage(a),isLoading:o.isDeleting(o.deletePage)},{content:d(()=>[e[15]||(e[15]=t("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),t("p",me,[e[13]||(e[13]=x("Are you sure you want to delete ")),t("span",he,k(l.deletablePage.name),1),e[14]||(e[14]=x("?"))])]),trigger:d(a=>[g(L,{ref:"confirmDeleteButton",action:a.showModal,class:"hidden",type:"danger"},null,8,["action"])]),_:1},8,["approveAction","isLoading"])):p("",!0)])])}const He=K(Q,[["render",ce]]);export{He as default};
