import{c as u,i as T}from"./cloneDeep-BSUglKOW.js";import{F as C}from"./FormMixin-RVJEmp-q.js";import{U as I}from"./UtilsMixin-CBwmyCNB.js";import{u as A,c as n,b as s,d as l,F as p,k,h as x,t as c,f as w,n as F,w as f,T as B,r as d,o as a,e as b}from"./app-Bi98IZzu.js";import{u as j}from"./store-store-b0L-GreJ.js";import{T as N}from"./TextInput-DyLPxbP7.js";import{S as U}from"./StoreLogo-BCPkHWyT.js";import{S as z}from"./ShineEffect-wPoPEvjg.js";import{L as H}from"./LineSkeleton-0f7iD8eX.js";import{P as Z}from"./PrimaryButton-C_jca9lM.js";import{g as P,a as R}from"./api-repository-MbCCQJsA.js";import{T as Y}from"./ToogleSwitch-BQ2RpUxp.js";import{F as q}from"./FormErrorMessages-C-sFANwV.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-store-C2My47xt.js";import"./InputErrorMessage-KPWvfl4x.js";import"./MoreInfoPopover-DWJ5yMDY.js";import"./SpinningLoader-Co5nY0L9.js";const W={mixins:[C,I],components:{TextInput:N,StoreLogo:U,ShineEffect:z,LineSkeleton:H,PrimaryButton:Z,ToogleSwitch:Y,FormErrorMessages:q},data(){return{socialLinks:[],socialMediaIcons:[],originalSocialLinks:[],apiState:A(),isSubmittingStore:!1,storeState:j(),isLoadingSocialMediaIcons:!1}},computed:{store(){return this.storeState.store},hasSelectedSocialLinks(){return this.socialLinks.some(e=>e.active)},totalSelectedSocialLinks(){return this.socialLinks.filter(e=>e.active).length},socialLinksHaveChanged(){var e=u(this.socialLinks),t=u(this.originalSocialLinks);return!T(e,t)},socialLinkValidationErrors(){return this.socialLinks.filter(e=>e.active).map(e=>{const t=new RegExp("^(https?:\\/\\/)?([a-zA-Z0-9-]+\\.)?[a-zA-Z0-9-]+\\.[a-zA-Z]{2,6}(:[0-9]{1,5})?(\\/[^\\s]*)?$");let o="";return e.link.trim()===""?o=`The ${e.name} link is required`:t.test(e.link.trim())||(o=`The ${e.name} link is incorrect`),o?{name:e.name,message:o}:null}).filter(e=>e!==null)},hasSocialLinkValidationErrors(){return this.socialLinkValidationErrors.length>0}},methods:{hasMatchingSocialLinkError(e){return this.socialLinkValidationErrors.some(t=>t.name==e)},getMatchingSocialLinkError(e){const t=this.socialLinkValidationErrors.find(o=>o.name==e);return t?t.message:null},getMatchingSocialMediaIcon(e){return this.socialMediaIcons.find(t=>t.name.toLowerCase()===e.toLowerCase())},showSocialMediaIcons(){this.socialMediaIcons.length||(this.isLoadingSocialMediaIcons=!0,P(this.apiState.apiHome._links.showSocialMediaIcons).then(e=>{e.status==200&&(this.socialMediaIcons=e.data,this.socialLinks=u(this.socialMediaIcons.map(t=>{const o=this.store.socialLinks.find(S=>S.name.toLowerCase()==t.name.toLowerCase());return o||{link:"",active:!1,name:t.name}})),this.originalSocialLinks=u(this.socialLinks)),this.isLoadingSocialMediaIcons=!1}).catch(e=>{this.isLoadingSocialMediaIcons=!1,this.setServerFormErrors(e)}))},updateStore(){this.isSubmittingStore=!0;const t={return:"1",socialLinks:this.socialLinks.filter(o=>o.link!=null&&o.link.trim()!="")};R(this.store._links.updateStore,t).then(o=>{o.status==200&&o.data.updated==!0?(this.showSuccessfulNotification("Social links updated"),this.originalSocialLinks=u(this.socialLinks),this.storeState.setStore(o.data.store),this.navigateToAddAdvancedFeatures()):(this.showUnsuccessfulNotification(o.data.message??"Social link update failed"),useNotificationState().addWarningNotification(o.data.message)),this.isSubmittingStore=!1}).catch(o=>{this.isSubmittingStore=!1,this.setServerFormErrors(o)})},navigateToAddAdvancedFeatures(){this.$router.push({name:"advanced-features",params:{store_href:this.store._links.showStore}})}},beforeRouteLeave(e,t,o){if((this.isSubmittingStore||this.socialLinksHaveChanged)&&!window.confirm("You have unsaved changes. Are you sure you want to leave?"))return o(!1);o()},created(){this.showSocialMediaIcons()}},G={class:"min-h-screen flex flex-col items-center pt-20 pb-40"},J={class:"w-full max-w-lg"},K={class:"w-full max-w-lg"},O={class:"mb-4"},Q={key:0,class:"space-y-2"},X={key:1,class:"space-y-3 mb-4"},$={class:"flex justify-between items-center"},ee={class:"flex items-center space-x-2 font-bold"},te={class:"w-8 h-8 rounded-full overflow-hidden flex items-center justify-center"},se=["src"],oe={class:"text-sm"},ie={key:0,class:"w-full mt-4"},ae={key:0,class:"flex space-x-1 text-xs text-yellow-600 font-semibold bg-yellow-100 border border-yellow-300 p-3 rounded-lg shadow-md mt-2"},re={key:0,class:"list-disc text-xs text-yellow-600 bg-yellow-100 border border-yellow-300 py-3 px-4 rounded-lg shadow-md mb-4"},ne={class:"space-y-1"},le={key:1,class:"text-blue-600 bg-blue-100 border border-blue-300 p-3 rounded-lg shadow-md mb-4"},ce={class:"flex items-center space-x-2"},de={key:0,class:"text-sm font-semibold"},me={class:"font-bold"},ue={class:"flex justify-end"};function he(e,t,o,S,h,i){const L=d("StoreLogo"),v=d("LineSkeleton"),y=d("ShineEffect"),M=d("ToogleSwitch"),E=d("TextInput"),V=d("FormErrorMessages"),_=d("PrimaryButton");return a(),n("div",G,[s("div",J,[l(L,{showButton:!1,class:"flex justify-center mb-4"}),t[0]||(t[0]=s("h2",{class:"text-2xl font-semibold text-center mb-2"},"Connect Your Socials",-1)),t[1]||(t[1]=s("p",{class:"text-gray-500 text-center mb-6"},"Make it easy for customers to find and follow you",-1))]),s("div",K,[s("div",O,[h.isLoadingSocialMediaIcons?(a(),n("div",Q,[(a(),n(p,null,k([1,2,3],(r,m)=>s("div",{key:m,class:"border shadow-sm rounded-lg p-4 bg-gray-50"},[l(y,{class:"w-full flex items-center space-x-2"},{default:f(()=>[l(v,{width:"w-8"}),l(v,{width:"w-40"})]),_:1})])),64))])):(a(),n("div",X,[(a(!0),n(p,null,k(h.socialLinks,(r,m)=>(a(),n("div",{key:m,class:"bg-white p-4 shadow-sm rounded-xl transition-all duration-300 border border-transparent hover:border-gray-300 hover:shadow-lg cursor-pointer"},[s("div",$,[s("div",ee,[s("div",te,[s("img",{alt:"Social Media Logo",class:"h-full object-contain",src:i.getMatchingSocialMediaIcon(r.name).icon.toLowerCase()},null,8,se)]),s("span",oe,c(r.name),1)]),l(M,{size:"md",modelValue:r.active,"onUpdate:modelValue":g=>r.active=g},null,8,["modelValue","onUpdate:modelValue"])]),r.active?(a(),n("div",ie,[l(E,{placeholder:"https://",modelValue:r.link,"onUpdate:modelValue":g=>r.link=g,label:`${e.capitalize(r.name)} link`,errorText:e.getFormError("socialLinks"+m+"Link")},null,8,["modelValue","onUpdate:modelValue","label","errorText"]),i.hasMatchingSocialLinkError(r.name)?(a(),n("p",ae,[t[2]||(t[2]=s("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})],-1)),s("span",null,c(i.getMatchingSocialLinkError(r.name)),1)])):w("",!0)])):w("",!0)]))),128))]))]),i.hasSocialLinkValidationErrors?(a(),n("div",re,[t[3]||(t[3]=s("p",{class:"text-lg font-semibold mb-2"},"Resolve these to continue",-1)),s("ul",ne,[(a(!0),n(p,null,k(i.socialLinkValidationErrors,(r,m)=>(a(),n("li",{key:m},c(r.message),1))),128))])])):(a(),n("div",le,[s("div",ce,[t[4]||(t[4]=s("svg",{class:"w-8 h-8",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25"})],-1)),s("div",null,[i.hasSelectedSocialLinks?(a(),n("p",de,[x(c(i.store.name)+" supports ",1),s("span",me,c(i.totalSelectedSocialLinks)+" "+c(i.totalSelectedSocialLinks==1?"social platform":"social platforms"),1)])):w("",!0),s("p",{class:F([i.hasSelectedSocialLinks?"text-xs":"text-sm font-semibold"])},"You can always "+c(i.hasSelectedSocialLinks?"add more":"add")+" social links later! ðŸ˜Š",3)])])])),l(V,{class:"mb-4"}),s("div",ue,[l(B,{name:"fade-1",mode:"out-in"},{default:f(()=>[i.socialLinksHaveChanged||i.hasSelectedSocialLinks?(a(),b(_,{key:0,class:"w-full",action:i.updateStore,loading:h.isSubmittingStore,disabled:h.isSubmittingStore||i.hasSocialLinkValidationErrors},{default:f(()=>t[5]||(t[5]=[x(" Continue ")])),_:1},8,["action","loading","disabled"])):(a(),b(_,{key:1,type:"light",class:"w-40",action:i.navigateToAddAdvancedFeatures},{default:f(()=>t[6]||(t[6]=[s("span",null,"Skip",-1),s("svg",{class:"w-4 h-4 ml-1",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"})],-1)])),_:1},8,["action"]))]),_:1})])])])}const Ae=D(W,[["render",he]]);export{Ae as default};
