import{u as M,s as U,x as A,c as l,b as e,d as p,w as c,r as u,o as i,h as v,q as m,Y as y,t as n,e as x,F,k as w,m as b}from"./app-BoGXsv54.js";import{U as D}from"./UtilsMixin-CBwmyCNB.js";import{T as V}from"./TextHeader-DSSmQ7LM.js";import{B as C}from"./BasicTable-CB82VRf8.js";import{E}from"./ExternalLink-CaKwYS7z.js";import{D as O}from"./Datepicker-DvZEwFoU.js";import{M as N}from"./MoreInfoPopover-DUIgEZ-J.js";import{g as H}from"./api-repository-bdlVH5Lr.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SearchInput-oKDF-Tqv.js";import"./index-D19FfSVG.js";import"./TextInput-CYwxZsJZ.js";import"./InputErrorMessage-BzaNbvNM.js";import"./SpinningLoader-BEnaF0ac.js";const q=()=>M().apiHome._links;async function R(a=null,t={}){return await H(a??q().showTransactions,t)}const I={mixins:[D],components:{TextHeader:V,BasicTable:C,ExternalLink:E,Datepicker:O,MoreInfoPopover:N},data(){return{url:null,searchTerm:null,pagination:null,isFetching:!1,transactions:[],appName:U.appName,tableHeaders:["For","Description","Payment Status","Amount","Percentage","Payment Method","Paid By","Verified By","Requested By","DPO Payment Link","DPO Link Status","DPO Expiry Date","Created Date",""],paymentStatusFilter:"all",verifiedByFilter:"all",paymentMethodFilter:"all",dateNameFilter:null,dateValueFilter:null,dateOperationFilter:null,filters:[]}},methods:{onView(a){console.log("view:"+a.name)},onEdit(a){console.log("edit:"+a.name)},onDelete(a){console.log("delete:"+a.name)},paginate(a){this.url=a,this._getTransactions()},search(a){this.url=null,this.searchTerm=a,this._getTransactions()},addOrUpdateFilter(a){var t="";this.dateOperationFilter=="gte"?t=">=":this.dateOperationFilter=="lte"?t="<=":this.dateOperationFilter=="gt"?t=">":this.dateOperationFilter=="lt"?t="<":this.dateOperationFilter=="e"&&(t="="),this.filters=this.filters.filter(_=>_.name!==this.dateNameFilter);const d={name:this.dateNameFilter,value:this.dateValueFilter,operation:this.dateOperationFilter,displayName:this.dateNameFilter+" "+t+" "+this.dateValueFilter};a==null?this.filters.push(d):this.filters[a]=d,this._getTransactions()},showSelectedFilter(a){this.dateNameFilter=a.name,this.dateValueFilter=a.value,this.dateOperationFilter=a.operation},resetAddFilterModal(){this.dateNameFilter="startAt",this.dateOperationFilter="gte",this.dateValueFilter=this.formattedDate()},hideFilterModal(){this.resetAddFilterModal()},removeFilter(){this._getTransactions()},_getTransactions(){this.isFetching=!0;const a={with_paying_user:"1",search:this.searchTerm,with_payment_method:"1",with_verifying_user:"1",with_requesting_user:"1"};this.verifiedByFilter!="all"&&(a.verifiedBy=this.verifiedByFilter),this.paymentMethodFilter!="all"&&(a.paymentMethod=this.paymentMethodFilter),this.paymentStatusFilter!="all"&&(a.paymentStatus=this.paymentStatusFilter);for(let t=0;t<this.filters.length;t++){const d=this.filters[t];["startAt","endAt"].includes(d.name)&&(a[d.name]=d.operation+"-"+this.dateToTimestamp(d.value))}R(this.url,a).then(t=>{t.status==200&&(this.pagination=t.data,this.transactions=this.pagination.data),this.isFetching=!1}).catch(t=>{this.isFetching=!1})}},mounted(){A()},created(){this.resetAddFilterModal(),this._getTransactions()}},W={class:"px-16 pt-8"},G={class:"flex items-center border-dashed border-b py-6 mb-6"},Z={value:"system"},z={class:"lg:col-span-6 col-span-12"},Y={class:"lg:col-span-6 col-span-12"},j={class:"col-span-12"},J=["onClick"],K={class:"whitespace-nowrap px-4 py-4"},Q={class:"px-4 py-4"},X={class:"min-w-80"},$={class:"whitespace-nowrap px-4 py-4"},ee={class:"whitespace-nowrap px-4 py-4 text-center"},te={class:"whitespace-nowrap px-4 py-4 text-center"},re={class:"whitespace-nowrap px-4 py-4 text-center"},ae={class:"whitespace-nowrap px-4 py-4"},se={key:0},ie={key:1,class:"text-xs text-center text-gray-300"},oe={class:"text-xs text-center text-gray-300"},le={key:0,class:"whitespace-nowrap px-4 py-4"},ne={class:"whitespace-nowrap px-4 py-4"},de={key:0},pe={key:1,class:"text-xs text-center text-gray-300"},ce={class:"px-4 py-4"},ue={key:0,class:"max-w-80"},me={key:1,class:"text-xs text-center text-gray-300"},ye={class:"text-xs text-center text-gray-300"},he={key:0,class:"text-xs text-center text-gray-300"},ge={class:"whitespace-nowrap px-4 py-4"},fe={key:0,class:"flex space-x-1 items-center"},xe={key:1,class:"text-xs text-center text-gray-300"},be={class:"whitespace-nowrap px-4 py-4"},_e={class:"flex space-x-1 items-center"},ke={class:"opacity-0 group-hover:opacity-100 transition-opacity px-4 py-4 space-x-4"},ve=["onClick"],Fe=["onClick"];function we(a,t,d,_,s,o){const T=u("TextHeader"),h=u("MoreInfoPopover"),B=u("Datepicker"),g=u("BadgeIndicator"),P=u("ExternalLink"),S=u("BasicTable");return i(),l("div",W,[e("div",G,[p(T,null,{default:c(()=>t[9]||(t[9]=[v("Transactions")])),_:1}),p(h,{class:"ml-2 mt-1",title:"What Is This?",description:"Transactions are records of online and offline payments for goods and services whether initiated and verified by the "+s.appName+" system or users within the "+s.appName+" ecosystem",placement:"top"},null,8,["description"])]),p(S,{pagination:s.pagination,isLoading:s.isFetching,onPaginate:o.paginate,onSearch:o.search,onRefresh:o._getTransactions,showAddFilter:!0,filters:s.filters,onAddOrUpdateFilter:o.addOrUpdateFilter,onShowSelectedFilter:o.showSelectedFilter,onHideFilterModal:o.hideFilterModal,onRemoveFilter:o.removeFilter,totalHeaders:s.tableHeaders.length},{primaryFilters:c(()=>[m(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>s.paymentStatusFilter=r),onChange:t[1]||(t[1]=(...r)=>o._getTransactions&&o._getTransactions(...r)),id:"select-payment-status",class:"w-48 block p-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},t[10]||(t[10]=[e("option",{value:"all"},"Payment Status = All",-1),e("option",{value:"paid"},"Paid",-1),e("option",{value:"pending payment"},"Pending Payment",-1)]),544),[[y,s.paymentStatusFilter]]),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>s.verifiedByFilter=r),onChange:t[3]||(t[3]=(...r)=>o._getTransactions&&o._getTransactions(...r)),id:"select-verified-by",class:"w-40 block p-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},[t[11]||(t[11]=e("option",{value:"all"},"Verified By = All",-1)),e("option",Z,n(s.appName),1),t[12]||(t[12]=e("option",{value:"user"},"User",-1))],544),[[y,s.verifiedByFilter]]),m(e("select",{"onUpdate:modelValue":t[4]||(t[4]=r=>s.paymentMethodFilter=r),onChange:t[5]||(t[5]=(...r)=>o._getTransactions&&o._getTransactions(...r)),id:"select-verified",class:"w-48 block p-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},t[13]||(t[13]=[e("option",{value:"all"},"Payment Method = All",-1),e("option",{value:"Airtime"},"Airtime",-1),e("option",{value:"Ewallet"},"Ewallet",-1),e("option",{value:"Pay2Cell"},"Pay2Cell",-1),e("option",{value:"Orange Money"},"Orange Money",-1),e("option",{value:"MyZaka"},"MyZaka",-1),e("option",{value:"BTC Smega"},"BTC Smega",-1),e("option",{value:"Unayo"},"Unayo",-1),e("option",{value:"Credit/Debit Card"},"Credit/Debit Card",-1),e("option",{value:"Bank Transfer"},"Bank Transfer",-1)]),544),[[y,s.paymentMethodFilter]])]),modalFilters:c(()=>[e("div",z,[t[15]||(t[15]=e("label",{for:"select-filter",class:"block mb-2 text-xs font-medium text-gray-900 dark:text-white"},"Select Filter",-1)),m(e("select",{"onUpdate:modelValue":t[6]||(t[6]=r=>s.dateNameFilter=r),id:"select-filter",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},t[14]||(t[14]=[e("option",{value:"startAt"},"Start date",-1),e("option",{value:"endAt"},"End date",-1)]),512),[[y,s.dateNameFilter]])]),e("div",Y,[t[17]||(t[17]=e("label",{for:"select-filter-operation",class:"block mb-2 text-xs font-medium text-gray-900 dark:text-white"},"Select Operation",-1)),m(e("select",{"onUpdate:modelValue":t[7]||(t[7]=r=>s.dateOperationFilter=r),id:"select-filter-operation",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},t[16]||(t[16]=[e("option",{value:"gte"},"Greater or equal to",-1),e("option",{value:"lte"},"Less or equal to",-1),e("option",{value:"gt"},"Greater than",-1),e("option",{value:"lt"},"Less than",-1),e("option",{value:"e"},"Equal to",-1)]),512),[[y,s.dateOperationFilter]])]),e("div",j,[(i(),x(B,{modelValue:s.dateValueFilter,"onUpdate:modelValue":t[8]||(t[8]=r=>s.dateValueFilter=r),key:s.dateValueFilter},null,8,["modelValue"]))])]),head:c(()=>[e("tr",null,[(i(!0),l(F,null,w(s.tableHeaders,(r,f)=>(i(),l("th",{key:f,scope:"col",class:"whitespace-nowrap px-4 py-3"},n(r),1))),128))])]),body:c(()=>[(i(!0),l(F,null,w(s.transactions,(r,f)=>(i(),l("tr",{onClick:b(k=>o.onView(r),["stop"]),key:f,class:"group cursor-pointer bg-white hover:bg-gray-50 border-b"},[e("td",K,n(a.capitalizeAllWords(r.ownerType)),1),e("td",Q,[e("div",X,n(r.description),1)]),e("td",$,[p(g,{type:r.paymentStatus.name.toLowerCase()=="paid"?"success":"warning",text:r.paymentStatus.name},null,8,["type","text"])]),e("td",ee,n(r.amount.amountWithCurrency),1),e("td",te,n(r.percentage.valueSymbol),1),e("td",re,n(r._relationships.paymentMethod.name),1),e("td",ae,[r._relationships.paidByUser?(i(),l("span",se,n(r._relationships.paidByUser._attributes.name),1)):(i(),l("span",ie,"---"))]),e("td",oe,[r._relationships.verifiedByUser?(i(),l("span",le,n(r._relationships.verifiedByUser._attributes.name),1)):(i(),x(g,{key:1,type:"info",text:s.appName,showDot:!1},null,8,["text"]))]),e("td",ne,[r._relationships.requestedByUser?(i(),l("span",de,n(r._relationships.requestedByUser._attributes.name),1)):(i(),l("span",pe,"---"))]),e("td",ce,[r.dpoPaymentUrl?(i(),l("div",ue,[p(P,{url:r.dpoPaymentUrl,class:"text-xs"},{default:c(()=>[v(n(r.dpoPaymentUrl),1)]),_:2},1032,["url"])])):(i(),l("span",me,"---"))]),e("td",ye,[r._attributes.dpoPaymentLinkHasExpired==null?(i(),l("span",he,"---")):(i(),x(g,{key:1,type:r._attributes.dpoPaymentLinkHasExpired==!1?"success":"warning",text:r._attributes.dpoPaymentLinkHasExpired==!1?"Active":"Expired",showDot:!1},null,8,["type","text"]))]),e("td",ge,[r.dpoPaymentUrlExpiresAt?(i(),l("div",fe,[e("span",null,n(a.formattedDatetime(r.dpoPaymentUrlExpiresAt)),1),p(h,{class:"opacity-0 group-hover:opacity-100",title:a.formattedRelativeDate(r.dpoPaymentUrlExpiresAt),placement:"top"},null,8,["title"])])):(i(),l("span",xe,"---"))]),e("td",be,[e("div",_e,[e("span",null,n(a.formattedDatetime(r.createdAt)),1),p(h,{class:"opacity-0 group-hover:opacity-100",title:a.formattedRelativeDate(r.createdAt),placement:"top"},null,8,["title"])])]),e("td",ke,[e("a",{href:"#",onClick:b(k=>o.onEdit(r),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"Edit",8,ve),e("a",{href:"#",onClick:b(k=>o.onDelete(r),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,Fe)])],8,J))),128))]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","filters","onAddOrUpdateFilter","onShowSelectedFilter","onHideFilterModal","onRemoveFilter","totalHeaders"])])}const Le=L(I,[["render",we]]);export{Le as default};
