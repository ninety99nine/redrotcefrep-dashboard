import{P as k}from"./Pill-CNWbwQ3o.js";import{F as L}from"./FormMixin-6JkaGLLr.js";import{B as M}from"./Button-BeSnAT_x.js";import{U as C}from"./form-store-C265_0LO.js";import{u as B}from"./store-store-DI9g0YE3.js";import{B as I}from"./BasicTable-BENOl8OQ.js";import{C as T}from"./ConfirmModal-l78eHkJU.js";import{S as P}from"./SpinningLoader-BdvFuScB.js";import{M as N}from"./MoreInfoPopover-DuLCv7tU.js";import{g as F,d as A}from"./api-repository--xE_j9dL.js";import{N as H}from"./NoDataPlaceholder-BIIoZLQj.js";import{c as a,b as e,e as g,w as m,d as w,r as d,o as i,F as h,k as u,t as p,n as f,m as j,f as x}from"./app-jXH5QC3l.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ShineEffect-DfG5M4Ts.js";import"./cloneDeep-B1YGuKb7.js";import"./SearchInput-BxlZh9-p.js";import"./index-CHIj4cOM.js";import"./TextInput-CYg7QVrw.js";import"./InputErrorMessage-CbGsL3fL.js";import"./SelectInput-D7XUHB9M.js";import"./Drawer-CCLxMHft.js";import"./Checkbox-CA6moHBM.js";import"./MoneyInput-CQeRzHMh.js";import"./Datepicker-B1KIg2S4.js";import"./vue-draggable-next.esm-bundler-DxBVIkpx.js";import"./ToogleSwitch-D6TVHn6r.js";const U={mixins:[L,C],components:{Pill:k,Button:M,BasicTable:I,ConfirmModal:T,SpinningLoader:P,MoreInfoPopover:N,NoDataPlaceholder:H},data(){return{reviews:[],pagination:null,searchTerm:null,deletableReview:null,isLoadingReviews:!1,deleteReviewModal:null,isDeletingReviewIds:[],storeState:B(),tableHeaders:["Customer","Subject","Rating","Comment","Review Date",""]}},watch:{isLoadingStore(s){s||this.getReviews()}},computed:{store(){return this.storeState.store},isLoadingStore(){return this.storeState.isLoadingStore},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{showDeleteConfirmationModal(s){this.deletableReview=s,this.deleteReviewModal.showModal()},isDeleting(s){return this.isDeletingReviewIds.findIndex(t=>t==s.id)!=-1},paginate(s){this.getReviews(s)},search(s){this.searchTerm=s,this.getReviews()},getReviews(s=null){this.isLoadingReviews=!0;const t={_relationships:"user"};this.hasSearchTerm&&(t.search=this.searchTerm),s=s??this.store._links.showStoreReviews,F(s,t).then(c=>{c.status==200&&(this.pagination=c.data,this.reviews=this.pagination.data),this.isLoadingReviews=!1}).catch(c=>{this.isLoadingReviews=!1,this.setServerFormErrors(c)})},deleteReview(){this.isDeletingReviewIds.push(this.deletableReview.id),A(this.deletableReview._links.deleteReview).then(s=>{this.isDeletingReviewIds.splice(this.isDeletingReviewIds.findIndex(t=>t==this.deletableReview.id,1)),s.status==200&&(s.data.deleted?(this.showSuccessfulNotification("Review deleted"),this.isDeletingReviewIds.length==0&&this.getReviews()):(this.setFormError("general",s.data.message),this.showUnsuccessfulNotification(s.data.message)))}).catch(s=>{this.isDeletingReviewIds.splice(this.isDeletingReviewIds.findIndex(t=>t==this.deletableReview.id,1)),this.setServerFormErrors(s)})}},mounted(){this.deleteReviewModal=this.$refs.deleteReviewModal},created(){this.isLoadingReviews=!0}},V={class:"pt-24 pb-80 px-8 relative"},z={class:"relative"},Z={class:"align-top whitespace-nowrap px-4 py-4"},q={class:"items-center"},G={class:"align-top whitespace-nowrap px-4 py-4"},J={class:"items-center"},K={class:"align-top whitespace-nowrap px-4 py-4"},O={class:"flex items-center"},Q={class:"align-top px-4 py-4"},W={class:"flex space-x-1 items-center w-60"},X={key:1},Y={class:"align-top whitespace-nowrap px-4 py-4"},$={class:"flex space-x-1 items-center"},ee={class:"align-top px-4 py-4 flex items-center space-x-4"},te=["onClick"],se={key:1,class:"flex justify-center"},ie={class:"animated-border-blue w-96 bg-white py-4 px-4 shadow-sm space-y-4 rounded-xl"},oe={class:"flex justify-end"},re={key:0,class:"space-y-4 mb-8"},ae={class:"text-red-500 text-xs p-4 bg-red-50 border border-red-300 border-dashed rounded-lg space-y-2"},le={class:"flex items-center"},ne={key:0};function de(s,t,c,pe,r,l){const R=d("NoDataPlaceholder"),_=d("MoreInfoPopover"),b=d("SpinningLoader"),y=d("BasicTable"),S=d("Button"),D=d("ConfirmModal");return i(),a("div",V,[t[9]||(t[9]=e("img",{src:"/images/clouds.png",class:"absolute top-0"},null,-1)),e("div",z,[t[5]||(t[5]=e("div",{class:"flex flex-col items-center mb-8"},[e("h1",{class:"space-x-2 text-xl text-gray-700 font-semibold bg-white rounded-full py-2 px-8 mb-4"},[e("span",null,"ðŸ’¬"),e("span",null,"Reviews")]),e("img",{src:"/images/store-rooftop.png",class:"w-96"})],-1)),r.isLoadingReviews||(r.pagination??{}).total>0||l.hasSearchTerm?(i(),g(y,{key:0,pagination:r.pagination,isLoading:r.isLoadingReviews,onPaginate:l.paginate,onSearch:l.search,onRefresh:l.getReviews,totalHeaders:r.tableHeaders.length},{head:m(()=>[e("tr",null,[(i(!0),a(h,null,u(r.tableHeaders,(o,n)=>(i(),a("th",{key:n,scope:"col",class:"whitespace-nowrap px-4 py-3"},p(o),1))),128))])]),body:m(()=>[(i(!0),a(h,null,u(r.reviews,o=>(i(),a("tr",{key:o.id,class:"group bg-white hover:bg-gray-50 border-b"},[e("td",Z,[e("div",q,[e("span",null,p(o._relationships.user._attributes.name),1)])]),e("td",G,[e("div",J,[e("span",null,p(o.subject),1)])]),e("td",K,[e("div",O,[(i(),a(h,null,u(5,(n,v)=>e("svg",{key:v,class:f([o.rating>v?"text-yellow-300":"text-gray-300","w-4 h-4"]),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},t[0]||(t[0]=[e("path",{"fill-rule":"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z","clip-rule":"evenodd"},null,-1)]),2)),64))])]),e("td",Q,[e("div",W,[o.comment==null?(i(),g(R,{key:0})):(i(),a("span",X,p(o.comment),1))])]),e("td",Y,[e("div",$,[e("span",null,p(s.formattedDatetime(o.createdAt)),1),w(_,{class:"opacity-0 group-hover:opacity-100",title:s.formattedRelativeDate(o.createdAt),placement:"top"},null,8,["title"])])]),e("td",ee,[l.isDeleting(o)?(i(),g(b,{key:0,type:"danger"},{default:m(()=>t[1]||(t[1]=[e("span",{class:"text-xs ml-2"},"Deleting...",-1)])),_:1})):(i(),a("span",{key:1,onClick:j(n=>l.showDeleteConfirmationModal(o),["stop","prevent"]),class:"cursor-pointer font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,te))])]))),128))]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(i(),a("div",se,[e("div",ie,[t[3]||(t[3]=e("h1",{class:"text-xl font-bold"}," Get Customer Feedback ",-1)),t[4]||(t[4]=e("p",{class:"text-sm text-gray-500"}," See what your customers are saying about your products and services. Reviews will appear here once customers provide feedback. ",-1)),e("div",oe,[w(S,{action:null,type:"primary",size:"sm",icon:"short-right-arrow"},{default:m(()=>t[2]||(t[2]=[e("span",null,"Request Reviews",-1)])),_:1})])])]))]),w(D,{ref:"deleteReviewModal",approveText:"Delete Review",approveAction:l.deleteReview,isLoading:l.isDeleting(r.deletableReview)},{content:m(()=>[t[8]||(t[8]=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),r.deletableReview?(i(),a("div",re,[t[7]||(t[7]=e("p",null,"Are you sure you want to permanently delete this review?",-1)),e("div",ae,[e("div",le,[(i(),a(h,null,u(5,(o,n)=>e("svg",{key:n,class:f([r.deletableReview.rating>n?"text-yellow-300":"text-gray-300","w-4 h-4"]),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},t[6]||(t[6]=[e("path",{"fill-rule":"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z","clip-rule":"evenodd"},null,-1)]),2)),64))]),r.deletableReview.comment?(i(),a("p",ne,p(r.deletableReview.comment),1)):x("",!0)])])):x("",!0)]),_:1},8,["approveAction","isLoading"])])}const He=E(U,[["render",de]]);export{He as default};
