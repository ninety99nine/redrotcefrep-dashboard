import{s as V,c as i,b as t,e as h,B as U,w as l,h as m,d as p,f as u,r as d,o,F as T,k as b,t as c,m as f,n as R}from"./app-jXH5QC3l.js";import{F as N}from"./FormMixin-6JkaGLLr.js";import{U as H}from"./form-store-C265_0LO.js";import{u as F}from"./store-store-DI9g0YE3.js";import{A as q}from"./AddButton-C27rg1QJ.js";import{T as z}from"./TextHeader-7PJHfuaV.js";import{B as j}from"./BasicTable-BENOl8OQ.js";import{C as W}from"./Checkbox-CA6moHBM.js";import{C as Y}from"./Countdown-C2pi1waa.js";import{E as G}from"./ExternalLink-D-h8jxtk.js";import{C as J}from"./ConfirmModal-l78eHkJU.js";import{S as K}from"./SpinningLoader-BdvFuScB.js";import{P as O}from"./PrimaryButton-BXUz1ZHt.js";import{M as Q}from"./MoreInfoPopover-DuLCv7tU.js";import{g as X,d as Z}from"./api-repository--xE_j9dL.js";import{T as $}from"./ToogleSwitch-D6TVHn6r.js";import{P as ee}from"./Pill-CNWbwQ3o.js";import{T as te}from"./TransactionPaymentStatus-DiTLjeC2.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./cloneDeep-B1YGuKb7.js";import"./Button-BeSnAT_x.js";import"./ShineEffect-DfG5M4Ts.js";import"./SearchInput-BxlZh9-p.js";import"./index-CHIj4cOM.js";import"./TextInput-CYg7QVrw.js";import"./InputErrorMessage-CbGsL3fL.js";import"./SelectInput-D7XUHB9M.js";import"./Drawer-CCLxMHft.js";import"./MoneyInput-CQeRzHMh.js";import"./Datepicker-B1KIg2S4.js";import"./vue-draggable-next.esm-bundler-DxBVIkpx.js";/* empty css                                                                      */const oe={mixins:[N,H],components:{AddButton:q,TextHeader:z,BasicTable:j,Checkbox:W,Countdown:Y,ExternalLink:G,ConfirmModal:J,SpinningLoader:K,PrimaryButton:O,MoreInfoPopover:Q,ToogleSwitch:$,Pill:ee,TransactionPaymentStatus:te},data(){return{transactions:[],pagination:null,searchTerm:null,checkedRowIds:[],showEverything:!1,appName:V.appName,deletableTransaction:null,isDeletingTransactionIds:[],isLoadingTransactions:!1,storeState:F()}},computed:{store(){return this.storeState.store},tableHeaders(){return this.showEverything?["","Trans #","Description","Payment Status","Amount","Percentage","Payment Method","Requester","Verifyer","Payment Link","Created Date",""]:["","Trans #","Payment Status","Amount","Payment Method","Requester","Verifyer","Payment Link",""]},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{onView(n){this.$router.push({name:"show-store-transaction",params:{store_href:this.store._links.showStore,transaction_href:n._links.showTransaction}}).then(()=>{window.scrollTo(0,0)})},navigateToShowCustomers(){this.$router.push({name:"show-store-customers",params:{store_href:this.store._links.showStore}})},showDeleteConfirmationModal(n){this.deletableTransaction=n,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(n){return this.isDeletingTransactionIds.findIndex(e=>e==n.id)!=-1},onAddTransaction(){this.$router.push({name:"create-store-transaction",params:{store_href:this.store._links.showStore}})},paginate(n){this.getTransactions(n)},search(n){this.searchTerm=n,this.getTransactions()},getTransactions(n=null){this.isLoadingTransactions=!0;const e={_relationships:"customer,requestedByUser,manuallyVerifiedByUser,paymentMethod"};this.hasSearchTerm&&(e.search=this.searchTerm),n=n??this.store._links.showStoreTransactions,X(n,e).then(g=>{g.status==200&&(this.pagination=g.data,this.transactions=this.pagination.data,this.checkedRowIds=this.transactions.map(k=>!1)),this.isLoadingTransactions=!1}).catch(g=>{this.isLoadingTransactions=!1})},deleteTransaction(){this.isDeletingTransactionIds.push(this.deletableTransaction.id),Z(this.deletableTransaction._links.deleteTransaction).then(n=>{this.isDeletingTransactionIds.splice(this.isDeletingTransactionIds.findIndex(e=>e==this.deletableTransaction.id,1)),n.status==200&&(n.data.deleted?(this.showSuccessfulNotification("Transaction deleted"),this.isDeletingTransactionIds.length==0&&this.getTransactions()):(this.setFormError("general",n.data.message),this.showUnsuccessfulNotification(n.data.message)))}).catch(n=>{this.isDeletingTransactionIds.splice(this.isDeletingTransactionIds.findIndex(e=>e==this.deletableTransaction.id,1)),this.setServerFormErrors(n)})}},mounted(){},created(){this.getTransactions()}},ne={class:"pt-24 pb-80 px-8 relative"},ae={class:"relative"},ie={class:"flex justify-center my-4"},re=["onClick"],le={class:"whitespace-nowrap px-4 py-4"},de={class:"flex space-x-1 items-center"},pe={key:0,class:"px-4 py-4"},ce={class:"min-w-80"},me={class:"whitespace-nowrap px-4 py-4"},he={class:"whitespace-nowrap px-4 py-4 text-center"},ue={key:1,class:"whitespace-nowrap px-4 py-4 text-center"},ye={class:"whitespace-nowrap px-4 py-4 text-center"},fe={class:"whitespace-nowrap px-4 py-4"},ge={key:0},xe={key:1,class:"text-xs text-center text-gray-300"},_e={class:"text-xs text-center text-gray-300"},we={key:0,class:"whitespace-nowrap px-4 py-4"},Te={key:0,class:"flex items-start space-x-2"},be={key:0,class:"max-w-80"},ke={key:2,class:"text-xs text-center text-gray-300"},ve={key:1,class:"text-xs text-center text-gray-300"},Se={key:2,class:"whitespace-nowrap px-4 py-4"},Pe={class:"flex space-x-1 items-center"},De={class:"px-4 py-4 flex items-center space-x-4"},Ce=["onClick"],Be=["onClick"],Ie={key:1,class:"flex justify-between space-x-20 bg-white shadow-lg rounded-lg border p-20"},Ee={class:"space-y-4"},Le={class:"mb-8"},Ae={class:"font-bold text-black"};function Me(n,e,g,k,a,r){const v=d("ToogleSwitch"),S=d("Button"),P=d("Checkbox"),_=d("MoreInfoPopover"),D=d("TransactionPaymentStatus"),w=d("Pill"),C=d("ExternalLink"),B=d("Countdown"),I=d("SpinningLoader"),E=d("BasicTable"),L=d("AddButton"),A=d("PrimaryButton"),M=d("ConfirmModal");return o(),i("div",ne,[e[17]||(e[17]=t("img",{src:"/images/clouds.png",class:"absolute top-0"},null,-1)),t("div",ae,[e[12]||(e[12]=t("div",{class:"flex flex-col items-center mb-8"},[t("h1",{class:"space-x-2 text-xl text-gray-700 font-semibold bg-white rounded-full py-2 px-8 mb-4"},[t("span",null,"ðŸ’µ"),t("span",null,"Transactions")]),t("img",{src:"/images/store-rooftop.png",class:"w-96"})],-1)),a.isLoadingTransactions||(a.pagination??{}).total>0||r.hasSearchTerm?(o(),h(E,{key:0,pagination:a.pagination,isLoading:a.isLoadingTransactions,onPaginate:r.paginate,onSearch:r.search,onRefresh:r.getTransactions,totalHeaders:r.tableHeaders.length},U({afterRefreshButton:l(()=>[p(S,{action:r.onAddTransaction,type:"primary",size:"sm",icon:"add"},{default:l(()=>e[4]||(e[4]=[t("span",null,"Add Transaction",-1)])),_:1},8,["action"])]),head:l(()=>[t("tr",null,[(o(!0),i(T,null,b(r.tableHeaders,(s,y)=>(o(),i("th",{key:y,scope:"col",class:"whitespace-nowrap px-4 py-3"},c(s),1))),128))])]),body:l(()=>[(o(!0),i(T,null,b(a.transactions,(s,y)=>(o(),i("tr",{onClick:f(x=>r.onView(s),["stop"]),key:s.id,class:R(["group cursor-pointer border-b",a.checkedRowIds[y]?"bg-blue-100":"bg-white hover:bg-gray-50"])},[t("td",{onClick:e[1]||(e[1]=f(()=>{},["stop"])),class:"whitespace-nowrap pl-4"},[p(P,{size:"xs",modelValue:a.checkedRowIds[y],"onUpdate:modelValue":x=>a.checkedRowIds[y]=x},null,8,["modelValue","onUpdate:modelValue"])]),t("td",le,[t("div",de,[t("span",null,"#"+c(s._attributes.number),1),p(_,{class:"opacity-0 group-hover:opacity-100",title:"#"+s._attributes.number,description:s.description,placement:"top"},null,8,["title","description"])])]),a.showEverything?(o(),i("td",pe,[t("div",ce,c(s.description),1)])):u("",!0),t("td",me,[p(D,{transaction:s},null,8,["transaction"])]),t("td",he,c(s.amount.amountWithCurrency),1),a.showEverything?(o(),i("td",ue,c(s.percentage.valueSymbol),1)):u("",!0),t("td",ye,c(s._relationships.paymentMethod.name),1),t("td",fe,[s._relationships.requestedByUser?(o(),i("span",ge,c(s._relationships.requestedByUser._attributes.name),1)):(o(),i("span",xe,"---"))]),t("td",_e,[s._relationships.verifiedByUser?(o(),i("span",we,c(s._relationships.verifiedByUser._attributes.name),1)):(o(),h(w,{key:1,type:"info",text:a.appName,showDot:!1},null,8,["text"]))]),t("td",{class:"px-4 py-4",onClick:e[2]||(e[2]=f(()=>{},["stop"]))},[s.metadata?(o(),i("div",Te,[s.metadata.canPayUsingDpo?(o(),i("div",be,[p(C,{url:s.metadata.dpoPaymentUrl,class:"text-xs"},{default:l(()=>[m(c(s.metadata.dpoPaymentUrl),1)]),_:2},1032,["url"])])):s.metadata.dpoPaymentLinkHasExpired==!0?(o(),h(w,{key:1,type:"warning",text:"Expired",showDot:!1})):(o(),i("span",ke,"---")),s.metadata.canPayUsingDpo?(o(),h(_,{key:3,title:"Expires In",placement:"top",class:"opacity-0 group-hover:opacity-100 mt-1"},{description:l(()=>[e[5]||(e[5]=t("div",{class:"border-t border-dashed my-2"},null,-1)),p(B,{showMoreInfoPopover:!1,time:s.metadata.dpoPaymentUrlExpiresAt},null,8,["time"])]),_:2},1024)):u("",!0)])):(o(),i("span",ve,"---"))]),a.showEverything?(o(),i("td",Se,[t("div",Pe,[t("span",null,c(n.formattedDatetime(s.createdAt)),1),p(_,{class:"opacity-0 group-hover:opacity-100",title:n.formattedRelativeDate(s.createdAt),placement:"top"},null,8,["title"])])])):u("",!0),t("td",De,[r.isDeleting(s)?u("",!0):(o(),i("a",{key:0,href:"#",onClick:f(x=>r.onView(s),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"View",8,Ce)),r.isDeleting(s)?(o(),h(I,{key:1,type:"danger"},{default:l(()=>e[6]||(e[6]=[t("span",{class:"text-xs ml-2"},"Deleting...",-1)])),_:1})):(o(),i("a",{key:2,href:"#",onClick:f(x=>r.showDeleteConfirmationModal(s),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,Be))])],10,re))),128))]),_:2},[(a.pagination??{}).total>0?{name:"header",fn:l(()=>[t("div",ie,[p(v,{modelValue:a.showEverything,"onUpdate:modelValue":e[0]||(e[0]=s=>a.showEverything=s),size:"md",labelPopoverTitle:"What Is This?",labelPopoverDescription:"Turn on if you want to show more information about your transactions"},{default:l(()=>e[3]||(e[3]=[m(" Show Everything ")])),_:1},8,["modelValue"])])]),key:"0"}:void 0]),1032,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(o(),i("div",Ie,[t("div",Ee,[e[10]||(e[10]=t("h1",{class:"text-2xl font-bold"},"No Transactions Yet",-1)),t("p",null,[e[7]||(e[7]=m("Your transactions will appear here once ")),p(w,{type:"primary",text:"customers",showDot:!1,clickable:!0,action:r.navigateToShowCustomers},null,8,["action"]),e[8]||(e[8]=m(" start paying. Start promoting your store to attract buyers and generate sales. Promote your store on as many platforms as possible."))]),p(L,{action:r.onAddTransaction,class:"w-40",size:"sm"},{default:l(()=>e[9]||(e[9]=[t("span",{class:"ml-2"},"Add Transaction",-1)])),_:1},8,["action"])]),e[11]||(e[11]=t("div",null,[t("span",{class:"text-8xl"},"ðŸ’µ")],-1))]))]),a.deletableTransaction?(o(),h(M,{key:0,approveText:"Delete Transaction",approveAction:r.deleteTransaction,isLoading:r.isDeleting(a.deletableTransaction)},{content:l(()=>[e[15]||(e[15]=t("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),t("p",Le,[e[13]||(e[13]=m("Are you sure you want to permanently delete ")),t("span",Ae,"transaction #"+c(a.deletableTransaction._attributes.number),1),e[14]||(e[14]=m("?"))])]),trigger:l(s=>[p(A,{ref:"confirmDeleteButton",action:s.showModal,class:"hidden",type:"danger"},{default:l(()=>e[16]||(e[16]=[m(" Delete Transaction ")])),_:2},1032,["action"])]),_:1},8,["approveAction","isLoading"])):u("",!0)])}const ht=se(oe,[["render",Me]]);export{ht as default};
