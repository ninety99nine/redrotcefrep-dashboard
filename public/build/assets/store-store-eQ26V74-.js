import{z as a,C as n}from"./app-B8gd3Cxn.js";import{c as r,i as l}from"./cloneDeep-BSUglKOW.js";import{a as i,u as o}from"./form-store-Dc8OgXqt.js";import{a as f,d as u}from"./api-repository-Ccg06KIS.js";const g=a("store",{state:()=>({store:null,storeForm:null,shouldUpdate:!1,quickStartGuide:null,isLoadingStore:!1,isDeletingStore:!1,originalStoreForm:null,isSubmittingStore:!1,isLoadingQuickStartGuide:!1}),actions:{setStore(t){this.store=t},setQuickStartGuide(t){this.quickStartGuide=t},setShouldUpdate(t){this.shouldUpdate=t},setIsLoadingStore(t){this.isLoadingStore=t},setIsDeletingStore(t){this.isDeletingStore=t},setIsSubmittingStore(t){this.isSubmittingStore=t},setIsLoadingQuickStartGuide(t){this.isLoadingQuickStartGuide=t},resetStoreForm(){this.setStoreForm(this.store)},setStoreForm(t=null){var e,s;t?this.storeForm={name:t.name,email:t.email,alias:t.alias,taxId:t.taxId,online:t.online,country:t.country,language:t.language,taxMethod:t.taxMethod,weightUnit:t.weightUnit,currency:t.currency.code,description:t.description,socialLinks:t.socialLinks,distanceUnit:t.distanceUnit,openingHours:t.openingHours,smsSenderName:t.smsSenderName,offlineMessage:t.offlineMessage,showOpeningHours:t.showOpeningHours,ussdMobileNumber:(e=t.ussdMobileNumber)==null?void 0:e.international,taxPercentageRate:t.taxPercentageRate.value.toString(),allowCheckoutOnClosedHours:t.allowCheckoutOnClosedHours,whatsappMobileNumber:(s=t.whatsappMobileNumber)==null?void 0:s.international,secondaryButtonTextColor:"#ffffff",secondaryButtonColor:"#1f87e8",primaryButtonTextColor:"#ffffff",primaryButtonColor:"#1f87e8",bannerTextColor:"#ffffff",bannerColor:"#105294",textColor:"#ffffff",bgColor:"#1f87e8",cardHeadingTextColor:"#000000",cardSecondaryColor:"#ffffff",cardPrimaryColor:"#f9fafb",productBgColor:"#ffffff",productNameColor:"#000000",productPriceColor:"#000000",productQuantityColor:"#000000",productHoverBgColor:"#f3f4f6",productHoverNameColor:"#000000",productHoverPriceColor:"#000000",productHoverQuantityColor:"#000000"}:this.storeForm={name:null,taxId:null,email:null,alias:null,online:null,country:null,currency:null,language:null,taxMethod:null,socialLinks:[],openingHours:[],description:null,weightUnit:null,distanceUnit:null,smsSenderName:null,offlineMessage:null,ussdMobileNumber:null,taxPercentageRate:null,showOpeningHours:!1,whatsappMobileNumber:null,allowCheckoutOnClosedHours:!1,secondaryButtonTextColor:"#ffffff",secondaryButtonColor:"#1f87e8",primaryButtonTextColor:"#ffffff",primaryButtonColor:"#1f87e8",bannerTextColor:"#ffffff",bannerColor:"#105294",textColor:"#ffffff",bgColor:"#1f87e8",cardHeadingTextColor:"#000000",cardSecondaryColor:"#ffffff",cardPrimaryColor:"#f9fafb",productBgColor:"#ffffff",productNameColor:"#000000",productPriceColor:"#000000",productQuantityColor:"#000000",productHoverBgColor:"#f3f4f6",productHoverNameColor:"#000000",productHoverPriceColor:"#000000",productHoverQuantityColor:"#000000"},this.storeForm.openingHours.length==0&&(this.storeForm.openingHours=this.generateOpeningHours()),this.setIfMissingSocialLinks(),this.setOriginalStoreForm()},setOriginalStoreForm(){this.originalStoreForm=r(this.storeForm)},setIfMissingSocialLinks(){this.setIfMissingSocialLink("Whatsapp"),this.setIfMissingSocialLink("Telegram"),this.setIfMissingSocialLink("Messenger"),this.setIfMissingSocialLink("Facebook"),this.setIfMissingSocialLink("Instagram"),this.setIfMissingSocialLink("LinkedIn"),this.setIfMissingSocialLink("YouTube"),this.setIfMissingSocialLink("Snapchat"),this.setIfMissingSocialLink("TikTok"),this.setIfMissingSocialLink("Twitch"),this.setIfMissingSocialLink("X")},setIfMissingSocialLink(t){this.storeForm.socialLinks.some(s=>s.name===t)||this.storeForm.socialLinks.push({name:t,link:""})},generateOpeningHours(){return Array(7).fill().map(()=>({available:!0,hours:[["08:00","16:00"]]}))},syncWithAlias(){this.aliasModified==!1&&(this.storeForm.alias=this.storeForm.name,this.formatAlias())},formatAlias(t=!1){this.storeForm.alias.length?(this.storeForm.alias=this.storeForm.alias.replace(/[^a-zA-Z0-9\s-]/g,"").replace(/\s+/g,"-").trim().toLowerCase(),this.aliasModified=t):this.aliasModified=!1},updateStore(){if(this.storeForm.name.trim()==""){i().setFormError("name","The store name is required"),o().addWarningNotification("The store name is required");return}this.setIsSubmittingStore(!0);const t={...this.storeForm,return:!0};t.socialLinks=t.socialLinks.filter(e=>e.link!=null&&e.link.trim()!=""),f(this.store._links.updateStore,t).then(e=>{e.status==200&&(e.data.updated?(this.setShouldUpdate(!0),this.setStoreForm(e.data.store),o().addSuccessNotification("Store updated")):(i().setGeneralFormError(e.data.message),o().addWarningNotification(e.data.message))),this.setIsSubmittingStore(!1)}).catch(e=>{this.setIsSubmittingStore(!1),i().setServerFormErrors(e)})},deleteStore(){this.setIsDeletingStore(!0),u(this.store._links.deleteStore).then(t=>{t.status==200&&(t.data.deleted?(o().addSuccessNotification("Store deleted"),n.replace({name:"dashboard"}).then(()=>{window.scrollTo(0,0)})):(i().setGeneralFormError(t.data.message),o().addWarningNotification(t.data.message))),this.setIsDeletingStore(!1)}).catch(t=>{this.setIsDeletingStore(!1),i().setServerFormErrors(t)})}},getters:{formHasChanged(){var t=r(this.storeForm),e=r(this.originalStoreForm);return!l(t,e)},mustSaveChanges(){return this.formHasChanged&&!this.isSubmitting},completedQuickStartGuide(t){return t.quickStartGuide==null?!1:t.quickStartGuide.completedMilestones==this.quickStartGuide.totalMilestones}}});export{g as u};
