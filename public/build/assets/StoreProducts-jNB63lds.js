import{F as N}from"./FormMixin-B-agdKFQ.js";import{U as M}from"./UtilsMixin-CBwmyCNB.js";import{u as F,c as i,b as s,d as a,w as c,F as m,f as h,e as g,h as p,r as u,o,k as v,t as d,m as x,n as P}from"./app-B8gd3Cxn.js";import{V as U}from"./vue-draggable-next.esm-bundler-B9yecrVA.js";import{u as E}from"./store-store-eQ26V74-.js";import{T as Q}from"./TextHeader-BqHIggxI.js";import{A as R}from"./AddButton-DU95A9tI.js";import{B as H}from"./BasicTable-tpSIdUGX.js";import{C as W}from"./Checkbox-BVMyYOyQ.js";import{C as O}from"./ConfirmModal-DhZLN2Vv.js";import{S as z}from"./SpinningLoader-CZqr6WN5.js";import{P as j}from"./PrimaryButton-BousIvUf.js";import{M as K}from"./MoreInfoPopover-BDSzYKfY.js";import{T as q}from"./ToogleSwitch-DmW_wa5p.js";import{B as G}from"./BadgeIndicator-lr_nJHG3.js";import{g as J,d as X,p as Y}from"./api-repository-Ccg06KIS.js";import{N as Z}from"./NoDataPlaceholder-C8_5vCkl.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-store-Dc8OgXqt.js";import"./cloneDeep-BSUglKOW.js";import"./SearchInput-COM9VROU.js";import"./index-D19FfSVG.js";import"./TextInput-C-iRidDV.js";import"./InputErrorMessage-BTnNDtHI.js";const ee={mixins:[N,M],components:{draggable:U,TextHeader:Q,AddButton:R,BasicTable:H,Checkbox:W,ConfirmModal:O,SpinningLoader:z,PrimaryButton:j,MoreInfoPopover:K,ToogleSwitch:q,BadgeIndicator:G,NoDataPlaceholder:Z},data(){return{products:[],pagination:null,searchTerm:null,checkedRowIds:[],showEverything:!1,deletableProduct:null,apiState:F(),isDeletingProductIds:[],isLoadingProducts:!1,storeState:E(),isUpdatingProductArrangement:!1}},computed:{store(){return this.storeState.store},tableHeaders(){return this.showEverything?["","Name","Description","Visibility","Price","Stock","Variations","Quantity Per Order","Position","Created Date",""]:["","Name","Visibility","Price","Stock","Variations",""]},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{onView(n){this.$router.push({name:"show-store-product",params:{store_href:this.store._links.showStore,product_href:n._links.showProduct}}).then(()=>{window.scrollTo(0,0)})},showDeleteConfirmationModal(n){this.deletableProduct=n,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(n){return this.isDeletingProductIds.findIndex(e=>e==n.id)!=-1},onAddProduct(){this.$router.push({name:"create-store-product",params:{store_href:this.store._links.showStore}})},paginate(n){this.url=n,this.getProducts()},search(n){this.url=this.store._links.showStoreProducts,this.searchTerm=n,this.getProducts()},getProducts(){this.isLoadingProducts=!0;const n={};this.hasSearchTerm&&(n.search=this.searchTerm),J(this.url,n).then(e=>{e.status==200&&(this.pagination=e.data,this.products=this.pagination.data,this.checkedRowIds=this.products.map(D=>!1)),this.isLoadingProducts=!1}).catch(e=>{this.isLoadingProducts=!1,this.setServerFormErrors(e)})},deleteProduct(){this.isDeletingProductIds.push(this.deletableProduct.id),X(this.deletableProduct._links.deleteProduct).then(n=>{this.isDeletingProductIds.splice(this.isDeletingProductIds.findIndex(e=>e==this.deletableProduct.id,1)),n.status==200&&(n.data.deleted?(this.showSuccessfulNotification("Product deleted"),this.isDeletingProductIds.length==0&&this.getProducts()):(this.setFormError("general",n.data.message),this.showUnsuccessfulNotification(n.data.message)))}).catch(n=>{this.isDeletingProductIds.splice(this.isDeletingProductIds.findIndex(e=>e==this.deletableProduct.id,1)),this.setServerFormErrors(n)})},updateProductArrangement(){this.isUpdatingProductArrangement=!0;const n={storeId:this.store.id,productIds:this.products.map(e=>e.id)};Y(this.apiState.apiHome._links.updateProductArrangement,n).then(e=>{e.status==200&&this.showSuccessfulNotification("Product arrangement updated"),this.isUpdatingProductArrangement=!1}).catch(e=>{this.isUpdatingProductArrangement=!1,this.setServerFormErrors(e)})}},mounted(){},created(){this.url=this.store._links.showStoreProducts,this.getProducts()}},te={class:"flex justify-between items-center border-dashed py-6"},se={class:"flex items-center"},oe=["onClick"],ie={class:"whitespace-nowrap px-4 py-4"},ne={class:"flex space-x-1 items-center w-40"},ae={key:0,class:"text-black"},re={key:0,class:"text-black"},le={key:0,class:"px-4 py-4"},de={class:"flex space-x-1 items-center w-60"},ce={class:"whitespace-nowrap px-4 py-4"},pe={class:"flex space-x-1 items-center"},ue={class:"whitespace-nowrap px-4 py-4"},he={key:1,class:"flex space-x-1 items-center"},me={key:0},ge={key:2,class:"text-black"},ye={class:"font-bold"},fe={class:"whitespace-nowrap px-4 py-4"},we={key:1,class:"flex space-x-1 items-center"},ke={class:"whitespace-normal"},xe={key:0},Pe={key:1},be={class:"whitespace-nowrap px-4 py-4"},_e={class:"flex space-x-1 items-center"},ve={class:"whitespace-normal"},De={class:"whitespace-nowrap px-4 py-4"},Se={class:"flex space-x-1 items-center"},Ve={class:"whitespace-normal"},Ce={class:"whitespace-nowrap px-4 py-4 text-center"},Te={class:"whitespace-nowrap px-4 py-4"},Ae={class:"flex space-x-1 items-center"},Ie={class:"px-4 py-4 flex items-center space-x-4"},Be=["onClick"],Le=["onClick"],Ne={key:3,class:"draggable-handle w-4 h-4 cursor-grab hover:text-yellow-500 active:cursor-grabbing",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},Me={key:1,class:"flex justify-between space-x-20 bg-white shadow-lg rounded-lg border p-20"},Fe={class:"space-y-4"},Ue={class:"mb-8"},Ee={class:"font-bold text-black"};function Qe(n,e,D,Re,r,l){const S=u("TextHeader"),y=u("MoreInfoPopover"),V=u("ToogleSwitch"),_=u("AddButton"),C=u("Checkbox"),f=u("BadgeIndicator"),b=u("NoDataPlaceholder"),T=u("SpinningLoader"),A=u("draggable"),I=u("BasicTable"),B=u("PrimaryButton"),L=u("ConfirmModal");return o(),i("div",null,[s("div",te,[s("div",se,[a(S,null,{default:c(()=>e[3]||(e[3]=[s("span",{class:"mr-2"},"🛍️",-1),p(" Products")])),_:1}),a(y,{class:"ml-2 mt-1",title:"What Is This?",description:"Products are physical or non physical items that customers can place orders and pay for using your preferred payment methods",placement:"top"})]),(r.pagination??{}).total>0?(o(),i(m,{key:0},[a(V,{modelValue:r.showEverything,"onUpdate:modelValue":e[0]||(e[0]=t=>r.showEverything=t),size:"md",labelPopoverTitle:"What Is This?",labelPopoverDescription:"Turn on if you want to show more information about your products"},{default:c(()=>e[4]||(e[4]=[p(" Show Everything ")])),_:1},8,["modelValue"]),a(_,{action:l.onAddProduct,class:"w-40"},{default:c(()=>e[5]||(e[5]=[s("span",{class:"ml-2"},"Add Product",-1)])),_:1},8,["action"])],64)):h("",!0)]),r.isLoadingProducts||(r.pagination??{}).total>0||l.hasSearchTerm?(o(),g(I,{key:0,pagination:r.pagination,isLoading:r.isLoadingProducts,onPaginate:l.paginate,onSearch:l.search,onRefresh:l.getProducts,totalHeaders:l.tableHeaders.length},{head:c(()=>[s("tr",null,[(o(!0),i(m,null,v(l.tableHeaders,(t,w)=>(o(),i("th",{key:w,scope:"col",class:"whitespace-nowrap px-4 py-3"},d(t),1))),128))])]),tbody:c(()=>[a(A,{tag:"tbody",modelValue:r.products,"onUpdate:modelValue":e[2]||(e[2]=t=>r.products=t),handle:".draggable-handle","ghost-class":"bg-yellow-50",onChange:l.updateProductArrangement},{default:c(()=>[(o(!0),i(m,null,v(r.products,(t,w)=>(o(),i("tr",{onClick:x(k=>l.onView(t),["stop"]),key:t.id,class:P(["group cursor-pointer border-b",r.checkedRowIds[w]?"bg-blue-100":"bg-white hover:bg-gray-50"])},[s("td",{onClick:e[1]||(e[1]=x(()=>{},["stop"])),class:"whitespace-nowrap pl-4"},[a(C,{size:"xs",modelValue:r.checkedRowIds[w],"onUpdate:modelValue":k=>r.checkedRowIds[w]=k},null,8,["modelValue","onUpdate:modelValue"])]),s("td",ie,[s("div",ne,[s("span",null,d(t.name),1),a(y,{class:"opacity-0 group-hover:opacity-100",title:t.name,placement:"top"},{description:c(()=>[e[9]||(e[9]=s("hr",null,null,-1)),s("p",null,[e[6]||(e[6]=s("span",null,"SKU: ",-1)),t.sku?(o(),i("span",ae)):(o(),g(f,{key:1,type:"info",text:"None",showDot:!1}))]),s("p",null,[e[7]||(e[7]=s("span",null,"Barcode: ",-1)),t.barcode?(o(),i("span",re)):(o(),g(f,{key:1,type:"info",text:"None",showDot:!1}))]),t.showDescription.status&&t.description!=null?(o(),i(m,{key:0},[e[8]||(e[8]=s("hr",null,null,-1)),s("p",null,d(t.description),1)],64)):h("",!0)]),_:2},1032,["title"])])]),r.showEverything?(o(),i("td",le,[s("div",de,[t.description==null?(o(),g(b,{key:0})):(o(),i(m,{key:1},[s("span",{class:P({"line-through":t.showDescription.status==!1})},d(t.description),3),a(y,{class:"opacity-0 group-hover:opacity-100",description:t.showDescription.description,placement:"top"},null,8,["description"])],64))])])):h("",!0),s("td",ce,[s("div",pe,[a(f,{type:t.visible.status?"success":"warning",text:t.visible.name,showDot:!1},null,8,["type","text"]),a(y,{class:"opacity-0 group-hover:opacity-100",title:t.visible.name,description:t.visible.description,placement:"top"},null,8,["title","description"])])]),s("td",ue,[t.allowVariations.status?(o(),g(b,{key:0})):(o(),i("div",he,[t.isFree.status?(o(),g(f,{key:0,type:"info",text:"free",showDot:!1})):(o(),i(m,{key:1},[s("span",null,d(t.unitPrice.amountWithCurrency),1),t.onSale.status?(o(),g(f,{key:0,type:"success",text:"on sale",showDot:!1})):h("",!0)],64)),a(y,{class:"opacity-0 group-hover:opacity-100",title:"Pricing",placement:"top"},{description:c(()=>[t.hasPrice.status?(o(),i(m,{key:0},[e[12]||(e[12]=s("hr",null,null,-1)),s("p",null,[e[10]||(e[10]=p("Regular Price: ")),s("span",{class:P(["text-black",{"line-through":t.onSale.status||t.isFree.status}])},d(t.unitRegularPrice.amountWithCurrency),3)]),t.onSale.status?(o(),i("p",me,[e[11]||(e[11]=p("Sale Price: ")),s("span",{class:P(["text-black",{"line-through":t.isFree.status}])},d(t.unitSalePrice.amountWithCurrency),3)])):h("",!0)],64)):h("",!0),e[15]||(e[15]=s("hr",null,null,-1)),t.isFree.status?(o(),i(m,{key:1},[s("p",null,d(t.isFree.description),1),e[13]||(e[13]=s("p",{class:"font-bold text-black"},[p("Price: "),s("span",{class:"text-green-500"},"Free")],-1))],64)):(o(),i("p",ge,[e[14]||(e[14]=p("Price: ")),s("span",ye,d(t.unitPrice.amountWithCurrency),1)]))]),_:2},1024)]))]),s("td",fe,[t.allowVariations.status?(o(),g(b,{key:0})):(o(),i("div",we,[a(f,{type:t.hasStock.status?"info":"danger",text:t.hasStock.status?t.stockQuantityType.value.toLowerCase()=="unlimited"?"Unlimited":t.stockQuantity.description:t.hasStock.name,showDot:!1},null,8,["type","text"]),a(y,{class:"opacity-0 group-hover:opacity-100",title:"Stock",placement:"top"},{description:c(()=>[s("div",ke,[t.stockQuantityType.value.toLowerCase()=="unlimited"?(o(),i("p",xe,d(t.stockQuantityType.description),1)):(o(),i("p",Pe,d(t.stockQuantity.description),1))])]),_:2},1024)]))]),s("td",be,[s("div",_e,[a(f,{type:"info",text:t.allowVariations.name.toLowerCase()=="yes"?t.totalVisibleVariations:"None",showDot:!1},null,8,["text"]),a(y,{class:"opacity-0 group-hover:opacity-100",title:"Allow Variations",placement:"top"},{description:c(()=>[s("div",ve,[s("p",null,d(t.allowVariations.description),1),t.allowVariations.status?(o(),i(m,{key:0},[e[18]||(e[18]=s("hr",{class:"my-2"},null,-1)),s("p",null,[e[16]||(e[16]=p("Total Variations: ")),s("span",null,d(t.totalVariations??"..."),1)]),s("p",null,[e[17]||(e[17]=p("Total Visible Variations: ")),s("span",null,d(t.totalVisibleVariations??"..."),1)])],64)):h("",!0)])]),_:2},1024)])]),r.showEverything?(o(),i(m,{key:1},[s("td",De,[s("div",Se,[a(f,{type:"info",text:t.allowedQuantityPerOrder.value.toLowerCase()=="unlimited"?"Unlimited":t.maximumAllowedQuantityPerOrder.value,showDot:!1},null,8,["text"]),a(y,{class:"opacity-0 group-hover:opacity-100",title:"Quantity Per Order",placement:"top"},{description:c(()=>[s("div",Ve,[s("p",null,d(t.allowedQuantityPerOrder.description),1)])]),_:2},1024)])]),s("td",Ce,"#"+d(t.position),1),s("td",Te,[s("div",Ae,[s("span",null,d(n.formattedDatetime(t.createdAt)),1),a(y,{class:"opacity-0 group-hover:opacity-100",title:n.formattedRelativeDate(t.createdAt),placement:"top"},null,8,["title"])])])],64)):h("",!0),s("td",Ie,[l.isDeleting(t)?h("",!0):(o(),i("a",{key:0,href:"#",onClick:x(k=>l.onView(t),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"View",8,Be)),l.isDeleting(t)?(o(),g(T,{key:1,type:"danger"},{default:c(()=>e[19]||(e[19]=[s("span",{class:"text-xs ml-2"},"Deleting...",-1)])),_:1})):(o(),i("a",{key:2,href:"#",onClick:x(k=>l.showDeleteConfirmationModal(t),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,Le)),l.isDeleting(t)?h("",!0):(o(),i("svg",Ne,e[20]||(e[20]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"},null,-1)])))])],10,oe))),128))]),_:1},8,["modelValue","onChange"])]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(o(),i("div",Me,[s("div",Fe,[e[24]||(e[24]=s("h1",{class:"text-2xl font-bold"},"Add your products",-1)),s("p",null,[e[21]||(e[21]=p("Start by stocking your store with ")),a(f,{type:"primary",text:"products",showDot:!1,clickable:!0,action:l.onAddProduct},null,8,["action"]),e[22]||(e[22]=p(" your customers will love"))]),a(_,{action:l.onAddProduct,class:"w-40",size:"sm"},{default:c(()=>e[23]||(e[23]=[s("span",{class:"ml-2"},"Add Product",-1)])),_:1},8,["action"])]),e[25]||(e[25]=s("div",null,[s("span",{class:"text-8xl"},"🛍️")],-1))])),r.deletableProduct?(o(),g(L,{key:2,approveText:"Delete Product",approveAction:l.deleteProduct,isLoading:l.isDeleting(r.deletableProduct)},{content:c(()=>[e[28]||(e[28]=s("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),s("p",Ue,[e[26]||(e[26]=p("Are you sure you want to permanently delete ")),s("span",Ee,d(r.deletableProduct.name),1),e[27]||(e[27]=p("?"))])]),trigger:c(t=>[a(B,{ref:"confirmDeleteButton",action:t.showModal,class:"hidden",type:"danger"},{default:c(()=>e[29]||(e[29]=[p(" Delete Product ")])),_:2},1032,["action"])]),_:1},8,["approveAction","isLoading"])):h("",!0)])}const pt=$(ee,[["render",Qe]]);export{pt as default};
