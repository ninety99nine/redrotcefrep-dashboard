import{r as n,o as a,c as m,d as i,w as p,h as u,e as E,f as b,b as s,q as _,v as F,n as P,u as L,a as U,x as D,F as g,t as N}from"./app-DGr24LlD.js";import{A}from"./Alert-BznNy-Vr.js";import{F as B}from"./FormMixin-DjJxif50.js";import{T as q}from"./TextInput-D_8GVWar.js";import{P as j,u as z}from"./ProfilePhoto-g-aS8tOI.js";import{T as O}from"./TextareaInput-DXzJNGau.js";import{P as H}from"./PasswordInput-_FwGf_cy.js";import{O as G}from"./OtpInput-DhLL1gbE.js";import{P as J}from"./PrimaryButton-Bke-6sJ-.js";import{M as K}from"./MoreInfoPopover-MomTL1G-.js";import{u as Q}from"./form-store-fTlv55Ng.js";import{T as R}from"./ToogleSwitch-Bb0NbskL.js";import{M as W}from"./MobileNumberInput-Db_2lVqD.js";import{F as X}from"./FormErrorMessages-H2z_xV0j.js";import{C as Y}from"./ConfirmPasswordInput-D1PsTqbU.js";import{U as Z}from"./UtilsMixin-CBwmyCNB.js";import{I as $,a as ee,b as oe}from"./InputErrorMessage-xckJoMbN.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./api-repository-BpNKEdKW.js";import"./SpinningLoader-C59uW44G.js";const re={props:{modelValue:{type:String},showAsterisk:{type:Boolean,default:!1},description:{type:String},learnMoreLabel:{type:[String,null]},learnMoreLink:{type:[String,null]},labelPopoverTitle:{type:String},labelPopoverDescription:{type:String},errorText:{type:String}},mixins:[Z],components:{InputLabel:$,InputLabelDescription:ee,InputErrorMessage:oe},data(){return{showPassword:!1,localModelValue:this.modelValue,uniqueId:this.generateUniqueId("current_password")}},watch:{modelValue(r,e){this.updateValue(r)},localModelValue(r,e){this.$emit("update:modelValue",r)}},methods:{updateValue(r){this.localModelValue=r}}},te={class:"mt-2 relative"},se=["id","name","type"],ie={class:"absolute inset-y-0 right-0 flex items-center pr-3"},ne=["xmlns"],le=["xmlns"];function ae(r,e,l,V,o,f){const w=n("InputLabel"),h=n("InputLabelDescription"),c=n("InputErrorMessage");return a(),m("div",null,[i(w,{_for:o.uniqueId,showAsterisk:l.showAsterisk,secondaryLabel:r.secondaryLabel,labelPopoverTitle:l.labelPopoverTitle,labelPopoverDescription:l.labelPopoverDescription},{default:p(()=>e[2]||(e[2]=[u(" Current Password ")])),_:1},8,["_for","showAsterisk","secondaryLabel","labelPopoverTitle","labelPopoverDescription"]),l.description?(a(),E(h,{key:0,description:l.description,learnMoreLabel:l.learnMoreLabel,learnMoreLink:l.learnMoreLink},null,8,["description","learnMoreLabel","learnMoreLink"])):b("",!0),s("div",te,[_(s("input",{"onUpdate:modelValue":e[0]||(e[0]=d=>o.localModelValue=d),id:o.uniqueId,name:o.uniqueId,type:o.showPassword?"text":"password",autocomplete:"current-password",required:"",class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-700 sm:text-sm sm:leading-6 px-3"},null,8,se),[[F,o.localModelValue]]),s("div",ie,[s("button",{onClick:e[1]||(e[1]=d=>o.showPassword=!o.showPassword),type:"button",class:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700"},[(a(),m("svg",{class:P(["h-5 w-5",{hidden:!o.showPassword,block:o.showPassword}]),fill:"none",xmlns:o.showPassword?"http://www.w3.org/2000/svg":"",viewBox:"0 0 20 20",stroke:"currentColor"},e[3]||(e[3]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 12a2 2 0 100-4 2 2 0 000 4z"},null,-1),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 10a8.001 8.001 0 11-16 0 8.001 8.001 0 0116 0z"},null,-1)]),10,ne)),(a(),m("svg",{class:P(["h-5 w-5",{block:!o.showPassword,hidden:o.showPassword}]),fill:"none",xmlns:o.showPassword?"":"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",stroke:"currentColor"},e[4]||(e[4]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 12a7.5 7.5 0 1114.999-1.5L19.5 12H5z"},null,-1)]),10,le))])])]),i(c,{errorText:l.errorText},null,8,["errorText"])])}const ue=M(re,[["render",ae]]),me={mixins:[B],components:{Alert:A,TextInput:q,TextareaInput:O,PasswordInput:H,OtpInput:G,PrimaryButton:J,MoreInfoPopover:K,ProfilePhoto:j,ToogleSwitch:R,MobileNumberInput:W,FormErrorMessages:X,ConfirmPasswordInput:Y,CurrentPasswordInput:ue},data(){return{isSubmitting:!1,changePassword:!1,apiState:L(),authState:U(),changeMobileNumber:!1,notificationState:Q(),aboutMe:"",lastName:"",firstName:"",password:"",mobileNumber:"",currentPassword:"",verificationCode:"",originalMobileNumber:"",passwordConfirmation:"",mobileVerificationShortcode:null}},computed:{hasChangedMobileNumber(){return this.originalMobileNumber.length==8&&this.originalMobileNumber!=this.mobileNumber}},methods:{setUserDetails(){this.aboutMe=this.authState.user.aboutMe,this.lastName=this.authState.user.lastName,this.firstName=this.authState.user.firstName,this.mobileNumber=this.authState.user.mobileNumber.national,this.originalMobileNumber=this.authState.user.mobileNumber.national,this.mobileVerificationShortcode=this.apiState.apiHome.mobileVerificationShortcode},updateUser(){if(this.hideFormErrors(),this.firstName.trim()=="")this.setFormError("firstName","Enter your first name");else if(this.lastName.trim()=="")this.setFormError("lastName","Enter your last name");else if(this.changePassword&&this.currentPassword.trim()=="")this.setFormError("currentPassword","Enter your current password");else if(this.changePassword&&this.password.trim()=="")this.setFormError("password","Enter your password");else if(this.changePassword&&this.passwordConfirmation.trim()=="")this.setFormError("passwordConfirmation","Enter your password confirmation");else if(this.changePassword&&this.password!=this.passwordConfirmation)this.setFormError("password","Password does not match confirmation");else if(this.changeMobileNumber&&this.mobileNumber.trim()=="")this.setFormError("mobileNumber","Enter your mobile number");else if(this.changeMobileNumber&&this.hasChangedMobileNumber&&this.verificationCode.trim()=="")this.setFormError("verificationCode","Enter your verification code");else{let r={lastName:this.lastName,firstName:this.firstName};this.aboutMe!=null&&this.aboutMe.length&&(r.aboutMe=this.aboutMe),this.changePassword&&(r.password=this.password,r.currentPassword=this.currentPassword,r.passwordConfirmation=this.passwordConfirmation),this.changeMobileNumber&&this.hasChangedMobileNumber&&(r.mobileNumber=this.mobileNumber,r.verificationCode=this.verificationCode),this.isSubmitting=!0,z(this.authState.user,r).then(e=>{e.status==200&&(this.isSubmitting=!1,this.password="",this.currentPassword="",this.changePassword=!1,this.passwordConfirmation="",this.changeMobileNumber=!1,this.originalMobileNumber=this.mobileNumber,this.authState.user=e.data,this.showSuccessfulNotification("Profile updated"))}).catch(e=>{this.isSubmitting=!1,this.setServerFormErrors(e)})}}},mounted(){D()},created(){this.setUserDetails()}},de={class:"px-16 pt-8"},pe={class:"flex min-h-full flex-col justify-center"},he={class:"sm:mx-auto sm:w-full sm:max-w-md p-4 bg-white border border-gray-200 rounded-lg shadow sm:p-6"},be={class:"mt-10 space-y-6",action:"#",method:"POST"},fe={class:"grid grid-cols-2 gap-4"},we={class:"md:col-span-1 col-span-2"},ce={class:"md:col-span-1 col-span-2"},ge={class:"md:col-span-2"},Pe={class:"font-bold"},Ne={class:"font-bold"};function Me(r,e,l,V,o,f){const w=n("ProfilePhoto"),h=n("TextInput"),c=n("TextareaInput"),d=n("ToogleSwitch"),x=n("CurrentPasswordInput"),v=n("PasswordInput"),y=n("ConfirmPasswordInput"),C=n("MobileNumberInput"),S=n("Alert"),T=n("OtpInput"),I=n("FormErrorMessages"),k=n("PrimaryButton");return a(),m("div",de,[s("div",pe,[s("div",he,[i(w,{user:o.authState.user,class:"mx-auto",width:"w-40",height:"h-40"},null,8,["user"]),s("form",be,[s("div",fe,[s("div",we,[i(h,{modelValue:o.firstName,"onUpdate:modelValue":e[0]||(e[0]=t=>o.firstName=t),label:"First Name",autocomplete:"given-name",errorText:r.getFormError("firstName")},null,8,["modelValue","errorText"])]),s("div",ce,[i(h,{label:"Last Name",modelValue:o.lastName,"onUpdate:modelValue":e[1]||(e[1]=t=>o.lastName=t),autocomplete:"family-name",errorText:r.getFormError("lastName")},null,8,["modelValue","errorText"])]),s("div",ge,[i(c,{rows:2,label:"About Me",modelValue:o.aboutMe,"onUpdate:modelValue":e[2]||(e[2]=t=>o.aboutMe=t),errorText:r.getFormError("aboutMe"),placeholder:"Say something about yourself"},null,8,["modelValue","errorText"])])]),i(d,{modelValue:o.changePassword,"onUpdate:modelValue":e[3]||(e[3]=t=>o.changePassword=t)},{default:p(()=>e[10]||(e[10]=[u("Change Password")])),_:1},8,["modelValue"]),o.changePassword?(a(),m(g,{key:0},[i(x,{modelValue:o.currentPassword,"onUpdate:modelValue":e[4]||(e[4]=t=>o.currentPassword=t),showForgotPassword:!1,errorText:r.getFormError("currentPassword")},null,8,["modelValue","errorText"]),i(v,{modelValue:o.password,"onUpdate:modelValue":e[5]||(e[5]=t=>o.password=t),showForgotPassword:!1,errorText:r.getFormError("password")},null,8,["modelValue","errorText"]),i(y,{modelValue:o.passwordConfirmation,"onUpdate:modelValue":e[6]||(e[6]=t=>o.passwordConfirmation=t),errorText:r.getFormError("passwordConfirmation")},null,8,["modelValue","errorText"])],64)):b("",!0),i(d,{modelValue:o.changeMobileNumber,"onUpdate:modelValue":e[7]||(e[7]=t=>o.changeMobileNumber=t)},{default:p(()=>e[11]||(e[11]=[u("Change Mobile Number")])),_:1},8,["modelValue"]),o.changeMobileNumber?(a(),m(g,{key:1},[i(C,{modelValue:o.mobileNumber,"onUpdate:modelValue":e[8]||(e[8]=t=>o.mobileNumber=t),errorText:r.getFormError("mobileNumber")},null,8,["modelValue","errorText"]),f.hasChangedMobileNumber?(a(),m(g,{key:0},[i(S,null,{default:p(()=>[e[12]||(e[12]=u(" Dial ")),s("span",Pe,N(o.mobileVerificationShortcode),1),e[13]||(e[13]=u(" on ")),s("span",Ne,N(o.mobileNumber),1),e[14]||(e[14]=u(" to confirm ownership of this mobile number. "))]),_:1}),i(T,{modelValue:o.verificationCode,"onUpdate:modelValue":e[9]||(e[9]=t=>o.verificationCode=t),errorText:r.getFormError("verificationCode")},null,8,["modelValue","errorText"])],64)):b("",!0)],64)):b("",!0),i(I),i(k,{action:f.updateUser,loading:o.isSubmitting,class:"w-full"},{default:p(()=>e[15]||(e[15]=[u(" Save Changes ")])),_:1},8,["action","loading"])])])])])}const Oe=M(me,[["render",Me]]);export{Oe as default};
