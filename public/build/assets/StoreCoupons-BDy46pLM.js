import{F as M}from"./FormMixin-CULzALzX.js";import{U as N}from"./UtilsMixin-CBwmyCNB.js";import{u as E}from"./store-store-D6KBR7nZ.js";import{A as F}from"./AddButton-CsMQc9aT.js";import{T as R}from"./TextHeader-DSSmQ7LM.js";import{C as H}from"./Checkbox-C0FUqY2q.js";import{B as U}from"./BasicTable-CB82VRf8.js";import{C as z}from"./ConfirmModal-BGWNF6pf.js";import{P as W}from"./PrimaryButton-H3KL-bqb.js";import{S as j}from"./SpinningLoader-BEnaF0ac.js";import{M as O}from"./MoreInfoPopover-DUIgEZ-J.js";import{g as q,d as G}from"./api-repository-bdlVH5Lr.js";import{T as J}from"./ToogleSwitch-DXorOTdd.js";import{B as K}from"./BadgeIndicator-DlVYZEkg.js";import{N as Q}from"./NoDataPlaceholder-DUt2_bbH.js";import{c as r,b as t,d as l,w as d,F as y,f as u,e as m,h,r as p,o as s,k as x,t as f,m as b,n as X}from"./app-BoGXsv54.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./form-store-CuTEKvPg.js";import"./cloneDeep-BSUglKOW.js";import"./InputErrorMessage-BzaNbvNM.js";import"./SearchInput-oKDF-Tqv.js";import"./index-D19FfSVG.js";import"./TextInput-CYwxZsJZ.js";const Z={mixins:[M,N],components:{AddButton:F,TextHeader:R,BasicTable:U,Checkbox:H,ConfirmModal:z,PrimaryButton:W,SpinningLoader:j,MoreInfoPopover:O,ToogleSwitch:J,BadgeIndicator:K,NoDataPlaceholder:Q},data(){return{coupons:[],pagination:null,searchTerm:null,checkedRowIds:[],showEverything:!1,deletableCoupon:null,isDeletingCouponIds:[],isLoadingCoupons:!1,storeState:E()}},computed:{store(){return this.storeState.store},tableHeaders(){return this.showEverything?["","Name","Description","Instructions","Status","Offers","Created Date",""]:["","Name","Description","Status","Offers",""]},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{onView(n){this.$router.push({name:"show-store-coupon",params:{store_href:this.store._links.showStore,coupon_href:n._links.showCoupon}}).then(()=>{window.scrollTo(0,0)})},showDeleteConfirmationModal(n){this.deletableCoupon=n,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(n){return this.isDeletingCouponIds.findIndex(e=>e==n.id)!=-1},onAddCoupon(){this.$router.push({name:"create-store-coupon",params:{store_href:this.store._links.showStore}})},paginate(n){this.getCoupons(n)},search(n){this.searchTerm=n,this.getCoupons()},getCoupons(n=null){this.isLoadingCoupons=!0;const e={};this.hasSearchTerm&&(e.search=this.searchTerm),n=n??this.store._links.showStoreCoupons,q(n,e).then(w=>{w.status==200&&(this.pagination=w.data,this.coupons=this.pagination.data,this.checkedRowIds=this.coupons.map(D=>!1)),this.isLoadingCoupons=!1}).catch(w=>{this.isLoadingCoupons=!1,this.setServerFormErrors(w)})},deleteCoupon(){this.isDeletingCouponIds.push(this.deletableCoupon.id),G(this.deletableCoupon._links.deleteCoupon).then(n=>{this.isDeletingCouponIds.splice(this.isDeletingCouponIds.findIndex(e=>e==this.deletableCoupon.id,1)),n.status==200&&(n.data.deleted?(this.showSuccessfulNotification("Coupon deleted"),this.isDeletingCouponIds.length==0&&this.getCoupons()):(this.setFormError("general",n.data.message),this.showUnsuccessfulNotification(n.data.message)))}).catch(n=>{this.isDeletingCouponIds.splice(this.isDeletingCouponIds.findIndex(e=>e==this.deletableCoupon.id,1)),this.setServerFormErrors(n)})}},mounted(){},created(){this.getCoupons()}},$={class:"flex justify-between items-center border-dashed py-6"},ee={class:"flex items-center"},te=["onClick"],oe={class:"whitespace-nowrap align-top px-4 py-4"},se={class:"flex space-x-1 items-center w-40"},ne={class:"align-top px-4 py-4"},ie={class:"flex space-x-1 items-center w-80"},re={key:1},ae={key:0,class:"align-top px-4 py-4"},le={class:"w-80 bg-green-50 border border-green-200 rounded-md py-2 px-6 mb-2 shadow-md"},de={class:"space-y-2 list-disc"},pe={class:"whitespace-nowrap align-top px-4 py-4"},ce={class:"flex space-x-1 items-center"},ue={class:"whitespace-nowrap align-top px-4 py-4"},he={class:"flex items-center space-x-2"},me={class:"whitespace-normal space-y-2 border-t border-dashed pt-2 mt-4"},fe={key:1,class:"whitespace-nowrap align-top px-4 py-4"},ge={class:"flex space-x-1 items-center"},ye={class:"align-top px-4 py-4 flex items-center space-x-4"},we=["onClick"],Ce=["onClick"],_e={key:1,class:"flex justify-between space-x-20 bg-white shadow-lg rounded-lg border p-20"},xe={class:"space-y-4"},be={class:"mb-8"},ve={class:"font-bold text-black"};function ke(n,e,w,D,a,i){const T=p("TextHeader"),C=p("MoreInfoPopover"),S=p("ToogleSwitch"),k=p("AddButton"),I=p("Checkbox"),B=p("NoDataPlaceholder"),g=p("BadgeIndicator"),A=p("SpinningLoader"),L=p("BasicTable"),P=p("PrimaryButton"),V=p("ConfirmModal");return s(),r("div",null,[t("div",$,[t("div",ee,[l(T,null,{default:d(()=>e[2]||(e[2]=[t("span",{class:"mr-2"},"ðŸ¥°",-1),h(" Coupons")])),_:1}),l(C,{class:"ml-2 mt-1",title:"What Is This?",description:"Coupons are promotional incentives that customers can claim while placing orders, such as discounts or free delivery. This encourages purchases and enhances the customer shopping experience.",placement:"top"})]),(a.pagination??{}).total>0?(s(),r(y,{key:0},[l(S,{modelValue:a.showEverything,"onUpdate:modelValue":e[0]||(e[0]=o=>a.showEverything=o),size:"md",labelPopoverTitle:"What Is This?",labelPopoverDescription:"Turn on if you want to show more information about your coupons"},{default:d(()=>e[3]||(e[3]=[h(" Show Everything ")])),_:1},8,["modelValue"]),l(k,{action:i.onAddCoupon,class:"w-40"},{default:d(()=>e[4]||(e[4]=[t("span",{class:"ml-2"},"Add Coupon",-1)])),_:1},8,["action"])],64)):u("",!0)]),a.isLoadingCoupons||(a.pagination??{}).total>0||i.hasSearchTerm?(s(),m(L,{key:0,pagination:a.pagination,isLoading:a.isLoadingCoupons,onPaginate:i.paginate,onSearch:i.search,onRefresh:i.getCoupons,totalHeaders:i.tableHeaders.length},{head:d(()=>[t("tr",null,[(s(!0),r(y,null,x(i.tableHeaders,(o,_)=>(s(),r("th",{key:_,scope:"col",class:"whitespace-nowrap px-4 py-3"},f(o),1))),128))])]),body:d(()=>[(s(!0),r(y,null,x(a.coupons,(o,_)=>(s(),r("tr",{onClick:b(c=>i.onView(o),["stop"]),key:o.id,class:X(["group cursor-pointer border-b",a.checkedRowIds[_]?"bg-blue-100":"bg-white hover:bg-gray-50"])},[t("td",{onClick:e[1]||(e[1]=b(()=>{},["stop"])),class:"whitespace-nowrap pl-4"},[l(I,{size:"xs",modelValue:a.checkedRowIds[_],"onUpdate:modelValue":c=>a.checkedRowIds[_]=c},null,8,["modelValue","onUpdate:modelValue"])]),t("td",oe,[t("div",se,[t("span",null,f(o.name),1),l(C,{class:"opacity-0 group-hover:opacity-100",title:o.name,description:o.description,placement:"top"},null,8,["title","description"])])]),t("td",ne,[t("div",ie,[o.description==null?(s(),m(B,{key:0})):(s(),r("span",re,f(o.description),1))])]),a.showEverything?(s(),r("td",ae,[t("div",le,[t("ul",de,[(s(!0),r(y,null,x(o._attributes.instructions,(c,v)=>(s(),r("li",{key:v},f(c),1))),128))])])])):u("",!0),t("td",pe,[t("div",ce,[l(g,{type:o.active.status?"success":"warning",text:o.active.name,showDot:!1},null,8,["type","text"]),l(C,{class:"opacity-0 group-hover:opacity-100",description:o.active.description,placement:"top"},null,8,["description"])])]),t("td",ue,[t("div",he,[o.offerDiscount.status?(s(),r(y,{key:0},[o.discountType.toLowerCase()=="fixed"?(s(),m(g,{key:0,type:"success",text:o.discountFixedRate.amountWithCurrency+" Discount",showDot:!1},null,8,["text"])):o.discountType.toLowerCase()=="percentage"?(s(),m(g,{key:1,type:"success",text:o.discountPercentageRate.valueSymbol+" Discount",showDot:!1},null,8,["text"])):u("",!0)],64)):u("",!0),o.offerFreeDelivery.status?(s(),m(g,{key:1,type:"success",text:"Free Delivery",showDot:!1})):u("",!0),l(C,{class:"opacity-0 group-hover:opacity-100",title:"Instructions",placement:"top"},{description:d(()=>[t("div",me,[(s(!0),r(y,null,x(o._attributes.instructions,(c,v)=>(s(),r("p",{key:v},f(c),1))),128))])]),_:2},1024)])]),a.showEverything?(s(),r("td",fe,[t("div",ge,[t("span",null,f(n.formattedDatetime(o.createdAt)),1),l(C,{class:"opacity-0 group-hover:opacity-100",title:n.formattedRelativeDate(o.createdAt),placement:"top"},null,8,["title"])])])):u("",!0),t("td",ye,[i.isDeleting(o)?u("",!0):(s(),r("a",{key:0,href:"#",onClick:b(c=>i.onView(o),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"View",8,we)),i.isDeleting(o)?(s(),m(A,{key:1,type:"danger"},{default:d(()=>e[5]||(e[5]=[t("span",{class:"text-xs ml-2"},"Deleting...",-1)])),_:1})):(s(),r("a",{key:2,href:"#",onClick:b(c=>i.showDeleteConfirmationModal(o),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,Ce))])],10,te))),128))]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(s(),r("div",_e,[t("div",xe,[e[10]||(e[10]=t("h1",{class:"text-2xl font-bold"},"Add your coupons",-1)),t("p",null,[e[6]||(e[6]=h("Create amazing incentives for your customers, such as offering ")),l(g,{type:"primary",text:"discounts",showDot:!1,clickable:!0,action:i.onAddCoupon},null,8,["action"]),e[7]||(e[7]=h(" and ")),l(g,{type:"primary",text:"free delivery",showDot:!1,clickable:!0,action:i.onAddCoupon},null,8,["action"]),e[8]||(e[8]=h(", while determining who can claim them and when."))]),l(k,{action:i.onAddCoupon,class:"w-40",size:"sm"},{default:d(()=>e[9]||(e[9]=[t("span",{class:"ml-2"},"Add Coupon",-1)])),_:1},8,["action"])]),e[11]||(e[11]=t("div",null,[t("span",{class:"text-8xl"},"ðŸ¥°")],-1))])),a.deletableCoupon?(s(),m(V,{key:2,approveText:"Delete Coupon",approveAction:i.deleteCoupon,isLoading:i.isDeleting(a.deletableCoupon)},{content:d(()=>[e[14]||(e[14]=t("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),t("p",be,[e[12]||(e[12]=h("Are you sure you want to permanently delete ")),t("span",ve,f(a.deletableCoupon.name),1),e[13]||(e[13]=h("?"))])]),trigger:d(o=>[l(P,{ref:"confirmDeleteButton",action:o.showModal,class:"hidden",type:"danger"},{default:d(()=>e[15]||(e[15]=[h(" Delete Coupon ")])),_:2},1032,["action"])]),_:1},8,["approveAction","isLoading"])):u("",!0)])}const Ke=Y(Z,[["render",ke]]);export{Ke as default};
