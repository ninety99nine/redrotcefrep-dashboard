import{F as N}from"./FormMixin-CjTjSdFY.js";import{g as G,U as Y,d as P}from"./UtilsMixin-CbFS-0FV.js";import{u as E,r as c,o as h,c as S,e as M,w as V,b as f,d as U,F as X,k as Z,t as z}from"./app-C6V_Xgnk.js";import{p as $}from"./api-repository-XJFcyCGP.js";import{D as J}from"./Datepicker-DGFvyhKI.js";import{S as q}from"./ShineEffect-CPzRxglR.js";import{L as C}from"./LineSkeleton-Bfklbavr.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as K,a as Q,b as ee,d as W}from"./store-store-Cfp96sXh.js";import{S as te}from"./SelectInput-DCiei8Kq.js";var ie=K,re=function(){return ie.Date.now()},se=re,oe=/\s/;function ae(e){for(var t=e.length;t--&&oe.test(e.charAt(t)););return t}var le=ae,ne=le,de=/^\s+/;function me(e){return e&&e.slice(0,ne(e)+1).replace(de,"")}var he=me,ue=Q,ce=ee,fe="[object Symbol]";function ye(e){return typeof e=="symbol"||ce(e)&&ue(e)==fe}var ve=ye,pe=he,k=W,De=ve,w=NaN,Se=/^[-+]0x[0-9a-f]+$/i,Me=/^0b[01]+$/i,be=/^0o[0-7]+$/i,Oe=parseInt;function Te(e){if(typeof e=="number")return e;if(De(e))return w;if(k(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=k(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=pe(e);var i=Me.test(e);return i||be.test(e)?Oe(e.slice(2),i?2:8):Se.test(e)?w:+e}var ge=Te,Ve=W,g=se,F=ge,Ie="Expected a function",_e=Math.max,xe=Math.min;function Le(e,t,i){var n,s,u,d,o,l,a=0,p=!1,y=!1,b=!0;if(typeof e!="function")throw new TypeError(Ie);t=F(t)||0,Ve(i)&&(p=!!i.leading,y="maxWait"in i,u=y?_e(F(i.maxWait)||0,t):u,b="trailing"in i?!!i.trailing:b);function O(r){var m=n,v=s;return n=s=void 0,a=r,d=e.apply(v,m),d}function A(r){return a=r,o=setTimeout(D,t),p?O(r):d}function R(r){var m=r-l,v=r-a,L=t-m;return y?xe(L,u-v):L}function _(r){var m=r-l,v=r-a;return l===void 0||m>=t||m<0||y&&v>=u}function D(){var r=g();if(_(r))return x(r);o=setTimeout(D,R(r))}function x(r){return o=void 0,b&&n?O(r):(n=s=void 0,d)}function H(){o!==void 0&&clearTimeout(o),a=0,n=l=s=o=void 0}function B(){return o===void 0?d:x(g())}function T(){var r=g(),m=_(r);if(n=arguments,s=this,l=r,m){if(o===void 0)return A(l);if(y)return clearTimeout(o),o=setTimeout(D,t),O(l)}return o===void 0&&(o=setTimeout(D,t)),d}return T.cancel=H,T.flush=B,T}var ke=Le;const I=G(ke),we={mixins:[N,Y],components:{Datepicker:J,ShineEffect:q,LineSkeleton:C},props:{modelValue:{type:String},form:{type:Object},deliveryMethod:{type:Object}},emits:["isLoading","update:modelValue","scheduleOptions"],data(){return{minDate:null,maxDate:null,isLoading:!1,datesDisabled:[],apiRequestCounter:0,daysOfWeekDisabled:[],debounceInstance:null,apiState:E(),localModelValue:this.modelValue}},watch:{modelValue(e){this.updateValue(e)},localModelValue(e){this.$emit("update:modelValue",e)},...["scheduleType","dailyOrderLimit","sameDayDelivery","setDailyOrderLimit","timeSlotIntervalUnit","autoGenerateTimeSlots","timeSlotIntervalValue","latestDeliveryTimeValue","earliestDeliveryTimeUnit","earliestDeliveryTimeValue","requireMinimumNoticeForOrders","restrictMaximumNoticeForOrders"].reduce((e,t)=>(e[`form.${t}`]=function(){this.debouncedShowDeliveryMethodScheduleOptions()},e),{}),"form.operationalHours":{handler(){this.debouncedShowDeliveryMethodScheduleOptions()},deep:!0}},computed:{key(){return this.minDate+this.maxDate+this.datesDisabled.length+this.daysOfWeekDisabled.length}},methods:{updateValue(e){this.localModelValue=e},setIsLoading(e){this.isLoading=e,this.$emit("isLoading",e)},parseForm(){return{scheduleType:this.form?this.form.scheduleType:this.deliveryMethod.scheduleType,dailyOrderLimit:this.form?this.form.dailyOrderLimit:this.deliveryMethod.dailyOrderLimit,sameDayDelivery:this.form?this.form.sameDayDelivery:this.deliveryMethod.sameDayDelivery,operationalHours:this.form?this.form.operationalHours:this.deliveryMethod.operationalHours,setDailyOrderLimit:this.form?this.form.setDailyOrderLimit:this.deliveryMethod.setDailyOrderLimit,timeSlotIntervalUnit:this.form?this.form.timeSlotIntervalUnit:this.deliveryMethod.timeSlotIntervalUnit,autoGenerateTimeSlots:this.form?this.form.autoGenerateTimeSlots:this.deliveryMethod.autoGenerateTimeSlots,timeSlotIntervalValue:this.form?this.form.timeSlotIntervalValue:this.deliveryMethod.timeSlotIntervalValue,latestDeliveryTimeValue:this.form?this.form.latestDeliveryTimeValue:this.deliveryMethod.latestDeliveryTimeValue,earliestDeliveryTimeUnit:this.form?this.form.earliestDeliveryTimeUnit:this.deliveryMethod.earliestDeliveryTimeUnit,earliestDeliveryTimeValue:this.form?this.form.earliestDeliveryTimeValue:this.deliveryMethod.earliestDeliveryTimeValue,requireMinimumNoticeForOrders:this.form?this.form.requireMinimumNoticeForOrders:this.deliveryMethod.requireMinimumNoticeForOrders,restrictMaximumNoticeForOrders:this.form?this.form.restrictMaximumNoticeForOrders:this.deliveryMethod.restrictMaximumNoticeForOrders}},showDeliveryMethodScheduleOptions(){const e=++this.apiRequestCounter;$(this.apiState.apiHome._links.showDeliveryMethodScheduleOptions,this.parseForm()).then(t=>{if(e===this.apiRequestCounter){if(t.status==200){const i=t.data;this.minDate=this.formattedDate(i.minDate),this.daysOfWeekDisabled=i.daysOfWeekDisabled,this.datesDisabled=i.datesDisabled.map(n=>this.formattedDate(n)),this.maxDate=i.maxDate?this.formattedDate(i.maxDate):null,this.$emit("scheduleOptions",i)}this.setIsLoading(!1)}}).catch(t=>{this.setIsLoading(!1),this.setServerFormErrors(t)})},debouncedShowDeliveryMethodScheduleOptions(){this.debounceInstance&&this.debounceInstance.cancel(),this.setIsLoading(!0),this.debounceInstance=I(()=>{this.showDeliveryMethodScheduleOptions()},1e3),this.debounceInstance()}},created(){this.setIsLoading(!0),this.showDeliveryMethodScheduleOptions()}},Fe={class:"flex items-center space-x-2"},Ne=f("svg",{class:"w-4 h-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[f("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})],-1);function Ee(e,t,i,n,s,u){const d=c("LineSkeleton"),o=c("ShineEffect"),l=c("Datepicker");return h(),S("div",null,[s.isLoading?(h(),M(o,{key:0},{default:V(()=>[f("div",Fe,[Ne,U(d,{width:"w-1/2"})])]),_:1})):(h(),M(l,{key:u.key,minDate:s.minDate,maxDate:s.maxDate,modelValue:s.localModelValue,"onUpdate:modelValue":t[0]||(t[0]=a=>s.localModelValue=a),datesDisabled:s.datesDisabled,daysOfWeekDisabled:s.daysOfWeekDisabled},null,8,["minDate","maxDate","modelValue","datesDisabled","daysOfWeekDisabled"]))])}const ze=j(we,[["render",Ee]]),Ue={mixins:[N],components:{SelectInput:te,ShineEffect:q,LineSkeleton:C},props:{modelValue:{type:String},form:{type:Object},deliveryMethod:{type:Object},deliveryDate:{type:String}},emits:["isLoading","update:modelValue","scheduleOptions"],data(){return{isLoading:!1,apiRequestCounter:0,debounceInstance:null,apiState:E(),availableTimeSlots:null,localModelValue:this.modelValue}},watch:{modelValue(e){this.updateValue(e)},localModelValue(e){this.$emit("update:modelValue",e)},deliveryDate(e){e&&this.debouncedShowDeliveryMethodScheduleOptions()}},methods:{updateValue(e){this.localModelValue=e},setIsLoading(e){this.isLoading=e,this.$emit("isLoading",e)},parseForm(){return{deliveryDate:P(this.deliveryDate).format("YYYY-MM-DD"),scheduleType:this.form?this.form.scheduleType:this.deliveryMethod.scheduleType,dailyOrderLimit:this.form?this.form.dailyOrderLimit:this.deliveryMethod.dailyOrderLimit,sameDayDelivery:this.form?this.form.sameDayDelivery:this.deliveryMethod.sameDayDelivery,operationalHours:this.form?this.form.operationalHours:this.deliveryMethod.operationalHours,setDailyOrderLimit:this.form?this.form.setDailyOrderLimit:this.deliveryMethod.setDailyOrderLimit,timeSlotIntervalUnit:this.form?this.form.timeSlotIntervalUnit:this.deliveryMethod.timeSlotIntervalUnit,autoGenerateTimeSlots:this.form?this.form.autoGenerateTimeSlots:this.deliveryMethod.autoGenerateTimeSlots,timeSlotIntervalValue:this.form?this.form.timeSlotIntervalValue:this.deliveryMethod.timeSlotIntervalValue,latestDeliveryTimeValue:this.form?this.form.latestDeliveryTimeValue:this.deliveryMethod.latestDeliveryTimeValue,earliestDeliveryTimeUnit:this.form?this.form.earliestDeliveryTimeUnit:this.deliveryMethod.earliestDeliveryTimeUnit,earliestDeliveryTimeValue:this.form?this.form.earliestDeliveryTimeValue:this.deliveryMethod.earliestDeliveryTimeValue,requireMinimumNoticeForOrders:this.form?this.form.requireMinimumNoticeForOrders:this.deliveryMethod.requireMinimumNoticeForOrders,restrictMaximumNoticeForOrders:this.form?this.form.restrictMaximumNoticeForOrders:this.deliveryMethod.restrictMaximumNoticeForOrders}},showDeliveryMethodScheduleOptions(){const e=++this.apiRequestCounter;$(this.apiState.apiHome._links.showDeliveryMethodScheduleOptions,this.parseForm()).then(t=>{if(e===this.apiRequestCounter){if(t.status==200){const i=t.data;this.availableTimeSlots=i.availableTimeSlots,this.availableTimeSlots.length&&(this.localModelValue=this.availableTimeSlots[0]),this.$emit("scheduleOptions",i)}this.setIsLoading(!1)}}).catch(t=>{this.setIsLoading(!1),this.setServerFormErrors(t)})},debouncedShowDeliveryMethodScheduleOptions(){this.debounceInstance&&this.debounceInstance.cancel(),this.setIsLoading(!0),this.availableTimeSlots=[],this.debounceInstance=I(()=>{this.showDeliveryMethodScheduleOptions()},1e3),this.debounceInstance()},debouncedShowDeliveryMethodScheduleOptions:function(){this.setIsLoading(!0),this.availableTimeSlots=[],I((function(){this.showDeliveryMethodScheduleOptions()}).bind(this),1e3)()}},created(){this.setIsLoading(!0),this.showDeliveryMethodScheduleOptions()}},$e={class:"flex items-center space-x-2"},qe=f("svg",{class:"w-4 h-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[f("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1),Ce=["value"];function je(e,t,i,n,s,u){const d=c("LineSkeleton"),o=c("ShineEffect"),l=c("SelectInput");return h(),S("div",null,[s.isLoading?(h(),M(o,{key:0},{default:V(()=>[f("div",$e,[qe,U(d,{width:"w-1/2"})])]),_:1})):(h(),M(l,{key:1,width:"w-full",modelValue:s.localModelValue,"onUpdate:modelValue":t[0]||(t[0]=a=>s.localModelValue=a)},{default:V(()=>[(h(!0),S(X,null,Z(s.availableTimeSlots,(a,p)=>(h(),S("option",{key:p,value:a},z(a),9,Ce))),128))]),_:1},8,["modelValue"]))])}const Je=j(Ue,[["render",je]]);export{ze as D,Je as a};
