import{c as A,i as ae}from"./cloneDeep-CwGeNi_a.js";import{A as G}from"./Alert-DeOdG3YV.js";import{F as R}from"./FormMixin-Bl09yP4i.js";import{U as Q,S as ee}from"./SpiningLoader-CtP8XMxq.js";import{o as t,c as n,a as e,F as y,l as v,b as i,w as l,h as p,i as _,n as W,t as c,r as h,s as le,d as g,k as J,m as Y,x as de,B as ce,u as he}from"./app-DgwDG0oL.js";import{u as z}from"./store-store-mpyiI37o.js";import{T as ue}from"./TextInput-Cvcclkkj.js";import{I as me,N as pe,L as _e}from"./LoadingBackdrop-DBPPvFGQ.js";import{T as te}from"./TextHeader-Cv0Yig1G.js";import{B as fe}from"./BackButton-BSj9mnOl.js";import{S as ge}from"./SelectInput-DmcolkQQ.js";import{O as ye,a as we}from"./OrderPaymentStatus-DOQF9mPP.js";import{C as K}from"./ConfirmModal-2OBh35nG.js";import{S as F,L as B}from"./LineSkeleton-bH-zCpxp.js";import{T as se}from"./TextareaInput-1LGaiLq-.js";import{P as X}from"./PrimaryButton-BwxTXQIn.js";import{O as oe}from"./OtpInput-B5YmCNin.js";import{S as xe}from"./SelectInputTags-CyNH1W7R.js";import{B as ke}from"./ButtonSkeleton-CA0NoPu6.js";import{M as q}from"./MoreInfoPopover-CikMcfV_.js";import{B as H}from"./BadgeIndicator-Ix5r6giQ.js";import{N as be}from"./NoDataPlaceholder-57lVKYXs.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as ve}from"./AddButton-DPx_uoSY.js";import{B as Pe}from"./BasicTable-CinaqeuZ.js";import{E as Se}from"./ExternalLink-BT8XES63.js";import{g as U,d as re,p as N,a as Oe}from"./api-repository-BMbX10ff.js";import{T as Te}from"./ToogleSwitch-BjKN267o.js";import{T as Ce}from"./TransactionPaymentStatus-iVxcMSLh.js";import{R as Me}from"./RoundSkeleton-Df9p6otY.js";import"./InputLabel-h7tVZV7a.js";import"./InputErrorMessage-MOiSGfLL.js";import"./vue3-tags-input.esm-iowmHhUS.js";import"./StatusDot-B5diD_NC.js";const Le={mixins:[R],components:{Alert:G,ShineEffect:F,LineSkeleton:B,MoreInfoPopover:q,BadgeIndicator:H,NoDataPlaceholder:be},props:{order:{type:Object},isLoadingOrder:{type:Boolean}},data(){return{storeState:z()}},computed:{store(){return this.storeState.store}},methods:{canViewProduct(s){return s._links.showProduct?s._links.showProduct:!1},onViewProduct(s){this.canViewProduct(s)?this.$router.push({name:"show-store-product",params:{store_href:this.store._links.showStore,product_href:s._links.showProduct}}):this.showUnsuccessfulNotification("This product does not exist anymore. It might be deleted")}}},Ae={class:"space-y-3 bg-white shadow-lg rounded-lg border p-4 mb-4"},Be=e("p",{class:"font-bold text-lg"},"Items",-1),Ve={class:"w-full text-sm text-left rtl:text-right text-gray-500"},De=e("thead",{class:"font-bold text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("td",{class:"whitespace-nowrap px-4 py-3"},"Image"),e("td",{class:"w-80 whitespace-nowrap px-4 py-3"},"Name"),e("td",{class:"whitespace-nowrap px-4 py-3"},"Price"),e("td",{class:"whitespace-nowrap px-4 py-3 text-right"},"Quantity"),e("td",{class:"whitespace-nowrap px-4 py-3 text-right"},"Total")])],-1),Ee=["onClick"],Ie={class:"whitespace-nowrap px-4 py-3"},Ue={class:"w-80 whitespace-nowrap px-4 py-3"},Ne={class:"whitespace-nowrap px-4 py-3"},Re={class:"whitespace-nowrap px-4 py-3 text-right"},Fe={class:"whitespace-nowrap px-4 py-3 text-right"},qe={class:"text-xs text-right"},He=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-2"},"Sub Total",-1),Ze={colspan:"1",class:"whitespace-nowrap px-4 py-2"},je={key:1},We={class:"text-xs text-right"},ze=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-2"},"Coupon Discount Total",-1),Ye={colspan:"1",class:"whitespace-nowrap px-4 py-2"},Je={key:1},Ge={class:"text-xs text-right border-b"},Qe=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-2"},"Sale Discount Total",-1),Ke={colspan:"1",class:"whitespace-nowrap px-4 py-2"},Xe={key:1},$e={class:"text-right text-black text-lg font-bold"},et=e("td",{colspan:"4",class:"whitespace-nowrap px-4 py-3"},"Grand Total",-1),tt={colspan:"1",class:"whitespace-nowrap px-4 py-3"},st={key:1},ot=e("span",null,[e("svg",{class:"w-6 h-6 mr-2 inline-block",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"})]),e("span",{class:"font-bold mr-1"},"Special Note:")],-1);function rt(s,a,r,S,o,d){const w=h("LineSkeleton"),f=h("ShineEffect"),x=h("NoDataPlaceholder"),C=h("Alert");return t(),n("div",Ae,[Be,e("table",Ve,[De,e("tbody",null,[r.isLoadingOrder?(t(),n(y,{key:0},v(3,(b,k)=>e("tr",{key:k,class:"border-b"},[(t(),n(y,null,v(5,(O,L)=>e("td",{key:L,class:"whitespace-nowrap px-4 py-3"},[i(f,null,{default:l(()=>[r.isLoadingOrder?(t(),p(w,{key:0})):_("",!0)]),_:1})])),64))])),64)):(t(!0),n(y,{key:1},v(r.order._relationships.cart._relationships.productLines,(b,k)=>(t(),n("tr",{key:k,onClick:()=>d.onViewProduct(b),class:W(["border-b cursor-pointer",d.canViewProduct(b)?"hover:bg-gray-50":"hover:bg-red-50"])},[e("td",Ie,[i(x)]),e("td",Ue,[e("span",null,c(b.name),1)]),e("td",Ne,[e("span",null,c(b.unitPrice.amountWithCurrency),1)]),e("td",Re,[e("span",null,c(b.quantity),1)]),e("td",Fe,[e("span",null,c(b.grandTotal.amountWithCurrency),1)])],10,Ee))),128)),e("tr",qe,[He,e("td",Ze,[r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[i(w)]),_:1})):(t(),n("span",je,c(r.order._relationships.cart.subTotal.amountWithCurrency),1))])]),e("tr",We,[ze,e("td",Ye,[r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[i(w)]),_:1})):(t(),n("span",Je,c(r.order._relationships.cart.couponDiscountTotal.amount>0?"-":"")+" "+c(r.order._relationships.cart.couponDiscountTotal.amountWithCurrency),1))])]),e("tr",Ge,[Qe,e("td",Ke,[r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[i(w)]),_:1})):(t(),n("span",Xe,c(r.order._relationships.cart.saleDiscountTotal.amount>0?"-":"")+" "+c(r.order._relationships.cart.saleDiscountTotal.amountWithCurrency),1))])]),e("tr",$e,[et,e("td",tt,[r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[i(w)]),_:1})):(t(),n("span",st,c(r.order._relationships.cart.grandTotal.amountWithCurrency),1))])])])]),r.order&&r.order.specialNote?(t(),p(C,{key:0},{default:l(()=>[ot,e("span",null,c(r.order.specialNote),1)]),_:1})):_("",!0)])}const nt=V(Le,[["render",rt]]),it={mixins:[R,Q],components:{AddButton:ve,TextHeader:te,BasicTable:Pe,ExternalLink:Se,ConfirmModal:K,ShineEffect:F,LineSkeleton:B,SpiningLoader:ee,PrimaryButton:X,MoreInfoPopover:q,ToogleSwitch:Te,BadgeIndicator:H,TransactionPaymentStatus:Ce},props:{order:{type:Object},isLoadingOrder:{type:Boolean},refreshOrder:{type:Function}},data(){return{transactions:[],pagination:null,searchTerm:null,showEverything:!1,appName:le.appName,deletableTransaction:null,isDeletingTransactionIds:[],isLoadingTransactions:!1,storeState:z()}},computed:{store(){return this.storeState.store},tableHeaders(){return this.showEverything?["#","Description","Payment Status","Amount","Percentage","Payment Method","Paid By","Verified By","Requested By","DPO Payment Link","DPO Link Status","DPO Expiry Date","Created Date",""]:["#","Payment Status","Amount","Payment Method","Paid By","Verified By","Requested By","DPO Payment Link","DPO Link Status",""]},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{onView(s){this.$router.push({name:"show-store-transaction",params:{store_href:this.store._links.showStore,transaction_href:s._links.showTransaction}}).then(()=>{window.scrollTo(0,0)})},showDeleteConfirmationModal(s){this.deletableTransaction=s,this.$nextTick(()=>{this.$refs.confirmDeleteButton.$el.click()})},isDeleting(s){return this.isDeletingTransactionIds.findIndex(a=>a==s.id)!=-1},paginate(s){this.url=s,this.getTransactions()},search(s){this.url=this.store._links.showOrderTransactions,this.searchTerm=s,this.getTransactions()},getTransactions(){this.isLoadingTransactions=!0;const s={_relationships:"customer,requestedByUser,manuallyVerifiedByUser,paymentMethod"};this.hasSearchTerm&&(s.search=this.searchTerm),U(this.url,s).then(a=>{a.status==200&&(this.pagination=a.data,this.transactions=this.pagination.data),this.isLoadingTransactions=!1}).catch(a=>{this.isLoadingTransactions=!1})},deleteTransaction(){this.isDeletingTransactionIds.push(this.deletableTransaction.id),re(this.deletableTransaction._links.deleteTransaction).then(s=>{this.isDeletingTransactionIds.splice(this.isDeletingTransactionIds.findIndex(a=>a==this.deletableTransaction.id,1)),s.status==200&&(this.showSuccessfulNotification("Transaction deleted"),this.isDeletingTransactionIds.length==0&&this.getTransactions())}).catch(s=>{this.isDeletingTransactionIds.splice(this.isDeletingTransactionIds.findIndex(a=>a==this.deletableTransaction.id,1)),this.setServerFormErrors(s)})}},created(){this.url=this.order._links.showOrderTransactions,this.getTransactions()}},at={class:"flex justify-between items-center border-dashed border-b pb-4 mb-4"},lt={class:"flex items-center"},dt={class:"font-bold text-sm"},ct={key:0},ht=["onClick"],ut={class:"whitespace-nowrap px-4 py-4"},mt={class:"flex space-x-1 items-center"},pt={key:0,class:"px-4 py-4"},_t={class:"min-w-80"},ft={class:"whitespace-nowrap px-4 py-4"},gt={class:"whitespace-nowrap px-4 py-4 text-center"},yt={key:1,class:"whitespace-nowrap px-4 py-4 text-center"},wt={class:"whitespace-nowrap px-4 py-4 text-center"},xt={class:"whitespace-nowrap px-4 py-4"},kt={key:0},bt={key:1,class:"text-xs text-center text-gray-300"},vt={class:"text-xs text-center text-gray-300"},Pt={key:0,class:"whitespace-nowrap px-4 py-4"},St={class:"whitespace-nowrap px-4 py-4"},Ot={key:0},Tt={key:1,class:"text-xs text-center text-gray-300"},Ct={class:"px-4 py-4"},Mt={key:0,class:"max-w-80"},Lt={key:1,class:"text-xs text-center text-gray-300"},At={class:"text-xs text-center text-gray-300"},Bt={key:0,class:"text-xs text-center text-gray-300"},Vt={key:2,class:"whitespace-nowrap px-4 py-4"},Dt={key:0,class:"flex space-x-1 items-center"},Et={key:1,class:"text-xs text-center text-gray-300"},It={key:3,class:"whitespace-nowrap px-4 py-4"},Ut={class:"flex space-x-1 items-center"},Nt={class:"px-4 py-4 flex items-center space-x-4"},Rt=["onClick"],Ft=e("span",{class:"text-xs ml-2"},"Deleting...",-1),qt=["onClick"],Ht={key:1,class:"p-8 border rounded-lg bg-gray-50"},Zt=de('<div class="flex justify-between space-x-20 mb-2"><div><span class="text-8xl">ðŸ’µ</span></div><div class="space-y-3"><h1 class="text-lg font-bold">No Transactions Yet</h1><p class="text-sm">Your transactions will appear here once customers start paying for this order. <span class="underline decoration-dashed underline-offset-4">Request payments</span> or <span class="underline decoration-dashed underline-offset-4">mark this order as paid</span>.</p></div></div>',1),jt={class:"flex justify-end"},Wt=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1),zt={class:"mb-8"},Yt={class:"font-bold text-black"};function Jt(s,a,r,S,o,d){const w=h("MoreInfoPopover"),f=h("ToogleSwitch"),x=h("LineSkeleton"),C=h("ShineEffect"),b=h("TransactionPaymentStatus"),k=h("BadgeIndicator"),O=h("ExternalLink"),L=h("SpiningLoader"),D=h("BasicTable"),T=h("PrimaryButton"),E=h("ConfirmModal");return t(),n("div",null,[e("div",at,[e("div",lt,[e("p",dt,[g("Transactions "),(o.pagination??{}).total>0?(t(),n("span",ct,"("+c((o.pagination??{}).total)+")",1)):_("",!0)]),i(w,{class:"ml-2 mt-1",title:"What Is This?",description:"Transactions are records of payments made by customers for their orders.",placement:"top"})]),(o.pagination??{}).total>0?J(s.$slots,"actionButtons",{key:0}):_("",!0)]),o.isLoadingTransactions||(o.pagination??{}).total>0||d.hasSearchTerm?(t(),p(D,{key:0,pagination:o.pagination,isLoading:o.isLoadingTransactions,onPaginate:d.paginate,onSearch:d.search,onRefresh:d.getTransactions,totalHeaders:d.tableHeaders.length},{primaryFilters:l(()=>[i(f,{modelValue:o.showEverything,"onUpdate:modelValue":a[0]||(a[0]=m=>o.showEverything=m),size:"md",labelPopoverTitle:"What Is This?",labelPopoverDescription:"Turn on if you want to show more information about your transactions"},{default:l(()=>[g(" Show Everything ")]),_:1},8,["modelValue"])]),head:l(()=>[e("tr",null,[(t(!0),n(y,null,v(d.tableHeaders,(m,M)=>(t(),n("th",{key:M,scope:"col",class:"whitespace-nowrap px-4 py-3"},c(m),1))),128))])]),body:l(()=>[o.isLoadingTransactions?(t(),n(y,{key:0},v(3,(m,M)=>e("tr",{key:M,class:"border-b"},[(t(!0),n(y,null,v(d.tableHeaders,($,Z)=>(t(),n("td",{key:Z,class:"whitespace-nowrap px-4 py-3"},[i(C,null,{default:l(()=>[i(x)]),_:1})]))),128))])),64)):(t(!0),n(y,{key:1},v(o.transactions,m=>(t(),n("tr",{onClick:Y(M=>d.onView(m),["stop"]),key:m.id,class:"group cursor-pointer bg-white hover:bg-gray-50 border-b"},[e("td",ut,[e("div",mt,[e("span",null,"#"+c(m._attributes.number),1),i(w,{class:"opacity-0 group-hover:opacity-100",title:"#"+m._attributes.number,description:m.description,placement:"top"},null,8,["title","description"])])]),o.showEverything?(t(),n("td",pt,[e("div",_t,c(m.description),1)])):_("",!0),e("td",ft,[i(b,{transaction:m},null,8,["transaction"])]),e("td",gt,c(m.amount.amountWithCurrency),1),o.showEverything?(t(),n("td",yt,c(m.percentage.valueSymbol),1)):_("",!0),e("td",wt,c(m._relationships.paymentMethod.name),1),e("td",xt,[m._relationships.paidByUser?(t(),n("span",kt,c(m._relationships.paidByUser._attributes.name),1)):(t(),n("span",bt,"---"))]),e("td",vt,[m._relationships.verifiedByUser?(t(),n("span",Pt,c(m._relationships.verifiedByUser._attributes.name),1)):(t(),p(k,{key:1,type:"info",text:o.appName,showDot:!1},null,8,["text"]))]),e("td",St,[m._relationships.requestedByUser?(t(),n("span",Ot,c(m._relationships.requestedByUser._attributes.name),1)):(t(),n("span",Tt,"---"))]),e("td",Ct,[m.dpoPaymentUrl?(t(),n("div",Mt,[i(O,{url:m.dpoPaymentUrl,class:"text-xs"},{default:l(()=>[g(c(m.dpoPaymentUrl),1)]),_:2},1032,["url"])])):(t(),n("span",Lt,"---"))]),e("td",At,[m._attributes.dpoPaymentLinkHasExpired==null?(t(),n("span",Bt,"---")):(t(),p(k,{key:1,type:m._attributes.dpoPaymentLinkHasExpired==!1?"success":"warning",text:m._attributes.dpoPaymentLinkHasExpired==!1?"Active":"Expired",showDot:!1},null,8,["type","text"]))]),o.showEverything?(t(),n("td",Vt,[m.dpoPaymentUrlExpiresAt?(t(),n("div",Dt,[e("span",null,c(s.formattedDatetime(m.dpoPaymentUrlExpiresAt)),1),i(w,{class:"opacity-0 group-hover:opacity-100",title:s.formattedRelativeDate(m.dpoPaymentUrlExpiresAt),placement:"top"},null,8,["title"])])):(t(),n("span",Et,"---"))])):_("",!0),o.showEverything?(t(),n("td",It,[e("div",Ut,[e("span",null,c(s.formattedDatetime(m.createdAt)),1),i(w,{class:"opacity-0 group-hover:opacity-100",title:s.formattedRelativeDate(m.createdAt),placement:"top"},null,8,["title"])])])):_("",!0),e("td",Nt,[d.isDeleting(m)?_("",!0):(t(),n("a",{key:0,href:"#",onClick:Y(M=>d.onView(m),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"Edit",8,Rt)),d.isDeleting(m)?(t(),p(L,{key:1,type:"danger"},{default:l(()=>[Ft]),_:1})):(t(),n("a",{key:2,href:"#",onClick:Y(M=>d.showDeleteConfirmationModal(m),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,qt))])],8,ht))),128))]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(t(),n("div",Ht,[Zt,e("div",jt,[J(s.$slots,"actionButtons")])])),o.deletableTransaction?(t(),p(E,{key:2,approveText:"Delete Transaction",approveAction:d.deleteTransaction,isLoading:d.isDeleting(o.deletableTransaction)},{content:l(()=>[Wt,e("p",zt,[g("Are you sure you want to permanently delete "),e("span",Yt,"transaction #"+c(o.deletableTransaction._attributes.number),1),g("?")])]),trigger:l(m=>[i(T,{ref:"confirmDeleteButton",onClick:m.showModal,class:"hidden",type:"danger"},{default:l(()=>[g(" Delete Transaction ")]),_:2},1032,["onClick"])]),_:1},8,["approveAction","isLoading"])):_("",!0)])}const Gt=V(it,[["render",Jt]]),Qt={mixins:[R],components:{LineSkeleton:B,MoreInfoPopover:q,BadgeIndicator:H,OrderTransactions:Gt},props:{order:{type:Object},isLoadingOrder:{type:Boolean},refreshOrder:{type:Function}},data(){return{}}},Kt={class:"mb-4"},Xt={class:"bg-white shadow-lg rounded-lg border p-4"},$t={class:"space-y-3"},es=e("p",{class:"font-bold text-lg"},"Payment",-1),ts={class:"flex items-center space-x-2 text-sm"},ss=e("span",null,"Amount Paid: ",-1),os={key:1,class:"font-bold"},rs={key:1,class:"w-3/4 flex items-center space-x-4"},ns={class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700"},is={class:"text-xs"},as={key:0,class:"bg-white shadow-lg rounded-lg border p-4 mt-4"};function ls(s,a,r,S,o,d){const w=h("LineSkeleton"),f=h("OrderTransactions");return t(),n("div",Kt,[e("div",Xt,[e("div",$t,[es,e("div",ts,[ss,r.isLoadingOrder?(t(),p(w,{key:0,width:"w-32"})):(t(),n("span",os,c(r.order.paidTotal.amountWithCurrency),1))]),r.isLoadingOrder?(t(),p(w,{key:0,width:"w-full"})):(t(),n("div",rs,[e("div",ns,[e("div",{class:"bg-green-500 h-2.5 rounded-full",style:ce("width: "+r.order.paidPercentage.value+"%")},null,4)]),e("span",is,c(r.order.paidPercentage.valueSymbol),1)]))])]),r.isLoadingOrder?_("",!0):(t(),n("div",as,[i(f,{order:r.order,refreshOrder:r.refreshOrder},{actionButtons:l(()=>[J(s.$slots,"actionButtons")]),_:3},8,["order","refreshOrder"])]))])}const ds=V(Qt,[["render",ls]]),cs={components:{ShineEffect:F,LineSkeleton:B},props:{order:{type:Object},isLoadingOrder:{type:Boolean}},computed:{hasCustomer(){return this.order._relationships.customer!=null},customer(){return this.order._relationships.customer}}},hs={class:"bg-white shadow-lg rounded-lg border space-y-3 p-4"},us={class:"flex items-center space-x-2"},ms=e("div",{class:"p-1.5 bg-gray-100 rounded-full border border-gray-200"},[e("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})])],-1),ps={key:1,class:"font-bold"},_s={key:2,class:"font-bold text-lg"},fs={class:"space-y-2"},gs={key:0,class:"flex items-center space-x-2 text-sm"},ys=e("svg",{class:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"})],-1),ws={key:1,class:"font-bold"},xs={key:1,class:"flex items-center space-x-2 text-sm"},ks=e("svg",{class:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})],-1),bs={key:1,class:"font-bold"},vs={key:1,class:"text-xs"};function Ps(s,a,r,S,o,d){const w=h("LineSkeleton"),f=h("ShineEffect");return t(),n("div",hs,[e("div",us,[ms,r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[i(w,{width:"w-32"})]),_:1})):r.order._attributes.customerName?(t(),n("span",ps,c(r.order._attributes.customerName),1)):(t(),n("span",_s,"Customer"))]),e("div",fs,[r.isLoadingOrder||r.order.customerMobileNumber||r.order.customerEmail?(t(),n(y,{key:0},[r.isLoadingOrder||r.order.customerMobileNumber?(t(),n("div",gs,[ys,r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[i(w,{width:"w-32"})]),_:1})):(t(),n("span",ws,c(r.order.customerMobileNumber.national),1))])):_("",!0),r.isLoadingOrder||r.order.customerEmail?(t(),n("div",xs,[ks,r.isLoadingOrder?(t(),p(f,{key:0},{default:l(()=>[i(w,{width:"w-32"})]),_:1})):(t(),n("span",bs,c(r.order.customerEmail),1))])):_("",!0)],64)):(t(),n("span",vs,"No information"))])])}const Ss=V(cs,[["render",Ps]]),Os={mixins:[R,Q],components:{Alert:G,ConfirmModal:K,ShineEffect:F,TextareaInput:se,OtpInput:oe,LineSkeleton:B,PrimaryButton:X,RoundSkeleton:Me,MoreInfoPopover:q,BadgeIndicator:H},props:{order:{type:Object},refreshOrder:{type:Function},isLoadingOrder:{type:Boolean}},data(){return{collectionCode:"",collectionNote:"",storeState:z(),isUpdatingOrderStatus:!1}},computed:{store(){return this.storeState.store},isVerified(){return this.order.collectionVerified.status},collectionVerifiedByUser(){return this.order._relationships.collectionVerifiedByUser},canManageOrders(){return this.store._relationships.userStoreAssociation._attributes.canManageOrders}},methods:{verifyOrderCollection(s){this.isUpdatingOrderStatus=!0;var a={collectionCode:this.collectionCode};this.collectionNote.trim()!=""&&(a.collectionNote=this.collectionNote),N(this.order._links.verifyOrderCollection,a).then(r=>{r.status==200&&(s(),this.refreshOrder(),this.showSuccessfulNotification("Order collection confirmed")),this.isUpdatingOrderStatus=!1}).catch(r=>{this.isUpdatingOrderStatus=!1,this.setServerFormErrors(r)})}}},Ts={class:"bg-white shadow-lg rounded-lg border space-y-3 p-4 mb-4"},Cs={key:0,class:"flex items-center space-x-2"},Ms=e("p",{class:"font-bold text-lg"},"Collection",-1),Ls={key:1,class:"flex items-center space-x-2 font-bold text-lg"},As=e("svg",{class:"w-6 h-6 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1),Bs=e("span",null,"Collected",-1),Vs=[As,Bs],Ds=e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})]),e("p",{class:"font-bold text-lg"},"Confirm Collection")],-1),Es={class:"text-xs"},Is={key:3,class:"flex space-x-1"},Us={key:0,class:"flex space-x-1 items-center"},Ns=e("span",{class:"text-xs"},"Type: ",-1),Rs={class:"font-bold text-xs"},Fs={key:1},qs=e("span",{class:"text-xs"},"Location: ",-1),Hs={class:"font-bold text-xs"},Zs={key:5,class:"space-y-2 pb-2"},js={class:"flex items-center space-x-2 text-xs"},Ws=e("div",{class:"flex items-center space-x-1"},[e("svg",{class:"w-4 h-4 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})]),e("span",null,"Verified By: ")],-1),zs={class:"font-bold"},Ys={class:"flex items-center space-x-2 text-xs"},Js=e("div",{class:"flex items-center space-x-1"},[e("svg",{class:"w-4 h-4 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]),e("span",null,"Verified Date:")],-1),Gs={key:0,class:"flex space-x-2"},Qs={class:"font-bold"},Ks={key:0,class:"flex space-x-1 border-t border-dashed pt-4"},Xs=e("svg",{class:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})],-1),$s={class:"text-xs"},eo={key:6,class:"border-b border-dashed"},to={class:"space-y-4 mb-8"},so=e("p",{class:"text-lg font-bold border-b border-dashed pb-4"},"Confirm Collection",-1),oo=e("span",{class:"font-bold mr-1"},"How to verify collection",-1),ro={class:"flex justify-end"};function no(s,a,r,S,o,d){const w=h("RoundSkeleton"),f=h("ShineEffect"),x=h("LineSkeleton"),C=h("MoreInfoPopover"),b=h("Alert"),k=h("OtpInput"),O=h("TextareaInput"),L=h("PrimaryButton"),D=h("ConfirmModal");return t(),n("div",Ts,[r.isLoadingOrder?(t(),n("div",Cs,[i(f,null,{default:l(()=>[i(w,{size:"w-6 h-6"})]),_:1}),Ms])):!r.isLoadingOrder&&d.isVerified?(t(),n("div",Ls,Vs)):_("",!0),!r.isLoadingOrder&&!d.isVerified?(t(),n(y,{key:2},[Ds,e("p",Es,c(r.order.collectionVerified.description),1)],64)):_("",!0),r.isLoadingOrder?(t(),n("div",Is,[i(x,{width:"w-12"}),i(x,{width:"w-24"}),i(x,{width:"w-4"})])):r.order.collectionType||r.order.destinationName?(t(),n("div",{key:4,class:W(["flex items-end space-x-4 text-sm",r.isLoadingOrder||!r.isLoadingOrder&&d.isVerified?"border-b border-dashed pb-2":"border-t border-dashed pt-2 mt-2"])},[r.order.collectionType?(t(),n("div",Us,[Ns,e("span",Rs,c(r.order.collectionType.name),1),i(C,{title:r.order.collectionType.description,placement:"top"},null,8,["title"])])):_("",!0),r.order.destinationName?(t(),n("div",Fs,[qs,e("span",Hs,c(r.order.destinationName),1)])):_("",!0)],2)):_("",!0),r.isLoadingOrder||!r.isLoadingOrder&&d.isVerified?(t(),n("div",Zs,[e("div",js,[Ws,r.isLoadingOrder?(t(),p(x,{key:0,width:"w-24"})):(t(),n(y,{key:1},[e("span",zs,c(d.collectionVerifiedByUser._attributes.name),1),i(C,{title:"Contact: "+d.collectionVerifiedByUser.mobileNumber.national,placement:"top"},null,8,["title"])],64))]),e("div",Ys,[Js,r.isLoadingOrder?(t(),n("div",Gs,[i(x,{width:"w-32"}),i(x,{width:"w-4"})])):(t(),n(y,{key:1},[e("span",Qs,c(s.formattedDatetime(r.order.collectionVerifiedAt)),1),i(C,{title:s.formattedRelativeDate(r.order.collectionVerifiedAt),placement:"top"},null,8,["title"])],64))]),r.isLoadingOrder||r.order.collectionNote?(t(),n("div",Ks,[r.isLoadingOrder?(t(),n(y,{key:0},[r.isLoadingOrder?(t(),p(x,{key:0,width:"w-4"})):_("",!0),r.isLoadingOrder?(t(),p(x,{key:1,width:"w-32"})):_("",!0)],64)):(t(),n(y,{key:1},[Xs,e("p",$s,c(r.order.collectionNote),1)],64))])):_("",!0)])):_("",!0),!r.isLoadingOrder&&!d.isVerified?(t(),n("div",eo)):_("",!0),!r.isLoadingOrder&&!d.isVerified?(t(),p(D,{key:7,declineText:"Cancel",declineType:"light",isLoading:o.isUpdatingOrderStatus,autoHide:!1,approveAction:T=>d.verifyOrderCollection(T),approveText:"Confirm Collection",approveType:"primary",approveDisabled:o.collectionCode.length<6||o.isUpdatingOrderStatus},{content:l(()=>[e("div",to,[so,i(b,null,{default:l(()=>[oo,g(" - "+c(r.order._attributes.dialToShowCollectionCode.instruction),1)]),_:1}),i(k,{modelValue:o.collectionCode,"onUpdate:modelValue":a[0]||(a[0]=T=>o.collectionCode=T),errorText:s.getFormError("collectionCode"),class:"mb-8"},null,8,["modelValue","errorText"]),i(O,{modelValue:o.collectionNote,"onUpdate:modelValue":a[1]||(a[1]=T=>o.collectionNote=T),label:"Note (Optional)",placeholder:"Collected by John Doe",rows:2,errorText:s.getFormError("collectionNote"),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Important note regarding this order collection e.g Collected by John Doe"},null,8,["modelValue","errorText"])])]),trigger:l(T=>[e("div",ro,[i(L,{ref:"confirmCollection",size:"xs",type:"light",onClick:T.showModal,disabled:o.isUpdatingOrderStatus},{default:l(()=>[g(" Confirm Collection ")]),_:2},1032,["onClick","disabled"])])]),_:1},8,["isLoading","approveAction","approveDisabled"])):_("",!0)])}const io=V(Os,[["render",no]]),ao={mixins:[Q,R],components:{Alert:G,TextInput:ue,TextHeader:te,InputTags:me,BackButton:fe,NumberInput:pe,SelectInput:ge,OrderStatus:ye,ConfirmModal:K,ShineEffect:F,TextareaInput:se,LineSkeleton:B,PrimaryButton:X,SpiningLoader:ee,OtpInput:oe,SelectInputTags:xe,ButtonSkeleton:ke,MoreInfoPopover:q,LoadingBackdrop:_e,CartSummary:nt,OrderPaymentStatus:we,BadgeIndicator:H,PaymentSummary:ds,CustomerSummary:Ss,CollectionSummary:io},data(){return{form:{number:""},markAsPaid:{percentage:null,paymentMethods:[],paymentMethodId:null,proofOfPaymentPhoto:null},_requestPayment:{percentage:null,paymentMethods:[],paymentMethodId:null},order:null,isDeleting:!1,originalForm:null,collectionCode:"",collectionNote:"",isSubmitting:!1,markAsPaidAmount:0,followUpStatus:null,isLoadingOrder:!1,cancellationReason:"",isMarkingAsPaid:!1,cancellationReasons:[],apiState:he(),markAsPaidPercentage:0,proofOfPaymentPhoto:null,isRequestingPayment:!1,storeState:z(),isUpdatingOrderStatus:!1,payableAmountPercentage:null,isLoadingCancellationReasons:!1}},watch:{"$route.params.order_href"(s,a){window.scrollTo(0,0),this.getOrder()}},computed:{store(){return this.storeState.store},isVerified(){return((this.order||{}).collectionVerified||{}).status},canMarkAsPaid(){return((this.order||{})._attributes||{}).canMarkAsPaid},followUpStatuses(){return((this.order||{})._attributes||{}).followUpStatuses},canRequestPayment(){return((this.order||{})._attributes||{}).canRequestPayment},mobileVerificationShortcode(){return this.apiState.apiHome.mobileVerificationShortcode},isCreating(){return this.$route.name==="create-store-order"},isEditting(){return this.$route.name==="show-store-order"},statusBadgeType(){var s=((this.order||{}).status||{}).name.toLowerCase();return s=="completed"?"success":s=="cancelled"?"warning":s=="on its way"||s=="ready for pickup"?"primary":"info"},formHasChanged(){var s=A(this.form),a=A(this.originalForm);return!ae(s,a)},mustSaveChanges(){return this.isEditting&&this.formHasChanged&&!this.isLoadingOrder&&!this.isSubmitting},mustCreate(){return this.isCreating&&this.formHasChanged&&!this.isLoadingOrder&&!this.isSubmitting}},methods:{goBack(){this.$router.replace({name:"show-store-orders",params:{store_href:this.store._links.showStore}})},setOrderFields(){this.form.number=this.order.number,this.order._attributes.payableAmounts.length&&(this._requestPayment.percentage=this.order._attributes.payableAmounts[0].percentage.toString(),this.markAsPaid.percentage=this.order._attributes.payableAmounts[0].percentage.toString()),this.originalForm=A(this.form)},confirmUpdateStatus(s){this.followUpStatus=s,this.followUpStatus.name.toLowerCase()=="cancelled"&&this.cancellationReasons.length==0&&this.getCancellationReasons(),this.$nextTick(()=>{this.$refs.confirmUpdateOrderStatus.$el.click()})},confirmMarkAsPaid(){this.$refs.confirmMarkAsPaid.$el.click()},confirmRequestPayment(){this.$refs.confirmRequestPayment.$el.click()},getOrder(){this.isLoadingOrder=!0;const s={_relationships:"cart,customer,occasion,collectionVerifiedByUser"};U(this.$route.params.order_href,s).then(a=>{a.status==200&&(a.data.exists?(this.order=a.data.order,this.setOrderFields(),this.canRequestPayment&&this._requestPayment.paymentMethods.length==0&&this.showPaymentMethodsForRequestingOrderPayment(),this.markAsPaid.paymentMethods.length==0&&this.showPaymentMethodsForMarkingAsPaid()):(this.notificationState.addWarningNotification("This order does not exist"),this.$router.push({name:"show-store-orders",params:{store_href:this.store._links.showStore}}))),this.isLoadingOrder=!1}).catch(a=>{this.isLoadingOrder=!1,this.setServerFormErrors(a)})},showPaymentMethodsForRequestingOrderPayment(){this.isLoadingPaymentMethodsForMarkingAsPaidForRequestingOrderPayment=!0,U(this.order._links.showPaymentMethodsForRequestingOrderPayment).then(s=>{s.status==200&&(this._requestPayment.paymentMethods=s.data.data,this._requestPayment.paymentMethods.length&&(this._requestPayment.paymentMethodId=this._requestPayment.paymentMethods[0].id.toString())),this.isLoadingPaymentMethodsForMarkingAsPaidForRequestingOrderPayment=!1}).catch(s=>{this.isLoadingPaymentMethodsForMarkingAsPaidForRequestingOrderPayment=!1,this.setServerFormErrors(s)})},showPaymentMethodsForMarkingAsPaid(){this.isLoadingPaymentMethodsForMarkingAsPaid=!0,U(this.order._links.showPaymentMethodsForMarkingAsPaid).then(s=>{s.status==200&&(this.markAsPaid.paymentMethods=s.data.data,this.markAsPaid.paymentMethods.length&&(this.markAsPaid.paymentMethodId=this.markAsPaid.paymentMethods[0].id.toString())),this.isLoadingPaymentMethodsForMarkingAsPaid=!1}).catch(s=>{this.isLoadingPaymentMethodsForMarkingAsPaid=!1,this.setServerFormErrors(s)})},getCancellationReasons(){this.isLoadingCancellationReasons=!0,U(this.order._links.showOrderCancellationReasons).then(s=>{s.status==200&&(this.cancellationReasons=s.data),this.isLoadingCancellationReasons=!1}).catch(s=>{this.isLoadingCancellationReasons=!1,this.setServerFormErrors(s)})},parseForm(){var s=A(this.form);return s.hoursOfDay=s.hoursOfDay.map(a=>a.text),s.daysOfTheWeek=s.daysOfTheWeek.map(a=>a.text),s.daysOfTheMonth=s.daysOfTheMonth.map(a=>a.text),s.monthsOfTheYear=s.monthsOfTheYear.map(a=>a.text),s},createOrder(){this.isSubmitting=!0,N(this.store._links.createOrders,this.parseForm()).then(s=>{s.status==200&&(this.showSuccessfulNotification("Order created"),this.$router.push({name:"show-store-orders",params:{store_href:this.store._links.showStore}}),window.scrollTo(0,0)),this.isSubmitting=!1}).catch(s=>{this.isSubmitting=!1,this.setServerFormErrors(s)})},updateOrder(){this.isSubmitting=!0,Oe(this.order._links.showOrder,this.parseForm()).then(s=>{s.status==200&&(this.originalForm=A(this.form),this.showSuccessfulNotification("Order updated")),this.isSubmitting=!1}).catch(s=>{this.isSubmitting=!1,this.setServerFormErrors(s)})},updateOrderStatus(s,a){this.isUpdatingOrderStatus=!0;var r={status:s};s.toLowerCase()=="completed"&&!this.isVerified&&(r.collectionCode=this.collectionCode,this.collectionNote.trim()!=""&&(r.collectionNote=this.collectionNote)),s.toLowerCase()=="cancelled"&&this.cancellationReason.trim()!=""&&(r.cancellationReason=this.cancellationReason),N(this.order._links.updateOrderStatus,r).then(S=>{S.status==200&&(S.data.updated?(a(),this.getOrder(),this.showSuccessfulNotification("Order updated")):this.notificationState.addWarningNotification(S.data.message)),this.isUpdatingOrderStatus=!1}).catch(S=>{this.isUpdatingOrderStatus=!1,this.setServerFormErrors(S)})},requestPayment(s){this.isRequestingPayment=!0;var a={percentage:this._requestPayment.percentage,paymentMethodId:this._requestPayment.paymentMethodId};return N(this.order._links.requestPayment,a).then(r=>{r.status==200&&(s(),this.getOrder(),this.showSuccessfulNotification("Payment requested")),this.isRequestingPayment=!1}).catch(r=>{this.isRequestingPayment=!1,this.setServerFormErrors(r)})},markAsUnverifiedPayment(s){this.isMarkingAsPaid=!0;var a={percentage:this.markAsPaid.percentage,paymentMethodId:this.markAsPaid.paymentMethodId,proofOfPaymentPhoto:this.markAsPaid.proofOfPaymentPhoto};this.markAsPaidAmount?a.amount=this.markAsPaidAmount:this.markAsPaidPercentage&&(a.percentage=this.markAsPaidPercentage),N(this.order._links.markAsUnverifiedPayment,a).then(r=>{r.status==200&&(this.getOrder(),s&&s(),this.showSuccessfulNotification("Order marked as paid")),this.isMarkingAsPaid=!1}).catch(r=>{this.isMarkingAsPaid=!1,this.setServerFormErrors(r)})},deleteOrder(){this.isDeleting=!0,re(this.order._links.deleteOrder).then(s=>{s.status==200&&(this.showSuccessfulNotification("Order deleted"),this.$router.push({name:"show-store-orders",params:{store_href:this.store._links.showStore}}),window.scrollTo(0,0)),this.isDeleting=!1}).catch(s=>{this.isDeleting=!1,this.setServerFormErrors(s)})}},created(){this.originalForm=A(this.form),this.isEditting&&this.getOrder()}},lo={class:"flex justify-between items-center border-dashed py-6"},co={class:"flex justify-start"},ho={key:0,class:"flex items-center space-x-2"},uo=e("span",{class:"text-2xl font-bold tracking-tight text-gray-300 animate-pulse"},"Order #",-1),mo={key:1,class:"flex items-center"},po={key:0,class:"flex space-x-1 items-center"},_o=e("span",null,"Created:",-1),fo={class:"font-bold"},go={class:"relative",action:"#",method:"POST"},yo={class:"flex items-center space-x-2"},wo=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})],-1),xo={class:"grid grid-cols-12 gap-4 mb-8"},ko={class:"col-span-8"},bo={class:"bg-white shadow-lg rounded-lg border space-y-4 p-4 mb-4"},vo={class:"flex items-center justify-between"},Po={class:"w-full flex items-center space-x-2"},So=e("span",{class:"text-xs"},"Status:",-1),Oo={class:"w-full flex items-center space-x-2"},To=e("span",{class:"text-xs"},"Payment Status:",-1),Co={class:"flex items-center"},Mo=e("span",null,[e("svg",{class:"w-4 h-4 mr-2 inline-block",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.05 4.575a1.575 1.575 0 1 0-3.15 0v3m3.15-3v-1.5a1.575 1.575 0 0 1 3.15 0v1.5m-3.15 0 .075 5.925m3.075.75V4.575m0 0a1.575 1.575 0 0 1 3.15 0V15M6.9 7.575a1.575 1.575 0 1 0-3.15 0v8.175a6.75 6.75 0 0 0 6.75 6.75h2.018a5.25 5.25 0 0 0 3.712-1.538l1.732-1.732a5.25 5.25 0 0 0 1.538-3.712l.003-2.024a.668.668 0 0 1 .198-.471 1.575 1.575 0 1 0-2.228-2.228 3.818 3.818 0 0 0-1.12 2.687M6.9 7.575V12m6.27 4.318A4.49 4.49 0 0 1 16.35 15m.002 0h-.002"})]),e("span",{class:"mr-1"},"Cancellation Reason:")],-1),Lo={class:"font-bold"},Ao={class:"flex justify-end space-x-2"},Bo=e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 7.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"}),e("path",{"fill-rule":"evenodd",d:"M1.5 4.875C1.5 3.839 2.34 3 3.375 3h17.25c1.035 0 1.875.84 1.875 1.875v9.75c0 1.036-.84 1.875-1.875 1.875H3.375A1.875 1.875 0 0 1 1.5 14.625v-9.75ZM8.25 9.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM18.75 9a.75.75 0 0 0-.75.75v.008c0 .414.336.75.75.75h.008a.75.75 0 0 0 .75-.75V9.75a.75.75 0 0 0-.75-.75h-.008ZM4.5 9.75A.75.75 0 0 1 5.25 9h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H5.25a.75.75 0 0 1-.75-.75V9.75Z","clip-rule":"evenodd"}),e("path",{d:"M2.25 18a.75.75 0 0 0 0 1.5c5.4 0 10.63.722 15.6 2.075 1.19.324 2.4-.558 2.4-1.82V18.75a.75.75 0 0 0-.75-.75H2.25Z"})],-1),Vo=e("span",null,"Mark As Paid",-1),Do=e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 7.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"}),e("path",{"fill-rule":"evenodd",d:"M1.5 4.875C1.5 3.839 2.34 3 3.375 3h17.25c1.035 0 1.875.84 1.875 1.875v9.75c0 1.036-.84 1.875-1.875 1.875H3.375A1.875 1.875 0 0 1 1.5 14.625v-9.75ZM8.25 9.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM18.75 9a.75.75 0 0 0-.75.75v.008c0 .414.336.75.75.75h.008a.75.75 0 0 0 .75-.75V9.75a.75.75 0 0 0-.75-.75h-.008ZM4.5 9.75A.75.75 0 0 1 5.25 9h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H5.25a.75.75 0 0 1-.75-.75V9.75Z","clip-rule":"evenodd"}),e("path",{d:"M2.25 18a.75.75 0 0 0 0 1.5c5.4 0 10.63.722 15.6 2.075 1.19.324 2.4-.558 2.4-1.82V18.75a.75.75 0 0 0-.75-.75H2.25Z"})],-1),Eo=e("span",null,"Mark As Paid",-1),Io=e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4.5 3.75a3 3 0 0 0-3 3v.75h21v-.75a3 3 0 0 0-3-3h-15Z"}),e("path",{"fill-rule":"evenodd",d:"M22.5 9.75h-21v7.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3v-7.5Zm-18 3.75a.75.75 0 0 1 .75-.75h6a.75.75 0 0 1 0 1.5h-6a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 0-1.5h-3Z","clip-rule":"evenodd"})],-1),Uo=e("span",null,"Request Payment",-1),No=e("svg",{class:"w-4 h-4 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4.5 3.75a3 3 0 0 0-3 3v.75h21v-.75a3 3 0 0 0-3-3h-15Z"}),e("path",{"fill-rule":"evenodd",d:"M22.5 9.75h-21v7.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3v-7.5Zm-18 3.75a.75.75 0 0 1 .75-.75h6a.75.75 0 0 1 0 1.5h-6a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 0-1.5h-3Z","clip-rule":"evenodd"})],-1),Ro=e("span",null,"Request Payment",-1),Fo={class:"col-span-4 space-y-4"},qo={class:"flex flex-col justify-between bg-white shadow-lg rounded-lg border p-4"},Ho={class:"space-y-4"},Zo=e("p",{class:"font-bold text-lg mb-4"},"Change Status",-1),jo={key:0},Wo={class:"flex space-x-2"},zo={key:1},Yo={class:"cursor-pointer hover:opacity-50 mr-1"},Jo=["onClick"],Go={class:"flex items-center whitespace-pre"},Qo=e("span",null,"Do you want to permanently delete",-1),Ko={key:1,class:"font-bold text-black"},Xo=e("span",null,"? Once this order is deleted you will not be able to recover it.",-1),$o={class:"flex justify-end"},er=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1),tr={class:"mb-8"},sr={class:"font-bold text-black"},or={class:"text-lg border-b border-dashed pb-4 mb-4"},rr={class:"font-bold"},nr={class:"mb-4"},ir=e("div",{class:"border-b border-dashed"},null,-1),ar=e("option",null,null,-1),lr=["value"],dr=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Request Payment",-1),cr=e("span",{class:"font-bold"},"Direct Pay Online",-1),hr=e("span",{class:"font-bold"},"Orange Money",-1),ur={class:"space-y-4 mb-4"},mr=["value"],pr=["value"],_r=e("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Mark As Paid",-1),fr={class:"space-y-4 mb-4"},gr=["value"],yr=["value"];function wr(s,a,r,S,o,d){const w=h("BackButton"),f=h("LineSkeleton"),x=h("ShineEffect"),C=h("TextHeader"),b=h("MoreInfoPopover"),k=h("PrimaryButton"),O=h("Alert"),L=h("OrderStatus"),D=h("OrderPaymentStatus"),T=h("CartSummary"),E=h("ButtonSkeleton"),m=h("PaymentSummary"),M=h("CustomerSummary"),$=h("CollectionSummary"),Z=h("BadgeIndicator"),j=h("ConfirmModal"),ne=h("OtpInput"),ie=h("TextareaInput"),I=h("SelectInput");return t(),n("div",null,[e("div",lo,[e("div",co,[i(w,{class:"w-16 mr-4",action:d.goBack},null,8,["action"]),o.isLoadingOrder?(t(),n("div",ho,[uo,i(x,{class:"flex space-x-2"},{default:l(()=>[i(f,{width:"w-12 mt-2"}),i(f,{width:"w-4 mt-2"})]),_:1})])):(t(),n("div",mo,[i(C,null,{default:l(()=>[g(c(d.isCreating?"Add Order":"Order #"+o.order._attributes.number),1)]),_:1}),i(b,{class:"ml-2 mt-1",title:"What Is This?",description:"Orders are requests placed by customers to purchase products or services from your store.",placement:"top"})]))]),d.isEditting?(t(),n("div",po,[o.isLoadingOrder?(t(),p(x,{key:0,class:"flex space-x-2"},{default:l(()=>[i(f,{width:"w-20"}),i(f,{width:"w-32"}),i(f,{width:"w-4"})]),_:1})):(t(),n(y,{key:1},[_o,e("span",fo,c(s.formattedDatetime(o.order.createdAt)),1),i(b,{title:s.formattedRelativeDate(o.order.createdAt),placement:"top"},null,8,["title"])],64))])):_("",!0)]),e("form",go,[d.mustCreate||d.mustSaveChanges?(t(),p(O,{key:0,type:"warning",class:"flex justify-between items-center mb-2"},{default:l(()=>[e("div",yo,[wo,e("span",null,c(d.isCreating?"Create your order":"Please save your changes"),1)]),i(k,{action:d.isCreating?d.createOrder:d.updateOrder,loading:o.isSubmitting,class:"w-40"},{default:l(()=>[g(c(d.isCreating?"Create Order":"Save Changes"),1)]),_:1},8,["action","loading"])]),_:1})):_("",!0),e("div",xo,[e("div",ko,[s.getFormError("general")?(t(),p(O,{key:0,type:"warning",class:"shadow mb-4"},{default:l(()=>[g(c(s.getFormError("general")),1)]),_:1})):_("",!0),e("div",bo,[e("div",vo,[e("div",Po,[So,o.isLoadingOrder?(t(),p(x,{key:0},{default:l(()=>[i(f,{width:"w-24"})]),_:1})):(t(),p(L,{key:1,order:o.order},null,8,["order"]))]),e("div",Oo,[To,o.isLoadingOrder?(t(),p(x,{key:0},{default:l(()=>[i(f,{width:"w-24"})]),_:1})):(t(),p(D,{key:1,order:o.order},null,8,["order"]))])]),o.order&&o.order.cancellationReason?(t(),p(O,{key:0,type:"warning"},{default:l(()=>[e("div",Co,[Mo,e("span",Lo,c(o.order.cancellationReason),1)])]),_:1})):_("",!0)]),i(T,{order:o.order,isLoadingOrder:o.isLoadingOrder},null,8,["order","isLoadingOrder"]),i(m,{order:o.order,isLoadingOrder:o.isLoadingOrder,refreshOrder:d.getOrder},{actionButtons:l(()=>[e("div",Ao,[d.isEditting&&o.isLoadingOrder?(t(),p(E,{key:0,size:"xs"},{default:l(()=>[Bo,Vo]),_:1})):o.order&&d.canMarkAsPaid?(t(),p(k,{key:1,action:d.confirmMarkAsPaid,disabled:o.isMarkingAsPaid,loading:o.isMarkingAsPaid,type:d.canRequestPayment?"light":"success",size:"xs"},{default:l(()=>[Do,Eo]),_:1},8,["action","disabled","loading","type"])):_("",!0),d.isEditting&&o.isLoadingOrder?(t(),p(E,{key:2,size:"xs"},{default:l(()=>[Io,Uo]),_:1})):o.order&&d.canRequestPayment?(t(),p(k,{key:3,action:d.confirmRequestPayment,disabled:o.isMarkingAsPaid,loading:o.isMarkingAsPaid,type:"success",size:"xs"},{default:l(()=>[No,Ro]),_:1},8,["action","disabled","loading"])):_("",!0)])]),_:1},8,["order","isLoadingOrder","refreshOrder"])]),e("div",Fo,[i(M,{order:o.order,isLoadingOrder:o.isLoadingOrder},null,8,["order","isLoadingOrder"]),i($,{order:o.order,isLoadingOrder:o.isLoadingOrder,refreshOrder:d.getOrder},null,8,["order","isLoadingOrder","refreshOrder"]),e("div",qo,[e("div",Ho,[Zo,o.isLoadingOrder?(t(),n("div",jo,[i(x,{class:"space-y-4"},{default:l(()=>[e("div",Wo,[(t(),n(y,null,v(3,(u,P)=>i(f,{key:P})),64))]),i(f,{width:"w-32"})]),_:1})])):d.followUpStatuses.length>0?(t(),n("div",zo,[e("span",Yo,[i(Z,{type:d.statusBadgeType,text:o.order.status.name,showDot:!1,class:"border border-gray-500"},null,8,["type","text"])]),(t(!0),n(y,null,v(d.followUpStatuses,(u,P)=>(t(),n("span",{key:P,onClick:xr=>d.confirmUpdateStatus(u),class:"cursor-pointer mr-1"},[i(Z,{type:"info",text:u.name,showDot:!1,class:"border border-transparent hover:border-gray-500"},null,8,["text"])],8,Jo))),128))])):_("",!0)])])])]),o.order?(t(),n("div",{key:1,class:W(["space-y-4 shadow-lg rounded-lg border p-4",o.isLoadingOrder?"bg-gray-50":"border-red-300 bg-red-50"])},[e("div",Go,[Qo,o.isLoadingOrder?(t(),p(x,{key:0},{default:l(()=>[i(f,{width:"w-20 mx-2"})]),_:1})):(t(),n("span",Ko," Order #"+c(o.order._attributes.number),1)),Xo]),e("div",$o,[d.isEditting&&o.isLoadingOrder?(t(),p(E,{key:0},{default:l(()=>[g("Delete Order")]),_:1})):(t(),p(j,{key:1,approveText:"Delete Order",approveAction:d.deleteOrder,isLoading:o.isDeleting},{content:l(()=>[er,e("p",tr,[g("Are you sure you want to permanently delete "),e("span",sr,"Order #"+c(o.order._attributes.number),1),g("?")])]),trigger:l(u=>[i(k,{onClick:u.showModal,loading:o.isDeleting,class:"w-40",type:"danger"},{default:l(()=>[g(" Delete Order ")]),_:2},1032,["onClick","loading"])]),_:1},8,["approveAction","isLoading"]))])],2)):_("",!0),o.order&&o.followUpStatus?(t(),p(j,{key:2,declineText:"Cancel",declineType:"light",isLoading:o.isUpdatingOrderStatus,autoHide:!1,approveText:o.followUpStatus.name,approveType:"primary",approveAction:u=>d.updateOrderStatus(o.followUpStatus.name,u)},{content:l(()=>[e("p",or,[g("Mark As "),e("span",rr,c(o.followUpStatus.name),1)]),e("p",nr,c(o.followUpStatus.description),1),e("div",{class:W({"mb-8 space-y-4":o.followUpStatus.name.toLowerCase()=="completed"||o.followUpStatus.name.toLowerCase()=="cancelled"})},[o.followUpStatus.name.toLowerCase()=="completed"&&!d.isVerified?(t(),n(y,{key:0},[i(O,null,{default:l(()=>[g(c(o.order._attributes.dialToShowCollectionCode.instruction),1)]),_:1}),i(ne,{modelValue:o.collectionCode,"onUpdate:modelValue":a[0]||(a[0]=u=>o.collectionCode=u),errorText:s.getFormError("collectionCode")},null,8,["modelValue","errorText"]),i(ie,{modelValue:o.collectionNote,"onUpdate:modelValue":a[1]||(a[1]=u=>o.collectionNote=u),label:"Note (Optional)",placeholder:"Collected by John Doe",rows:2,errorText:s.getFormError("collectionNote"),labelPopoverTitle:"What Is This?",labelPopoverDescription:"Important note regarding this order collection e.g Collected by John Doe"},null,8,["modelValue","errorText"])],64)):o.followUpStatus.name.toLowerCase()=="cancelled"?(t(),n(y,{key:1},[ir,i(I,{width:"w-full",modelValue:o.cancellationReason,"onUpdate:modelValue":a[2]||(a[2]=u=>o.cancellationReason=u),labelPopoverTitle:"What Is This?",label:"Cancellation Reason (Optional)",errorText:s.getFormError("cancellationReason"),labelPopoverDescription:"A reason for why you are cancelling this order. This helps you keep a record for your cancelled orders"},{default:l(()=>[ar,(t(!0),n(y,null,v(o.cancellationReasons,(u,P)=>(t(),n("option",{value:u,key:P},c(u),9,lr))),128))]),_:1},8,["modelValue","errorText"])],64)):_("",!0)],2)]),trigger:l(u=>[i(k,{ref:"confirmUpdateOrderStatus",onClick:u.showModal,class:"hidden"},{default:l(()=>[g(c(o.followUpStatus.name),1)]),_:2},1032,["onClick"])]),_:1},8,["isLoading","approveText","approveAction"])):_("",!0),o.order?(t(),p(j,{key:3,approveText:"Yes",declineText:"No",autoHide:!1,isLoading:o.isRequestingPayment,approveType:"primary",approveAction:u=>d.requestPayment(u)},{content:l(()=>[e("div",null,[dr,i(O,{class:"mb-4"},{default:l(()=>[g("Request a payment for this order using "),cr,g(" or "),hr]),_:1}),e("div",ur,[i(I,{width:"w-full",label:"Payment Method",labelPopoverTitle:"What Is This?",modelValue:o._requestPayment.paymentMethodId,"onUpdate:modelValue":a[3]||(a[3]=u=>o._requestPayment.paymentMethodId=u),errorText:s.getFormError("paymentMethod"),labelPopoverDescription:"Select the payment method used to pay for this order e.g DPO (Direct Pay Online) or Orange Money"},{default:l(()=>[(t(!0),n(y,null,v(o._requestPayment.paymentMethods,(u,P)=>(t(),n("option",{value:u.id.toString(),key:P},c(u.name),9,mr))),128))]),_:1},8,["modelValue","errorText"]),i(I,{width:"w-full",label:"Amount",modelValue:o._requestPayment.percentage,"onUpdate:modelValue":a[4]||(a[4]=u=>o._requestPayment.percentage=u),labelPopoverTitle:"What Is This?",errorText:s.getFormError("percentage"),labelPopoverDescription:"Select the amonunt that has been paid"},{default:l(()=>[(t(!0),n(y,null,v(o.order._attributes.payableAmounts,(u,P)=>(t(),n("option",{value:u.percentage.toString(),key:P},c(u.name),9,pr))),128))]),_:1},8,["modelValue","errorText"])])])]),trigger:l(u=>[i(k,{ref:"confirmRequestPayment",onClick:u.showModal,class:"hidden"},{default:l(()=>[g(" Request Payment ")]),_:2},1032,["onClick"])]),_:1},8,["isLoading","approveAction"])):_("",!0),o.order?(t(),p(j,{key:4,approveText:"Yes",declineText:"No",autoHide:!1,isLoading:o.isMarkingAsPaid,approveType:"primary",approveAction:u=>d.markAsUnverifiedPayment(u)},{content:l(()=>[e("div",null,[_r,i(O,{class:"mb-4"},{default:l(()=>[g("Mark this order as paid if you received payment from the customer via cash, ewallet, card swipping or any other way")]),_:1}),e("div",fr,[i(I,{width:"w-full",label:"Amount",modelValue:o.markAsPaid.percentage,"onUpdate:modelValue":a[5]||(a[5]=u=>o.markAsPaid.percentage=u),labelPopoverTitle:"What Is This?",errorText:s.getFormError("percentage"),labelPopoverDescription:"Select the amonunt that has been paid"},{default:l(()=>[(t(!0),n(y,null,v(o.order._attributes.payableAmounts,(u,P)=>(t(),n("option",{value:u.percentage.toString(),key:P},c(u.name),9,gr))),128))]),_:1},8,["modelValue","errorText"]),i(I,{width:"w-full",label:"Payment Method",labelPopoverTitle:"What Is This?",modelValue:o.markAsPaid.paymentMethodId,"onUpdate:modelValue":a[6]||(a[6]=u=>o.markAsPaid.paymentMethodId=u),errorText:s.getFormError("paymentMethod"),labelPopoverDescription:"Select the payment method used to pay for this order e.g Cash"},{default:l(()=>[(t(!0),n(y,null,v(o.markAsPaid.paymentMethods,(u,P)=>(t(),n("option",{value:u.id.toString(),key:P},c(u.name),9,yr))),128))]),_:1},8,["modelValue","errorText"])])])]),trigger:l(u=>[i(k,{ref:"confirmMarkAsPaid",onClick:u.showModal,class:"hidden"},{default:l(()=>[g(" Mark As Paid ")]),_:2},1032,["onClick"])]),_:1},8,["isLoading","approveAction"])):_("",!0)])])}const tn=V(ao,[["render",wr]]);export{tn as default};
