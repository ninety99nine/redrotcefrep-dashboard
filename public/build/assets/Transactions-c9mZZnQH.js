import{u as M,s as U,q as A,c as l,d as e,e as p,w as c,r as h,o as i,i as v,p as u,J as m,t as n,g as f,F,l as w,m as x}from"./app-piavnWUw.js";import{U as D}from"./SpiningLoader-COnJLsaj.js";import{T as V}from"./TextHeader-C9wn3Won.js";import{B as C}from"./BasicTable-W7_55bdS.js";import{E}from"./ExternalLink-DR9KGEnX.js";import{D as O}from"./Datepicker-DSoPJ3Uo.js";import{M as N}from"./MoreInfoPopover-CKuNZTrg.js";import{g as H}from"./api-repository-LmUqmO20.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SearchInput-BLhW_LtD.js";import"./TextInput-DrcRoVTX.js";import"./InputLabel-CtY3wyzz.js";import"./InputErrorMessage-D6kZl79B.js";const q=()=>M().apiHome._links;async function R(a=null,s={}){return await H(a??q().showTransactions,s)}const I={mixins:[D],components:{TextHeader:V,BasicTable:C,ExternalLink:E,Datepicker:O,MoreInfoPopover:N},data(){return{url:null,searchTerm:null,pagination:null,isFetching:!1,transactions:[],appName:U.appName,tableHeaders:["For","Description","Payment Status","Amount","Percentage","Payment Method","Paid By","Verified By","Requested By","DPO Payment Link","DPO Link Status","DPO Expiry Date","Created Date",""],paymentStatusFilter:"all",verifiedByFilter:"all",paymentMethodFilter:"all",dateNameFilter:null,dateValueFilter:null,dateOperationFilter:null,filters:[]}},methods:{onView(a){console.log("view:"+a.name)},onEdit(a){console.log("edit:"+a.name)},onDelete(a){console.log("delete:"+a.name)},paginate(a){this.url=a,this._getTransactions()},search(a){this.url=null,this.searchTerm=a,this._getTransactions()},addOrUpdateFilter(a){var s="";this.dateOperationFilter=="gte"?s=">=":this.dateOperationFilter=="lte"?s="<=":this.dateOperationFilter=="gt"?s=">":this.dateOperationFilter=="lt"?s="<":this.dateOperationFilter=="e"&&(s="="),this.filters=this.filters.filter(b=>b.name!==this.dateNameFilter);const d={name:this.dateNameFilter,value:this.dateValueFilter,operation:this.dateOperationFilter,displayName:this.dateNameFilter+" "+s+" "+this.dateValueFilter};a==null?this.filters.push(d):this.filters[a]=d,this._getTransactions()},showSelectedFilter(a){this.dateNameFilter=a.name,this.dateValueFilter=a.value,this.dateOperationFilter=a.operation},resetAddFilterModal(){this.dateNameFilter="startAt",this.dateOperationFilter="gte",this.dateValueFilter=this.formattedDate()},hideFilterModal(){this.resetAddFilterModal()},removeFilter(){this._getTransactions()},_getTransactions(){this.isFetching=!0;const a={with_paying_user:"1",search:this.searchTerm,with_payment_method:"1",with_verifying_user:"1",with_requesting_user:"1"};this.verifiedByFilter!="all"&&(a.verifiedBy=this.verifiedByFilter),this.paymentMethodFilter!="all"&&(a.paymentMethod=this.paymentMethodFilter),this.paymentStatusFilter!="all"&&(a.paymentStatus=this.paymentStatusFilter);for(let s=0;s<this.filters.length;s++){const d=this.filters[s];["startAt","endAt"].includes(d.name)&&(a[d.name]=d.operation+"-"+this.dateToTimestamp(d.value))}R(this.url,a).then(s=>{s.status==200&&(this.pagination=s.data,this.transactions=this.pagination.data),this.isFetching=!1}).catch(s=>{this.isFetching=!1})}},mounted(){A()},created(){this.resetAddFilterModal(),this._getTransactions()}},W={class:"px-16 pt-8"},G={class:"flex items-center border-dashed border-b py-6 mb-6"},Z=e("option",{value:"all"},"Payment Status = All",-1),z=e("option",{value:"paid"},"Paid",-1),J=e("option",{value:"pending payment"},"Pending Payment",-1),j=[Z,z,J],K=e("option",{value:"all"},"Verified By = All",-1),Q={value:"system"},X=e("option",{value:"user"},"User",-1),Y=e("option",{value:"all"},"Payment Method = All",-1),$=e("option",{value:"Airtime"},"Airtime",-1),ee=e("option",{value:"Ewallet"},"Ewallet",-1),te=e("option",{value:"Pay2Cell"},"Pay2Cell",-1),se=e("option",{value:"Orange Money"},"Orange Money",-1),ae=e("option",{value:"MyZaka"},"MyZaka",-1),re=e("option",{value:"BTC Smega"},"BTC Smega",-1),ie=e("option",{value:"Unayo"},"Unayo",-1),oe=e("option",{value:"Credit/Debit Card"},"Credit/Debit Card",-1),le=e("option",{value:"Bank Transfer"},"Bank Transfer",-1),ne=[Y,$,ee,te,se,ae,re,ie,oe,le],de={class:"lg:col-span-6 col-span-12"},pe=e("label",{for:"select-filter",class:"block mb-2 text-xs font-medium text-gray-900 dark:text-white"},"Select Filter",-1),ce=e("option",{value:"startAt"},"Start date",-1),he=e("option",{value:"endAt"},"End date",-1),ue=[ce,he],me={class:"lg:col-span-6 col-span-12"},ye=e("label",{for:"select-filter-operation",class:"block mb-2 text-xs font-medium text-gray-900 dark:text-white"},"Select Operation",-1),_e=e("option",{value:"gte"},"Greater or equal to",-1),ge=e("option",{value:"lte"},"Less or equal to",-1),fe=e("option",{value:"gt"},"Greater than",-1),xe=e("option",{value:"lt"},"Less than",-1),be=e("option",{value:"e"},"Equal to",-1),ke=[_e,ge,fe,xe,be],ve={class:"col-span-12"},Fe=["onClick"],we={class:"whitespace-nowrap px-4 py-4"},Te={class:"px-4 py-4"},Be={class:"min-w-80"},Pe={class:"whitespace-nowrap px-4 py-4"},Se={class:"whitespace-nowrap px-4 py-4 text-center"},Me={class:"whitespace-nowrap px-4 py-4 text-center"},Ue={class:"whitespace-nowrap px-4 py-4 text-center"},Ae={class:"whitespace-nowrap px-4 py-4"},De={key:0},Ve={key:1,class:"text-xs text-center text-gray-300"},Ce={class:"text-xs text-center text-gray-300"},Ee={key:0,class:"whitespace-nowrap px-4 py-4"},Oe={class:"whitespace-nowrap px-4 py-4"},Ne={key:0},He={key:1,class:"text-xs text-center text-gray-300"},Le={class:"px-4 py-4"},qe={key:0,class:"max-w-80"},Re={key:1,class:"text-xs text-center text-gray-300"},Ie={class:"text-xs text-center text-gray-300"},We={key:0,class:"text-xs text-center text-gray-300"},Ge={class:"whitespace-nowrap px-4 py-4"},Ze={key:0,class:"flex space-x-1 items-center"},ze={key:1,class:"text-xs text-center text-gray-300"},Je={class:"whitespace-nowrap px-4 py-4"},je={class:"flex space-x-1 items-center"},Ke={class:"opacity-0 group-hover:opacity-100 transition-opacity px-4 py-4 space-x-4"},Qe=["onClick"],Xe=["onClick"];function Ye(a,s,d,b,r,o){const T=h("TextHeader"),y=h("MoreInfoPopover"),B=h("Datepicker"),_=h("BadgeIndicator"),P=h("ExternalLink"),S=h("BasicTable");return i(),l("div",W,[e("div",G,[p(T,null,{default:c(()=>[v("Transactions")]),_:1}),p(y,{class:"ml-2 mt-1",title:"What Is This?",description:"Transactions are records of online and offline payments for goods and services whether initiated and verified by the "+r.appName+" system or users within the "+r.appName+" ecosystem",placement:"top"},null,8,["description"])]),p(S,{pagination:r.pagination,isLoading:r.isFetching,onPaginate:o.paginate,onSearch:o.search,onRefresh:o._getTransactions,showAddFilter:!0,filters:r.filters,onAddOrUpdateFilter:o.addOrUpdateFilter,onShowSelectedFilter:o.showSelectedFilter,onHideFilterModal:o.hideFilterModal,onRemoveFilter:o.removeFilter,totalHeaders:r.tableHeaders.length},{primaryFilters:c(()=>[u(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>r.paymentStatusFilter=t),onChange:s[1]||(s[1]=(...t)=>o._getTransactions&&o._getTransactions(...t)),id:"select-payment-status",class:"w-48 block p-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},j,544),[[m,r.paymentStatusFilter]]),u(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>r.verifiedByFilter=t),onChange:s[3]||(s[3]=(...t)=>o._getTransactions&&o._getTransactions(...t)),id:"select-verified-by",class:"w-40 block p-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},[K,e("option",Q,n(r.appName),1),X],544),[[m,r.verifiedByFilter]]),u(e("select",{"onUpdate:modelValue":s[4]||(s[4]=t=>r.paymentMethodFilter=t),onChange:s[5]||(s[5]=(...t)=>o._getTransactions&&o._getTransactions(...t)),id:"select-verified",class:"w-48 block p-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},ne,544),[[m,r.paymentMethodFilter]])]),modalFilters:c(()=>[e("div",de,[pe,u(e("select",{"onUpdate:modelValue":s[6]||(s[6]=t=>r.dateNameFilter=t),id:"select-filter",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},ue,512),[[m,r.dateNameFilter]])]),e("div",me,[ye,u(e("select",{"onUpdate:modelValue":s[7]||(s[7]=t=>r.dateOperationFilter=t),id:"select-filter-operation",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},ke,512),[[m,r.dateOperationFilter]])]),e("div",ve,[(i(),f(B,{modelValue:r.dateValueFilter,"onUpdate:modelValue":s[8]||(s[8]=t=>r.dateValueFilter=t),key:r.dateValueFilter},null,8,["modelValue"]))])]),head:c(()=>[e("tr",null,[(i(!0),l(F,null,w(r.tableHeaders,(t,g)=>(i(),l("th",{key:g,scope:"col",class:"whitespace-nowrap px-4 py-3"},n(t),1))),128))])]),body:c(()=>[(i(!0),l(F,null,w(r.transactions,(t,g)=>(i(),l("tr",{onClick:x(k=>o.onView(t),["stop"]),key:g,class:"group cursor-pointer bg-white hover:bg-gray-50 border-b"},[e("td",we,n(a.capitalizeAllWords(t.ownerType)),1),e("td",Te,[e("div",Be,n(t.description),1)]),e("td",Pe,[p(_,{type:t.paymentStatus.name.toLowerCase()=="paid"?"success":"warning",text:t.paymentStatus.name},null,8,["type","text"])]),e("td",Se,n(t.amount.amountWithCurrency),1),e("td",Me,n(t.percentage.valueSymbol),1),e("td",Ue,n(t._relationships.paymentMethod.name),1),e("td",Ae,[t._relationships.paidByUser?(i(),l("span",De,n(t._relationships.paidByUser._attributes.name),1)):(i(),l("span",Ve,"---"))]),e("td",Ce,[t._relationships.verifiedByUser?(i(),l("span",Ee,n(t._relationships.verifiedByUser._attributes.name),1)):(i(),f(_,{key:1,type:"info",text:r.appName,showDot:!1},null,8,["text"]))]),e("td",Oe,[t._relationships.requestedByUser?(i(),l("span",Ne,n(t._relationships.requestedByUser._attributes.name),1)):(i(),l("span",He,"---"))]),e("td",Le,[t.dpoPaymentUrl?(i(),l("div",qe,[p(P,{url:t.dpoPaymentUrl,class:"text-xs"},{default:c(()=>[v(n(t.dpoPaymentUrl),1)]),_:2},1032,["url"])])):(i(),l("span",Re,"---"))]),e("td",Ie,[t._attributes.dpoPaymentLinkHasExpired==null?(i(),l("span",We,"---")):(i(),f(_,{key:1,type:t._attributes.dpoPaymentLinkHasExpired==!1?"success":"warning",text:t._attributes.dpoPaymentLinkHasExpired==!1?"Active":"Expired",showDot:!1},null,8,["type","text"]))]),e("td",Ge,[t.dpoPaymentUrlExpiresAt?(i(),l("div",Ze,[e("span",null,n(a.formattedDatetime(t.dpoPaymentUrlExpiresAt)),1),p(y,{class:"opacity-0 group-hover:opacity-100",title:a.formattedRelativeDate(t.dpoPaymentUrlExpiresAt),placement:"top"},null,8,["title"])])):(i(),l("span",ze,"---"))]),e("td",Je,[e("div",je,[e("span",null,n(a.formattedDatetime(t.createdAt)),1),p(y,{class:"opacity-0 group-hover:opacity-100",title:a.formattedRelativeDate(t.createdAt),placement:"top"},null,8,["title"])])]),e("td",Ke,[e("a",{href:"#",onClick:x(k=>o.onEdit(t),["stop","prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"Edit",8,Qe),e("a",{href:"#",onClick:x(k=>o.onDelete(t),["stop","prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,Xe)])],8,Fe))),128))]),_:1},8,["pagination","isLoading","onPaginate","onSearch","onRefresh","filters","onAddOrUpdateFilter","onShowSelectedFilter","onHideFilterModal","onRemoveFilter","totalHeaders"])])}const ht=L(I,[["render",Ye]]);export{ht as default};
