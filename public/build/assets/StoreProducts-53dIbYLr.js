import{P as M}from"./Pill-CNWbwQ3o.js";import{F as N}from"./FormMixin-6JkaGLLr.js";import{B}from"./Button-BeSnAT_x.js";import{U as F}from"./form-store-C265_0LO.js";import{u as U,c as n,b as t,e as f,B as z,w as r,d as l,r as u,o,h as p,F as h,k as S,t as a,m as b,n as v,f as m}from"./app-jXH5QC3l.js";import{V as E}from"./vue-draggable-next.esm-bundler-DxBVIkpx.js";import{u as R}from"./store-store-DI9g0YE3.js";import{B as Q}from"./BasicTable-BENOl8OQ.js";import{C as H}from"./Checkbox-CA6moHBM.js";import{C as O}from"./ConfirmModal-l78eHkJU.js";import{S as W}from"./SpinningLoader-BdvFuScB.js";import{M as j}from"./MoreInfoPopover-DuLCv7tU.js";import{T as K}from"./ToogleSwitch-D6TVHn6r.js";import{g as Y,d as q,p as G}from"./api-repository--xE_j9dL.js";import{N as J}from"./NoDataPlaceholder-BIIoZLQj.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ShineEffect-DfG5M4Ts.js";import"./cloneDeep-B1YGuKb7.js";import"./SearchInput-BxlZh9-p.js";import"./index-CHIj4cOM.js";import"./TextInput-CYg7QVrw.js";import"./InputErrorMessage-CbGsL3fL.js";import"./SelectInput-D7XUHB9M.js";import"./Drawer-CCLxMHft.js";import"./MoneyInput-CQeRzHMh.js";import"./Datepicker-B1KIg2S4.js";const Z={mixins:[N,F],components:{Pill:M,Button:B,draggable:E,BasicTable:Q,Checkbox:H,ConfirmModal:O,SpinningLoader:W,MoreInfoPopover:j,ToogleSwitch:K,NoDataPlaceholder:J},data(){return{products:[],pagination:null,searchTerm:null,checkedRowIds:[],showEverything:!1,deletableProduct:null,apiState:U(),isDeletingProductIds:[],isLoadingProducts:!1,deleteProductModal:null,storeState:R(),isUpdatingProductArrangement:!1}},watch:{isLoadingStore(i){i||this.getProducts()}},computed:{store(){return this.storeState.store},isLoadingStore(){return this.storeState.isLoadingStore},tableHeaders(){return this.showEverything?["","Name","Description","Visibility","Price","Stock","Variations","Quantity Per Order","Position","Created Date",""]:["","Name","Visibility","Price","Stock","Variations",""]},hasSearchTerm(){return this.searchTerm!=null&&this.searchTerm.trim()!=""}},methods:{onView(i){this.isDeletingProductIds.length||this.$router.push({name:"show-store-product",params:{store_href:this.store._links.showStore,product_href:i._links.showProduct}})},showDeleteConfirmationModal(i){this.deletableProduct=i,this.deleteProductModal.showModal()},isDeleting(i){return this.isDeletingProductIds.findIndex(e=>e==i.id)!=-1},onAddProduct(){this.isDeletingProductIds.length||this.$router.push({name:"create-store-product",params:{store_href:this.store._links.showStore}})},paginate(i){this.getProducts(i)},search(i){this.searchTerm=i,this.getProducts()},getProducts(i=null){this.isLoadingProducts=!0;const e={};this.hasSearchTerm&&(e.search=this.searchTerm),i=i??this.store._links.showStoreProducts,Y(i,e).then(w=>{w.status==200&&(this.pagination=w.data,this.products=this.pagination.data,this.checkedRowIds=this.products.map(V=>!1)),this.isLoadingProducts=!1}).catch(w=>{this.isLoadingProducts=!1,this.setServerFormErrors(w)})},deleteProduct(){this.isDeletingProductIds.push(this.deletableProduct.id),q(this.deletableProduct._links.deleteProduct).then(i=>{this.isDeletingProductIds.splice(this.isDeletingProductIds.findIndex(e=>e==this.deletableProduct.id,1)),i.status==200&&(i.data.deleted?(this.showSuccessfulNotification("Product deleted"),this.isDeletingProductIds.length==0&&this.getProducts()):(this.setFormError("general",i.data.message),this.showUnsuccessfulNotification(i.data.message)))}).catch(i=>{this.isDeletingProductIds.splice(this.isDeletingProductIds.findIndex(e=>e==this.deletableProduct.id,1)),this.setServerFormErrors(i)})},updateProductArrangement(){this.isUpdatingProductArrangement=!0;const i={storeId:this.store.id,productIds:this.products.map(e=>e.id)};G(this.apiState.apiHome._links.updateProductArrangement,i).then(e=>{e.status==200&&this.showSuccessfulNotification("Product arrangement updated"),this.isUpdatingProductArrangement=!1}).catch(e=>{this.isUpdatingProductArrangement=!1,this.setServerFormErrors(e)})}},mounted(){this.deleteProductModal=this.$refs.deleteProductModal},created(){this.isLoadingProducts=!0}},$={class:"pt-24 pb-80 px-8 relative"},ee={class:"relative"},te={class:"flex justify-center my-4"},se=["onClick"],oe={class:"whitespace-nowrap px-4 py-4"},ie={class:"flex space-x-1 items-center w-40"},ne={class:"space-y-2"},ae={class:"flex items-center space-x-2 mb-2"},re={class:"flex items-center space-x-2"},le={key:0,class:"px-4 py-4"},de={class:"flex space-x-1 items-center w-60"},ce={class:"whitespace-nowrap px-4 py-4"},pe={class:"flex space-x-1 items-center"},ue={class:"whitespace-nowrap px-4 py-4"},me={key:1,class:"flex space-x-1 items-center"},he={class:"space-y-2"},ge={key:0},ye={key:2,class:"text-black"},fe={class:"font-bold"},we={class:"whitespace-nowrap px-4 py-4"},Pe={key:1,class:"flex space-x-1 items-center"},xe={key:0},ke={key:1},be={class:"whitespace-nowrap px-4 py-4"},ve={class:"flex space-x-1 items-center"},_e={class:"whitespace-nowrap px-4 py-4"},Se={class:"flex space-x-1 items-center"},Ve={class:"whitespace-nowrap px-4 py-4 text-center"},Ce={key:0},De={class:"whitespace-nowrap px-4 py-4"},Le={class:"flex space-x-1 items-center"},Te={class:"px-4 py-4 flex items-center space-x-4"},Ie=["onClick"],Ae=["onClick"],Me={key:3,class:"draggable-handle w-4 h-4 cursor-grab hover:text-yellow-500 active:cursor-grabbing",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},Ne={key:1,class:"flex justify-center"},Be={class:"animated-border-blue w-96 bg-white py-4 px-4 shadow-sm space-y-4 rounded-xl"},Fe={class:"flex justify-end"},Ue={key:0,class:"mb-8"},ze={class:"font-bold text-black"};function Ee(i,e,w,V,d,c){const C=u("ToogleSwitch"),_=u("Button"),D=u("Checkbox"),g=u("Pill"),y=u("MoreInfoPopover"),x=u("NoDataPlaceholder"),L=u("SpinningLoader"),T=u("draggable"),I=u("BasicTable"),A=u("ConfirmModal");return o(),n("div",$,[e[32]||(e[32]=t("img",{src:"/images/clouds.png",class:"absolute top-0"},null,-1)),t("div",ee,[e[28]||(e[28]=t("div",{class:"flex flex-col items-center mb-8"},[t("h1",{class:"space-x-2 text-xl text-gray-700 font-semibold bg-white rounded-full py-2 px-8 mb-4"},[t("span",null,"🛍️"),t("span",null,"Products")]),t("img",{src:"/images/store-rooftop.png",class:"w-96"})],-1)),d.isLoadingProducts||(d.pagination??{}).total>0||c.hasSearchTerm?(o(),f(I,{key:0,pagination:d.pagination,isLoading:d.isLoadingProducts,onPaginate:c.paginate,onSearch:c.search,onRefresh:c.getProducts,totalHeaders:c.tableHeaders.length},z({afterRefreshButton:r(()=>[l(_,{action:c.onAddProduct,type:"primary",size:"sm",icon:"add"},{default:r(()=>e[4]||(e[4]=[t("span",null,"Add Product",-1)])),_:1},8,["action"])]),head:r(()=>[t("tr",null,[(o(!0),n(h,null,S(c.tableHeaders,(s,P)=>(o(),n("th",{key:P,scope:"col",class:"whitespace-nowrap px-4 py-3"},a(s),1))),128))])]),tbody:r(()=>[l(T,{tag:"tbody",modelValue:d.products,"onUpdate:modelValue":e[2]||(e[2]=s=>d.products=s),handle:".draggable-handle","ghost-class":"bg-yellow-50",onChange:c.updateProductArrangement},{default:r(()=>[(o(!0),n(h,null,S(d.products,(s,P)=>(o(),n("tr",{onClick:b(k=>c.onView(s),["stop"]),key:s.id,class:v(["group cursor-pointer border-b",d.checkedRowIds[P]?"bg-blue-100":"bg-white hover:bg-gray-50"])},[t("td",{onClick:e[1]||(e[1]=b(()=>{},["stop"])),class:"whitespace-nowrap pl-4"},[l(D,{size:"xs",modelValue:d.checkedRowIds[P],"onUpdate:modelValue":k=>d.checkedRowIds[P]=k},null,8,["modelValue","onUpdate:modelValue"])]),t("td",oe,[t("div",ie,[t("span",null,a(s.name),1),l(y,{class:"opacity-0 group-hover:opacity-100",title:s.name,placement:"top"},{description:r(()=>[e[8]||(e[8]=t("hr",{class:"my-2"},null,-1)),t("div",ne,[t("p",ae,[e[5]||(e[5]=t("span",null,"SKU: ",-1)),l(g,{type:"light",size:"xs"},{default:r(()=>[t("span",null,a(s.sku??"None"),1)]),_:2},1024)]),t("p",re,[e[6]||(e[6]=t("span",null,"Barcode: ",-1)),l(g,{type:"light",size:"xs"},{default:r(()=>[t("span",null,a(s.barcode??"None"),1)]),_:2},1024)]),s.showDescription.status&&s.description!=null?(o(),n(h,{key:0},[e[7]||(e[7]=t("hr",null,null,-1)),t("p",null,a(s.description),1)],64)):m("",!0)])]),_:2},1032,["title"])])]),d.showEverything?(o(),n("td",le,[t("div",de,[s.description==null?(o(),f(x,{key:0})):(o(),n(h,{key:1},[t("span",{class:v({"line-through":s.showDescription.status==!1})},a(s.description),3),l(y,{class:"opacity-0 group-hover:opacity-100",description:s.showDescription.description,placement:"top"},null,8,["description"])],64))])])):m("",!0),t("td",ce,[t("div",pe,[l(g,{type:s.visible.status?"success":"warning",size:"xs"},{default:r(()=>[p(a(s.visible.name.toLowerCase()),1)]),_:2},1032,["type"]),l(y,{class:"opacity-0 group-hover:opacity-100",title:s.visible.name,description:s.visible.description,placement:"top"},null,8,["title","description"])])]),t("td",ue,[s.allowVariations.status?(o(),f(x,{key:0})):(o(),n("div",me,[s.isFree.status?(o(),f(g,{key:0,type:"success",size:"xs"},{default:r(()=>e[9]||(e[9]=[p("free")])),_:1})):(o(),n(h,{key:1},[t("span",null,a(s.unitPrice.amountWithCurrency),1),s.onSale.status?(o(),f(g,{key:0,type:"success",size:"xs"},{default:r(()=>e[10]||(e[10]=[p("on sale")])),_:1})):m("",!0)],64)),l(y,{class:"opacity-0 group-hover:opacity-100",title:"Pricing",placement:"top"},{description:r(()=>[e[16]||(e[16]=t("hr",{class:"my-2"},null,-1)),t("div",he,[s.onSale.status?(o(),n(h,{key:0},[t("p",null,[e[11]||(e[11]=p("Regular Price: ")),t("span",{class:v(["text-black",{"line-through":s.onSale.status||s.isFree.status}])},a(s.unitRegularPrice.amountWithCurrency),3)]),s.onSale.status?(o(),n("p",ge,[e[12]||(e[12]=p("Sale Price: ")),t("span",{class:v(["text-black",{"line-through":s.isFree.status}])},a(s.unitSalePrice.amountWithCurrency),3)])):m("",!0),e[13]||(e[13]=t("hr",null,null,-1))],64)):m("",!0),s.isFree.status?(o(),n(h,{key:1},[t("p",null,a(s.isFree.description),1),e[14]||(e[14]=t("p",{class:"font-bold text-black"},[p("Price: "),t("span",{class:"text-green-500"},"Free")],-1))],64)):(o(),n("p",ye,[e[15]||(e[15]=p("Price: ")),t("span",fe,a(s.unitPrice.amountWithCurrency),1)]))])]),_:2},1024)]))]),t("td",we,[s.allowVariations.status?(o(),f(x,{key:0})):(o(),n("div",Pe,[l(g,{type:s.hasStock.status?"success":"warning",size:"xs"},{default:r(()=>[p(a(s.hasStock.status?s.stockQuantityType.value.toLowerCase()=="unlimited"?"Unlimited":s.stockQuantity.description:s.hasStock.name),1)]),_:2},1032,["type"]),l(y,{class:"opacity-0 group-hover:opacity-100",title:"Stock",placement:"top"},{description:r(()=>[e[17]||(e[17]=t("hr",{class:"my-2"},null,-1)),s.stockQuantityType.value.toLowerCase()=="unlimited"?(o(),n("p",xe,a(s.stockQuantityType.description),1)):(o(),n("p",ke,a(s.stockQuantity.description),1))]),_:2},1024)]))]),t("td",be,[t("div",ve,[l(g,{type:"light",size:"xs"},{default:r(()=>[p(a(s.allowVariations.name.toLowerCase()=="yes"?s.totalVisibleVariations:"None"),1)]),_:2},1024),l(y,{class:"opacity-0 group-hover:opacity-100",title:"Allow Variations",placement:"top"},{description:r(()=>[e[21]||(e[21]=t("hr",{class:"my-2"},null,-1)),t("p",null,a(s.allowVariations.description),1),s.allowVariations.status?(o(),n(h,{key:0},[e[20]||(e[20]=t("hr",{class:"my-2"},null,-1)),t("p",null,[e[18]||(e[18]=p("Total Variations: ")),t("span",null,a(s.totalVariations??"..."),1)]),t("p",null,[e[19]||(e[19]=p("Total Visible Variations: ")),t("span",null,a(s.totalVisibleVariations??"..."),1)])],64)):m("",!0)]),_:2},1024)])]),d.showEverything?(o(),n(h,{key:1},[t("td",_e,[t("div",Se,[l(g,{type:"light",size:"xs"},{default:r(()=>[p(a(s.allowedQuantityPerOrder.value.toLowerCase()=="unlimited"?"Unlimited":s.maximumAllowedQuantityPerOrder.value),1)]),_:2},1024),l(y,{class:"opacity-0 group-hover:opacity-100",title:"Quantity Per Order",placement:"top"},{description:r(()=>[e[22]||(e[22]=t("hr",{class:"my-2"},null,-1)),t("p",null,a(s.allowedQuantityPerOrder.description),1)]),_:2},1024)])]),t("td",Ve,[s.position?(o(),n("span",Ce,"#"+a(s.position),1)):(o(),f(x,{key:1}))]),t("td",De,[t("div",Le,[t("span",null,a(i.formattedDatetime(s.createdAt)),1),l(y,{class:"opacity-0 group-hover:opacity-100",title:i.formattedRelativeDate(s.createdAt),placement:"top"},null,8,["title"])])])],64)):m("",!0),t("td",Te,[c.isDeleting(s)?m("",!0):(o(),n("span",{key:0,onClick:b(k=>c.onView(s),["stop","prevent"]),class:"cursor-pointer font-medium text-blue-600 dark:text-blue-500 hover:underline"},"View",8,Ie)),c.isDeleting(s)?(o(),f(L,{key:1,type:"danger"},{default:r(()=>e[23]||(e[23]=[t("span",{class:"text-xs ml-2"},"Deleting...",-1)])),_:1})):(o(),n("span",{key:2,onClick:b(k=>c.showDeleteConfirmationModal(s),["stop","prevent"]),class:"cursor-pointer font-medium text-red-600 dark:text-red-500 hover:underline"},"Delete",8,Ae)),c.isDeleting(s)?m("",!0):(o(),n("svg",Me,e[24]||(e[24]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"},null,-1)])))])],10,se))),128))]),_:1},8,["modelValue","onChange"])]),_:2},[(d.pagination??{}).total>0?{name:"header",fn:r(()=>[t("div",te,[l(C,{modelValue:d.showEverything,"onUpdate:modelValue":e[0]||(e[0]=s=>d.showEverything=s),size:"md",labelPopoverTitle:"What Is This?",labelPopoverDescription:"Turn on if you want to show more information about your products"},{default:r(()=>e[3]||(e[3]=[p(" Show Everything ")])),_:1},8,["modelValue"])])]),key:"0"}:void 0]),1032,["pagination","isLoading","onPaginate","onSearch","onRefresh","totalHeaders"])):(o(),n("div",Ne,[t("div",Be,[e[26]||(e[26]=t("h1",{class:"text-xl font-bold"}," Create Your First Product ",-1)),e[27]||(e[27]=t("p",{class:"text-sm text-gray-500"}," Start stocking your store with products your customers will love ",-1)),t("div",Fe,[l(_,{action:c.onAddProduct,type:"primary",size:"sm",icon:"add"},{default:r(()=>e[25]||(e[25]=[t("span",null,"Add Product",-1)])),_:1},8,["action"])])])]))]),l(A,{ref:"deleteProductModal",approveText:"Delete Product",approveAction:c.deleteProduct,isLoading:c.isDeleting(d.deletableProduct)},{content:r(()=>[e[31]||(e[31]=t("p",{class:"text-lg font-bold border-b border-dashed pb-4 mb-4"},"Confirm Delete",-1)),d.deletableProduct?(o(),n("p",Ue,[e[29]||(e[29]=p("Are you sure you want to permanently delete ")),t("span",ze,a(d.deletableProduct.name),1),e[30]||(e[30]=p("?"))])):m("",!0)]),_:1},8,["approveAction","isLoading"])])}const ut=X(Z,[["render",Ee]]);export{ut as default};
